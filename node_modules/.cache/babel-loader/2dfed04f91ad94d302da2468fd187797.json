{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/assets/leverageRepayment/leverageRepayment.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/assets/leverageRepayment/leverageRepayment.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\nimport { fixD, fixInput, getCoinShowName } from '@/utils';\nexport default {\n  data: function data() {\n    return {\n      transferConfirmLoading: false,\n      transferFlag: false,\n      // 资金划转弹窗开关变量\n      transferValue: '',\n      // 划转数量\n      transferCoin: '',\n      // 划转的币种\n      transferObj: {},\n      // 当前划转币种对象\n      axiosFlag: false,\n      symbol: '',\n      repaymentData: {} // 借贷信息\n\n    };\n  },\n  filters: {\n    fixDFn: function fixDFn(v) {\n      // return fixD(v, that.transferCoinFix);\n      return fixD(v, 8);\n    },\n    fixDReturnFn: function fixDReturnFn(v) {\n      // return fixD(v, that.returnFix);\n      return fixD(v, 8);\n    }\n  },\n  watch: {\n    market: function market(v) {\n      if (v && this.axiosFlag) {\n        this.getData();\n      }\n    },\n    transferValue: function transferValue(v) {\n      // this.transferValue = fixInput(v, this.returnFix);\n      this.transferValue = fixInput(v, 8);\n    }\n  },\n  computed: {\n    inputMess: function inputMess() {\n      var obj = {\n        flag: false,\n        showError: false,\n        text: ''\n      };\n      var inp = Number(this.transferValue);\n      var have = Number(this.transferCanNum);\n      var max = Number(fixD(this.repaymentMess.Surplus, this.returnFix));\n      var min = Number(this.transferMinNum);\n      var flag = true;\n      if (min > max) flag = false;\n\n      if (inp === 0) {\n        obj.flag = false;\n        obj.text = '';\n        obj.showError = false;\n      } else if (min > inp && flag) {\n        obj.flag = false;\n        obj.showError = true; // 归还数量不得小于\n\n        var str = this.$t('assets.leverageRepayment.error1');\n        obj.text = \"\".concat(str, \" \").concat(fixD(min, this.transferCoinFix), \" \").concat(this.transferCoin);\n      } else if (inp > have) {\n        obj.flag = false;\n        obj.showError = true; // 归还数量不得大于可用数量\n\n        obj.text = this.$t('assets.leverageRepayment.error2');\n      } else if (inp > max) {\n        obj.flag = false;\n        obj.showError = true; // 归还数量不得大于应还数量\n\n        obj.text = this.$t('assets.leverageRepayment.error3');\n      } else {\n        obj.flag = true;\n        obj.text = '';\n        obj.showError = false;\n      }\n\n      return obj;\n    },\n    repaymentMess: function repaymentMess() {\n      var obj = {\n        coin: '',\n        // 借贷币种\n        sum: '',\n        // 借贷总数\n        rete: '',\n        // 借贷产生的利息\n        Surplus: '' // 应还 未还 + 利息\n\n      };\n      var _this$repaymentData = this.repaymentData,\n          coin = _this$repaymentData.coin,\n          borrowMoney = _this$repaymentData.borrowMoney,\n          oweInterest = _this$repaymentData.oweInterest,\n          oweAmount = _this$repaymentData.oweAmount;\n      obj.coin = coin;\n      obj.sum = borrowMoney || 0;\n      obj.rate = oweInterest || 0;\n      obj.Surplus = (oweInterest || 0) + (oweAmount || 0);\n      return obj;\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    transferWarningText: function transferWarningText() {\n      var text = this.$t('assets.leverageRepayment.can'); // 可用\n\n      var num = fixD(this.transferCanNum, 8);\n      return \"\".concat(text, \" \").concat(num, \" \").concat(this.getShowCoin(this.transferCoin), \" \");\n    },\n    transferCoinFix: function transferCoinFix() {\n      var fix = 0;\n\n      if (this.market && this.market.coinList && this.market.coinList[this.transferCoin]) {\n        fix = this.market.coinList[this.transferCoin].showPrecision;\n      }\n\n      return Number(fix);\n    },\n    returnFix: function returnFix() {\n      var returnFix = this.transferObj.baseReturnPrecision || 0;\n\n      if (this.repaymentMess.coin === this.transferObj.quoteCoin) {\n        returnFix = this.transferObj.quoteReturnPrecision;\n      }\n\n      return returnFix;\n    },\n    // 弹窗是否可点击\n    transferConfirmDisabled: function transferConfirmDisabled() {\n      if (this.transferConfirmLoading) {\n        return false;\n      }\n\n      var flag = true;\n\n      if (this.inputMess.flag) {\n        flag = false;\n      }\n\n      return flag;\n    },\n    // 可用数量\n    transferCanNum: function transferCanNum() {\n      var _this$transferObj = this.transferObj,\n          baseNormalBalance = _this$transferObj.baseNormalBalance,\n          quoteNormalBalance = _this$transferObj.quoteNormalBalance,\n          baseCoin = _this$transferObj.baseCoin,\n          quoteCoin = _this$transferObj.quoteCoin;\n      var balance = '';\n\n      if (this.transferCoin === baseCoin) {\n        balance = baseNormalBalance;\n      } else if (this.transferCoin === quoteCoin) {\n        balance = quoteNormalBalance;\n      }\n\n      return Number(balance);\n    },\n    // 最小还款额度\n    transferMinNum: function transferMinNum() {\n      var _this$transferObj2 = this.transferObj,\n          baseMinPayment = _this$transferObj2.baseMinPayment,\n          quoteMinPayment = _this$transferObj2.quoteMinPayment,\n          baseCoin = _this$transferObj2.baseCoin,\n          quoteCoin = _this$transferObj2.quoteCoin;\n      var balance = '';\n\n      if (this.transferCoin === baseCoin) {\n        balance = baseMinPayment;\n      } else if (this.transferCoin === quoteCoin) {\n        balance = quoteMinPayment;\n      }\n\n      return Number(balance);\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      this.$bus.$on('coRepayment', function (data) {\n        var symbol = data.symbol,\n            coin = data.coin;\n        _this.repaymentData = data;\n        _this.axiosFlag = true;\n        _this.symbol = symbol;\n        _this.transferFlag = true;\n        _this.transferCoin = coin;\n\n        if (_this.market) {\n          _this.getData();\n        }\n      });\n    },\n    getShowSymbol: function getShowSymbol(v) {\n      if (!this.market) return v;\n      var market = this.market.market;\n      var showSymbol = v;\n\n      if (this.market && market && this.transferObj.quoteCoin) {\n        var obj = market[this.transferObj.quoteCoin][this.transferObj.name];\n        showSymbol = obj.showName || obj.name;\n      }\n\n      return showSymbol;\n    },\n    getShowCoin: function getShowCoin(v) {\n      if (!this.market) return v;\n      var coinList = this.market.coinList;\n      var str = v;\n\n      if (this.market && coinList) {\n        str = getCoinShowName(v, coinList);\n      }\n\n      return str;\n    },\n    // 获取数据\n    getData: function getData() {\n      var _this2 = this;\n\n      this.axiosFlag = false;\n      var params = {\n        symbol: this.symbol\n      };\n      this.axios({\n        url: '/lever/finance/symbol/balance',\n        params: params\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          _this2.transferObj = data.data;\n        }\n      });\n    },\n    // 全部划转\n    allTransfer: function allTransfer() {\n      var Surplus = this.repaymentMess.Surplus;\n      var sum = '';\n\n      if (Number(Surplus) > Number(this.transferCanNum)) {\n        sum = Number(this.transferCanNum);\n      } else {\n        sum = Number(Surplus);\n      }\n\n      this.transferValue = fixD(sum, this.returnFix);\n    },\n    inputLineChange: function inputLineChange(value, name) {\n      this[name] = value;\n    },\n    clearTransfer: function clearTransfer() {\n      this.transferFlag = false; // 资金划转弹窗开关变量\n\n      this.transferValue = ''; // 划转数量\n\n      this.transferCoin = ''; // 划转的币种\n\n      this.transferConfirmLoading = false;\n      this.$set(this, 'transferObj', {}); // // 当前划转币种对象\n    },\n    transferDialogClose: function transferDialogClose() {\n      this.clearTransfer();\n    },\n    transferDialogConfirm: function transferDialogConfirm() {\n      var _this3 = this;\n\n      this.transferConfirmLoading = true;\n      var params = {\n        id: this.repaymentData.id,\n        amount: this.transferValue\n      };\n      this.axios({\n        url: '/lever/finance/return',\n        params: params\n      }).then(function (data) {\n        _this3.transferConfirmLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this3.clearTransfer();\n\n          _this3.$emit('success');\n\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};",null]}