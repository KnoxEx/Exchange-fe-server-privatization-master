{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/coTrade/market/market.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/coTrade/market/market.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\n// myStorage\nimport { fixD, myStorage } from '@/utils'; // mapState\\\n\nexport default {\n  name: 'market',\n  components: {},\n  props: {\n    close: {\n      default: function _default() {},\n      type: Function\n    },\n    isShow: {\n      default: false,\n      type: Boolean\n    }\n  },\n  data: function data() {\n    return {\n      // 币对列表\n      // marketData: null,\n      // 当前市场\n      marketCurrent: null,\n      // 行情数据\n      WsData: {},\n      // 当前合约市场\n      currentTypeTab: 1,\n      // 合约方向类型\n      contractSide: 1,\n      // 筛选\n      listfilterVal: null,\n      // 排序类别\n      sortName: null,\n      // 排序方向\n      sortType: '',\n      showTypeTabList0: false,\n      showTypeTabList1: false,\n      showTypeTabList2: false,\n      showTypeTabList3: false\n    };\n  },\n  computed: {\n    // 是否登录\n    isLogin: function isLogin() {\n      return this.$store.state.baseData.isLogin;\n    },\n    // 类型列表 USDT合约/币本位合约\n    typeTabList: function typeTabList() {\n      return [{\n        id: 1,\n        text: this.$t('futures.market.text4'),\n        // 'USDT合约',\n        isShow: this.showTypeTabList1,\n        classes: this.contractSide === 1 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }, {\n        id: 0,\n        text: this.$t('futures.market.text5'),\n        // '币本位合约',\n        isShow: this.showTypeTabList0,\n        classes: this.contractSide === 0 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }, {\n        id: 2,\n        text: this.$t('futures.market.text6'),\n        // '混合合约',\n        isShow: this.showTypeTabList2,\n        classes: this.contractSide === 2 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }, {\n        id: 3,\n        text: this.$t('futures.market.text7'),\n        // '模拟合约',\n        isShow: this.showTypeTabList3,\n        classes: this.contractSide === 3 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }];\n    },\n    // 合约列表\n    contractList: function contractList() {\n      return this.$store.state.future.contractList;\n    },\n    // 当前合约名称\n    contractName: function contractName() {\n      return this.$store.state.future.contractName;\n    },\n    // 当前合约信息\n    contractInfo: function contractInfo() {\n      return this.$store.state.future.contractInfo;\n    },\n    // 合约币对价格精度\n    pricefix: function pricefix() {\n      return this.$store.state.future.pricefix;\n    },\n    // 合约类型列表\n    contractTypeText: function contractTypeText() {\n      return this.$store.state.future.contractTypeText;\n    },\n    // 币对列表\n    marketList: function marketList() {\n      var _this = this;\n\n      var data = [];\n      var text = '';\n\n      if (this.contractList && this.contractList.length) {\n        this.contractList.forEach(function (item) {\n          // 混合合约 || 模拟合约\n          if (item.contractType !== 'E') {\n            text = \"-\".concat(item.marginCoin);\n          } else {\n            text = '';\n          }\n\n          var symbolName = item.symbol.replace('-', '');\n          data.push({\n            type: _this.filterType(item),\n            key: item.wsDatakey,\n            symbol: \"\".concat(symbolName).concat(text),\n            contractName: item.contractName,\n            sort: item.sort,\n            close: _this.WsData[item.wsDatakey] ? _this.WsData[item.wsDatakey].close : '--',\n            rose: _this.WsData[item.wsDatakey] ? _this.WsData[item.wsDatakey].rose : '--',\n            priceFix: item.priceFix\n          });\n        });\n      } // 搜索\n\n\n      if (this.listfilterVal) {\n        var reg = new RegExp(this.listfilterVal, 'gim');\n        data = data.filter(function (item) {\n          return item.symbol.match(reg);\n        });\n      } // 排序\n\n\n      if (this.sortType === 'down') {\n        data.sort(function (a, b) {\n          return parseFloat(b[_this.sortName]) - parseFloat(a[_this.sortName]);\n        });\n      }\n\n      if (this.sortType === 'up') {\n        data.sort(function (a, b) {\n          return parseFloat(a[_this.sortName]) - parseFloat(b[_this.sortName]);\n        });\n      }\n\n      if (!this.sortType) {\n        data.sort(function (a, b) {\n          return parseFloat(a.sort) - parseFloat(b.sort);\n        });\n      }\n\n      return data;\n    },\n    // 用户配置信息\n    userConfig: function userConfig() {\n      return this.$store.state.future.futureUserConfig;\n    }\n  },\n  watch: {\n    isShow: function isShow() {\n      this.listfilterVal = null;\n    },\n    contractInfo: function contractInfo(val, old) {\n      if (val && !old) {\n        this.contractSide = this.filterType(val);\n      }\n    }\n  },\n  filters: {\n    // 涨跌幅处理\n    fixdRose: function fixdRose(value) {\n      if (value && value !== '--') {\n        var slie = '';\n        var val = parseFloat(value, 0);\n\n        if (val > 0) {\n          slie = '+';\n        }\n\n        if (val < 0) {\n          slie = '-';\n        }\n\n        var num = Math.abs(value * 10000 / 100);\n        return \"\".concat(slie).concat(Number(num.toString().match(/^\\d+(?:\\.\\d{0,2})?/)));\n      }\n\n      return value;\n    }\n  },\n  methods: {\n    // 筛选币对列表\n    filterType: function filterType(data) {\n      // USDT 合约\n      if (data.contractType === 'E' && data.contractSide === 1) {\n        this.showTypeTabList1 = true;\n        return 1;\n      } // 币本位合约\n\n\n      if (data.contractType === 'E' && data.contractSide === 0) {\n        this.showTypeTabList0 = true;\n        return 0;\n      } // 模拟合约\n\n\n      if (data.contractType === 'S') {\n        this.showTypeTabList3 = true;\n        return 3;\n      } // 混合合约\n\n\n      this.showTypeTabList2 = true;\n      return 2;\n    },\n    // 最新价 精度处理\n    fixPrice: function fixPrice(value, fix) {\n      return fixD(value, fix);\n    },\n    // 切换合约类型\n    changeTypeTab: function changeTypeTab(type) {\n      this.contractSide = type;\n      this.getReceiveCoupon();\n    },\n    // 搜索事件\n    inputchanges: function inputchanges(v) {\n      this.listfilterVal = v;\n    },\n    // 币对排序\n    sorteEvent: function sorteEvent(key) {\n      var _this2 = this;\n\n      this.$nextTick(function () {\n        if (!_this2.sortName) {\n          _this2.sortName = key;\n          _this2.sortType = 'down';\n        } else if (_this2.sortType === 'down') {\n          _this2.sortName = key;\n          _this2.sortType = 'up';\n        } else if (_this2.sortType === 'up') {\n          _this2.sortName = null;\n          _this2.sortType = null;\n        }\n      });\n    },\n    // 切换币对\n    switchSymbol: function switchSymbol(data) {\n      var contractId;\n\n      if (this.contractList && this.contractList.length) {\n        this.contractList.forEach(function (item) {\n          if (data === item.contractName) {\n            contractId = item.id;\n          }\n        });\n      }\n\n      myStorage.set('contractId', contractId);\n      myStorage.set('contractName', data);\n      myStorage.set('futuresMarketCurrent', this.contractSide);\n      this.$bus.$emit('futuresMarketCurrent', this.contractSide);\n      this.$store.dispatch('setActivePublicInfo');\n\n      if (this.isLogin) {\n        this.$store.dispatch('getUserConfig');\n      }\n\n      this.close();\n    },\n    // 涨跌幅 颜色 class\n    roseClasses: function roseClasses(data) {\n      if (data && data !== '--') {\n        var val = parseFloat(data, 0);\n\n        if (val === 0) {\n          return '';\n        }\n\n        return val > 0 ? 'u-1-cl' : 'u-4-cl';\n      }\n\n      return '';\n    },\n    init: function init() {\n      var _this3 = this;\n\n      // 接收24小时行情数据\n      this.$bus.$on('FUTURE_MARKET_DATA', function (data) {\n        _this3.WsData = JSON.parse(data);\n      });\n\n      if (this.contractInfo) {\n        this.contractSide = this.filterType(this.contractInfo);\n      }\n\n      this.getReceiveCoupon();\n    },\n    // 获去赠金\n    getReceiveCoupon: function getReceiveCoupon() {\n      if (this.isLogin && this.userConfig && this.contractSide === 3 && this.userConfig.openContract === 1 && this.userConfig.couponTag === 0) {\n        this.$store.dispatch('getReceiveCoupon');\n      }\n    }\n  }\n};",null]}