{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/IdAuth/IdAuth.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/IdAuth/IdAuth.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _slicedToArray from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray\";\n// @ is an alias to /src\nimport { imgMap } from '@/utils';\nimport countryMinix from \"../../countryList/countryList\";\nvar upload1 = imgMap.kyc_idcard_a;\nvar upload2 = imgMap.kyc_idcard_b;\nvar upload3 = imgMap.kyc_idcard_c;\nvar upload4 = imgMap.kyc_passport_a;\nvar upload5 = imgMap.kyc_passport_b;\nvar upload6 = imgMap.kyc_passport_c;\nexport default {\n  name: 'bindEmail',\n  mixins: [countryMinix],\n  data: function data() {\n    return {\n      promptTextType: this.$t('personal.idAuth.promptTextType'),\n      promptText: this.$t('personal.label.promptText'),\n      errorText: this.$t('personal.label.errorText'),\n      authLevel: 3,\n      text1: this.$t('personal.label.idCard'),\n      text2: this.$t('personal.label.passport'),\n      loading: false,\n      firstPhotoImg: '',\n      secondPhotoImg: '',\n      thirdPhotoImg: '',\n      firstPhotoImgSrc: '',\n      secondPhotoImgSrc: '',\n      thirdPhotoImgSrc: '',\n      firstPhotoLoading: false,\n      secondPhotoLoading: false,\n      thirdPhotoLoading: false,\n      checkValue1: '',\n      // 证件号\n      promptText1: this.$t('personal.label.idCardNum'),\n      errorText1: '',\n      checkErrorFlag1: false,\n      checkValue2: '',\n      // 姓名\n      promptText2: this.$t('personal.label.name'),\n      active: '1',\n      disabled2: true,\n      country: '',\n      // 国家编号\n      countryErrorFlag: false,\n      certificateType: 2,\n      // 证件类型\n      certificateTypeErrorFlag: false,\n      imageType: '1',\n      firstPhoto: '',\n      // 身份证正面\n      secondPhoto: '',\n      // 身份证反面\n      thirdPhoto: '',\n      // 手持证件\n      uploadName: '',\n      // 当前选中的上传模块\n      idAuthType: [{\n        code: 2,\n        value: this.$t('personal.kyc.type1')\n      }, {\n        code: 4,\n        value: this.$t('personal.kyc.type2')\n      }, {\n        code: 3,\n        value: this.$t('personal.kyc.type3')\n      }],\n      kycPhone: '',\n      // kyc选择的国家\n      kycPhoneCode: '',\n      kycName: '',\n      // kyc 外国 - 名\n      kycFamilyName: '',\n      // kyc 外国 - 姓\n      kycMetaText: '',\n      // 上传图片说明文案\n      flag: false // 二维码\n\n    };\n  },\n  watch: {\n    interfaceSwitch: function interfaceSwitch(v) {\n      if (v) {\n        this.getLang();\n      }\n    },\n    userInfo: function userInfo(v) {\n      if (v) {\n        this.authLevel = this.userInfo.authLevel;\n\n        if (this.authLevel === 2 || this.authLevel === 3) {\n          this.active = '1';\n        } else if (this.authLevel === 0) {\n          this.active = '3';\n        } else {\n          // this.authLevel为1 审核通过\n          this.$router.push('/personal/userManagement');\n        }\n      }\n    },\n    publicInfo: function publicInfo(v) {\n      if (v) {\n        this.isOpenUploadImg = this.publicInfo.switch.is_open_upload_img;\n      }\n    },\n    authRealname: function authRealname(_authRealname) {\n      if (_authRealname !== null) {\n        this.loading = false;\n\n        if (_authRealname.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _authRealname.msg,\n            type: 'success'\n          });\n          this.active = '3';\n          this.$store.dispatch('resetType');\n        } else {\n          this.$bus.$emit('tip', {\n            text: _authRealname.msg,\n            type: 'error'\n          });\n          this.firstPhotoImg = '';\n          this.secondPhotoImg = '';\n          this.thirdPhotoImg = '';\n          this.firstPhotoImgSrc = '';\n          this.secondPhotoImgSrc = '';\n          this.thirdPhotoImgSrc = '';\n          this.firstPhotoLoading = false;\n          this.secondPhotoLoading = false;\n          this.thirdPhotoLoading = false;\n          this.checkValue1 = '';\n          this.checkValue2 = '';\n          this.disabled2 = true;\n          this.active = '1';\n          this.firstPhoto = '';\n          this.secondPhoto = '';\n          this.thirdPhoto = '';\n          this.uploadName = '';\n          this.kycName = '';\n          this.kycFamilyName = '';\n          this.$store.dispatch('resetType');\n        }\n      }\n    },\n    appDownload: function appDownload(v) {\n      if (v) {\n        this.flag = true;\n      }\n    }\n  },\n  computed: {\n    interfaceSwitch: function interfaceSwitch() {\n      return this.$store.state.baseData.interfaceSwitch;\n    },\n    appAuthOpen: function appAuthOpen() {\n      return this.$store.state.baseData.app_auth_open;\n    },\n    publicInfo: function publicInfo() {\n      return this.$store.state.baseData.publicInfo;\n    },\n    // ”00“ face++\n    // ”01“羽山kyc\n    // “02”简版自动\n    // ”10“ 人工\n    nameVerifiedType: function nameVerifiedType() {\n      return this.$store.state.baseData.nameVerifiedType;\n    },\n    bg1: function bg1() {\n      if (this.kycType === '1') {\n        return {\n          backgroundImage: \"url(\".concat(upload1, \")\")\n        };\n      }\n\n      return {\n        backgroundImage: \"url(\".concat(upload5, \")\")\n      };\n    },\n    bg2: function bg2() {\n      if (this.kycType === '1') {\n        return {\n          backgroundImage: \"url(\".concat(upload2, \")\")\n        };\n      }\n\n      return {\n        backgroundImage: \"url(\".concat(upload4, \")\")\n      };\n    },\n    bg3: function bg3() {\n      if (this.kycType === '1') {\n        return {\n          backgroundImage: \"url(\".concat(upload3, \")\")\n        };\n      }\n\n      return {\n        backgroundImage: \"url(\".concat(upload6, \")\")\n      };\n    },\n    authRealname: function authRealname() {\n      return this.$store.state.personal.authRealname;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    activeP1: function activeP1() {\n      if (this.active !== '1') {\n        return '';\n      }\n\n      return 'b-2-cl';\n    },\n    activeP2: function activeP2() {\n      if (this.active !== '2') {\n        return '';\n      }\n\n      return 'b-2-cl';\n    },\n    activeP3: function activeP3() {\n      if (this.active === '3') {\n        return 'b-2-cl';\n      }\n\n      return '';\n    },\n    activeS2: function activeS2() {\n      if (this.active !== '1') {\n        return 'a-12-bg';\n      }\n\n      return 'a-1-bg';\n    },\n    activeS3: function activeS3() {\n      if (this.active === '3') {\n        return 'a-12-bg';\n      }\n\n      return 'a-1-bg';\n    },\n    // kyc第一步骤\n    kycStep1Disabled: function kycStep1Disabled() {\n      var flag = true; // 中国\n\n      if (this.kycType === '1') {\n        if (this.kycNationality.length // 国籍\n        && this.checkValue2.length // 姓名\n        && this.checkValue1.length) {\n          // 证件号码\n          flag = false;\n        } // 外国\n\n      } else if (this.kycNationality.length // 国籍\n      && this.kycName.length // 名\n      && this.kycFamilyName.length // 姓\n      && this.checkValue1.length) {\n        // 证件号码\n        flag = false;\n      }\n\n      return flag;\n    },\n    // 国籍\n    kycNationality: function kycNationality() {\n      var str = '';\n      var current = this.countryRealMap[\"+\".concat(this.kycPhone)];\n\n      if (this.kycPhone && current) {\n        var val = current.value;\n\n        var _val$split = val.split(' +');\n\n        var _val$split2 = _slicedToArray(_val$split, 1);\n\n        str = _val$split2[0];\n      }\n\n      return str;\n    },\n    // 验证类型 1为中国人 2为外国人\n    kycType: function kycType() {\n      if (this.kycPhone) {\n        if (this.kycPhone === '156') {\n          return '1';\n        }\n\n        return '2';\n      }\n\n      return '2';\n    },\n    appDownload: function appDownload() {\n      return this.$store.state.baseData.app_download;\n    }\n  },\n  methods: {\n    init: function init() {\n      if (this.$route.query) {\n        if (this.$route.query.country) {\n          this.kycPhone = this.$route.query.country;\n          this.kycPhoneCode = this.$route.query.countryKeyCode;\n        } else if (this.$route.query.countryKeyCode) {\n          this.kycPhone = this.countryMap[\"+\".concat(this.$route.query.countryKeyCode)].code.replace('+', '');\n          this.kycPhoneCode = this.$route.query.countryKeyCode;\n        } else {\n          this.kycPhone = '156';\n          this.kycPhoneCode = '86';\n        }\n      }\n\n      if (this.publicInfo !== null) {\n        this.isOpenUploadImg = this.publicInfo.switch.is_open_upload_img;\n      }\n\n      if (this.userInfo) {\n        this.authLevel = this.userInfo.authLevel;\n\n        if (this.authLevel === 2 || this.authLevel === 3) {\n          this.active = '1';\n        } else if (this.authLevel === 0) {\n          this.active = '3';\n        } else {\n          // this.authLevel为1 审核通过\n          this.$router.push('/personal/userManagement');\n        }\n      }\n\n      if (this.interfaceSwitch) {\n        this.getLang();\n      }\n    },\n    getLang: function getLang() {\n      var _this = this;\n\n      this.axios({\n        url: '/kyc/Api/getUploadImgCopywriting'\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          if (data.data.language) {\n            _this.kycMetaText = data.data.language;\n          }\n        } else {\n          _this.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    idAuthTypeChange: function idAuthTypeChange(_ref) {\n      var code = _ref.code;\n      this.certificateType = code;\n    },\n    uploadFinish: function uploadFinish(obj) {\n      if (obj.name) {\n        this.uploadName = obj.name;\n      }\n\n      if (obj.error) {\n        this.$bus.$emit('tip', {\n          text: obj.error,\n          type: 'error'\n        });\n        return;\n      }\n\n      this[\"\".concat(this.uploadName, \"Img\")] = obj.url;\n      this[\"\".concat(this.uploadName, \"ImgSrc\")] = obj.imgSrc;\n      this[\"\".concat(this.uploadName, \"Loading\")] = false;\n      this[this.uploadName] = obj.fileName;\n\n      if (this.firstPhotoImg && this.secondPhotoImg && this.thirdPhotoImg) {\n        this.disabled2 = false;\n      }\n    },\n    onChangeFileFun: function onChangeFileFun(obj) {\n      if (obj.code && obj.code === 'maxSize') {\n        this.$bus.$emit('tip', {\n          text: this.$t('personal.exccAuthForm.text3'),\n          type: 'error'\n        });\n      }\n\n      this.uploadName = obj.name;\n      this[\"\".concat(this.uploadName, \"Loading\")] = true;\n    },\n    inputChanges: function inputChanges(value, name) {\n      // 中国 - 姓名\n      if (name === 'name') {\n        this.checkValue2 = value; // 外国 - 姓\n      } else if (name === 'kycFamilyName') {\n        this.kycFamilyName = value; // 外国 - 名\n      } else if (name === 'kycName') {\n        this.kycName = value; // 证件号码\n      } else {\n        this.checkValue1 = value;\n      }\n    },\n    checkFocus: function checkFocus(name) {\n      switch (name) {\n        case 'email':\n          {\n            // email\n            this.checkErrorFlag1 = false;\n            this.errorText1 = '';\n            break;\n          }\n\n        case '2':\n          {\n            // emailCode\n            break;\n          }\n\n        default:\n          {// newpassword again\n          }\n      }\n    },\n    btnLink: function btnLink(num) {\n      if (num === 1) {\n        this.active = '2';\n      } else {\n        this.loading = true;\n        var type = 1;\n\n        if (this.kycType === '2') {\n          type = this.certificateType;\n        } // 如果是中国并且是开启了简版自动kyc请求\n\n\n        if (this.nameVerifiedType === '02' && this.kycType === '1') {\n          var _info = {\n            countryCode: \"+\".concat(this.kycPhoneCode),\n            // 电话编码\n            numberCode: this.kycPhone,\n            // 国家代码\n            certificateType: type,\n            // 证件类型\n            cardNo: this.checkValue1,\n            // 证件号\n            name: this.checkValue2 || undefined,\n            // 中国 - 姓名\n            photo_front: this.firstPhotoImgSrc,\n            photo_back: this.secondPhotoImgSrc,\n            photo_living: this.thirdPhotoImgSrc\n          };\n          this.$store.dispatch('authRealname', {\n            info: _info,\n            kycFlag: true\n          });\n          return;\n        }\n\n        var info = {\n          countryCode: \"+\".concat(this.kycPhoneCode),\n          // 电话编码\n          numberCode: this.kycPhone,\n          // 国家代码\n          certificateType: type,\n          // 证件类型\n          certificateNumber: this.checkValue1,\n          // 证件号\n          userName: this.checkValue2 || undefined,\n          // 中国 - 姓名\n          firstPhoto: this.firstPhoto,\n          secondPhoto: this.secondPhoto,\n          thirdPhoto: this.thirdPhoto,\n          familyName: this.kycFamilyName || undefined,\n          // 外国姓\n          name: this.kycName || undefined // 外国名\n\n        };\n        this.$store.dispatch('authRealname', {\n          info: info,\n          kycFlag: false\n        });\n      }\n    }\n  }\n};",null]}