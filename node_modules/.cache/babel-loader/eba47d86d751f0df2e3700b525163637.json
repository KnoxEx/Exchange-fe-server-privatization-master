{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/order/otcOrder/otcOrder.js","dependencies":[{"path":"/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/order/otcOrder/otcOrder.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport { imgMap, colorMap, fixD, getCoinShowName } from '@/utils';\nexport default {\n  name: 'page-otcOrder',\n  data: function data() {\n    return {\n      imgMap: imgMap,\n      colorMap: colorMap,\n      switchFlag: false,\n      tabelLoading: true,\n      tabelList: [],\n      nowType: 1,\n      // 1为当前委托 2为历史委托\n      symbol: 'all',\n      // 当前币种\n      symbolList: [],\n      // 币种选择列表\n      side: 'all',\n      // 方向\n      paginationObj: {\n        total: 0,\n        // 数据总条数\n        display: 10,\n        // 每页显示条数\n        currentPage: 1 // 当前页码\n\n      }\n    };\n  },\n  watch: {\n    market: function market(v) {\n      if (v) {\n        this.initSymbolList();\n      }\n    }\n  },\n  computed: {\n    linkurl: function linkurl() {\n      if (this.$store.state.baseData.publicInfo) {\n        return this.$store.state.baseData.publicInfo.url;\n      }\n\n      return {};\n    },\n    excheifFlag: function excheifFlag() {\n      return this.$store.state.baseData.exchief_project_switch;\n    },\n    navTab: function navTab() {\n      return [// 当前委托\n      {\n        name: this.$t('order.otcOrder.nowOrder'),\n        index: 1\n      }, // 历史委托\n      {\n        name: this.$t('order.otcOrder.hisOrder'),\n        index: 2\n      }];\n    },\n    sideList: function sideList() {\n      return [// 方向选择列表\n      // 全部\n      {\n        code: 'all',\n        value: this.$t('order.otcOrder.all')\n      }, // 买入\n      {\n        code: 'buy',\n        value: this.$t('order.otcOrder.buy')\n      }, // 卖出\n      {\n        code: 'sell',\n        value: this.$t('order.otcOrder.sell')\n      }];\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    axiosSide: function axiosSide() {\n      if (this.side === 'all') {\n        return '';\n      }\n\n      return this.side;\n    },\n    axiosSymbol: function axiosSymbol() {\n      if (this.symbol === 'all') {\n        return undefined;\n      }\n\n      return this.symbol;\n    },\n    // 表格title\n    columns: function columns() {\n      var _this = this;\n\n      var list = [];\n\n      if (this.nowType === 1) {\n        list = [{\n          title: this.$t('order.otcOrder.nowOrderId')\n        }, // 订单号\n        {\n          title: this.$t('order.otcOrder.nowOrderType')\n        }, // 类别\n        {\n          title: this.$t('order.otcOrder.nowOrderCoin')\n        }, // 币种\n        {\n          title: this.$t('order.otcOrder.nowOrderPirce')\n        }, // 价格\n        {\n          title: this.$t('order.otcOrder.nowOrderVolume')\n        }, // 数量\n        {\n          title: this.$t('order.otcOrder.nowOrderTotol')\n        }, // 交易额\n        {\n          title: this.$t('order.otcOrder.service')\n        }, // 手续费\n        {\n          title: this.$t('order.otcOrder.nowOrderStatus')\n        }, // 状态\n        {\n          title: this.$t('order.otcOrder.nowOrderUser')\n        } // 交易方\n        ];\n      }\n\n      if (this.nowType === 2) {\n        list = [{\n          title: this.$t('order.otcOrder.hisOrderId')\n        }, // 订单号\n        {\n          title: this.$t('order.otcOrder.hisOrderType')\n        }, // 类别\n        {\n          title: this.$t('order.otcOrder.hisOrderCoin')\n        }, // 币种\n        {\n          title: this.$t('order.otcOrder.hisOrderPirce')\n        }, // 价格\n        {\n          title: this.$t('order.otcOrder.hisOrderVolume')\n        }, // 数量\n        {\n          title: this.$t('order.otcOrder.hisOrderTotol')\n        }, // 交易额\n        {\n          title: this.$t('order.otcOrder.service')\n        }, // 手续费\n        {\n          title: this.$t('order.otcOrder.hisOrderStatus')\n        }, // 状态\n        {\n          title: this.$t('order.otcOrder.hisOrderUser')\n        } // 交易方\n        ];\n      }\n\n      if (!this.excheifFlag) {\n        list.forEach(function (item, i) {\n          if (item.title === _this.$t('order.otcOrder.service')) {\n            list.splice(i, 1);\n          }\n        });\n      }\n\n      return list;\n    },\n    baseData: function baseData() {\n      return this.$store.state.baseData;\n    },\n    otcLinkUrl: function otcLinkUrl() {\n      var obj = {\n        url: '',\n        type: '' // 1为push 2为herf\n\n      }; // 开发\n\n      if (process.env.NODE_ENV === 'development') {\n        obj.url = '';\n        obj.type = '1'; // 线上\n      } else if (window.HOSTAPI === 'ex' && this.baseData.publicInfo) {\n        obj.url = this.$store.state.baseData.publicInfo.url.otcUrl;\n        obj.type = '2';\n      } else if (window.HOSTAPI === 'otc') {\n        obj.url = '';\n        obj.type = '1';\n      }\n\n      return obj;\n    }\n  },\n  methods: {\n    getFix: function getFix(coin) {\n      return this.market.coinList[coin.toLocaleUpperCase()].showPrecision;\n    },\n    currentCoinPriceFix: function currentCoinPriceFix(price, coin, payCoin) {\n      var fix = this.$store.state.baseData.defaultFiatPrecision;\n\n      if (payCoin && this.market && this.market.coinList[coin] && this.market.coinList[coin].fiatPrecision && this.market.coinList[coin].fiatPrecision[payCoin.toLowerCase()]) {\n        fix = this.market.coinList[coin].fiatPrecision[payCoin.toLowerCase()];\n        return fixD(price, fix) + payCoin;\n      }\n\n      return price;\n    },\n    init: function init() {\n      if (this.market) {\n        this.initSymbolList();\n      }\n    },\n    switchChange: function switchChange() {\n      this.switchFlag = !this.switchFlag;\n      this.getData();\n    },\n    initSymbolList: function initSymbolList() {\n      var coinList = this.market.coinList;\n      var list = [{\n        code: 'all',\n        value: this.$t('order.otcOrder.allCoin')\n      }];\n      Object.keys(coinList).forEach(function (item) {\n        if (coinList[item].otcOpen) {\n          list.push({\n            code: item,\n            value: getCoinShowName(item, coinList)\n          });\n        }\n      });\n      this.symbol = 'all';\n      this.symbolList = list; // if (list.length) { this.symbol = list[0].code; }\n\n      this.getData();\n    },\n    getData: function getData() {\n      if (this.nowType === 1) {\n        this.getNowData();\n      } else if (this.nowType === 2) {\n        this.getHisData();\n      }\n    },\n    // 获取当前\n    getNowData: function getNowData() {\n      var _this2 = this;\n\n      var url = '/order/otc/unfinished';\n      this.axios({\n        url: url,\n        method: 'post',\n        params: {\n          // side: this.axiosSide,\n          pageSize: this.paginationObj.display,\n          // 每页条数\n          page: this.paginationObj.currentPage,\n          // 页码\n          coinSymbol: this.axiosSymbol\n        }\n      }).then(function (data) {\n        if (_this2.nowType !== 1) return;\n        _this2.tabelLoading = false;\n\n        if (data.code.toString() === '0') {\n          var list = [];\n          data.data.orderList.forEach(function (item) {\n            var Aurl = '';\n\n            if (process.env.NODE_ENV === 'development') {\n              Aurl = \"/otcDetailOrder?orderId=\".concat(item.sequence);\n            } else {\n              Aurl = \"\".concat(_this2.linkurl.otcUrl, \"/otcDetailOrder?orderId=\").concat(item.sequence);\n            }\n\n            var block = '';\n\n            if (item.orderType) {\n              Aurl = item.url;\n              block = 'target=\"view_frame\"';\n            }\n\n            var Flist = [// 订单号\n            [{\n              // type: 'link', text: item.sequence, eventType: 'orderId', classes: ['orderId'],\n              type: 'icon',\n              // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n              iconSvg: \"<a class=\\\"u-8-cl\\\" \".concat(block, \" href=\\\"\").concat(Aurl, \"\\\">\").concat(item.sequence, \"</a>\")\n            }], [{\n              text: item.type,\n              classes: item.side === 'BUY' ? 'b-5-cl' : 'b-6-cl'\n            }], getCoinShowName(item.coinSymbol, _this2.market.coinList), // 币种\n            _this2.currentCoinPriceFix(item.price, item.coinSymbol, item.payCoin), // 价格\n            fixD(item.volume, _this2.getFix(item.coinSymbol)), // 数量\n            _this2.currentCoinPriceFix(item.totalPrice, item.coinSymbol, item.payCoin) // 交易额\n            ];\n\n            if (_this2.excheifFlag) {\n              Flist.push(item.relativeFee);\n            }\n\n            var Vlist = [item.status_text, // 状态\n            // 交易对方\n            item.orderType ? item.realName : [{\n              type: 'button',\n              text: item.nickName,\n              eventType: 'userName',\n              subContent: {\n                text: item.realName,\n                classes: ['e-2-cl'] // 默认没有\n\n              }\n            }]];\n            Flist = Flist.concat(Vlist);\n            list.push({\n              id: JSON.stringify(item),\n              data: Flist\n            });\n          });\n          _this2.tabelList = list;\n          _this2.paginationObj.total = data.data.count;\n        }\n      });\n    },\n    // 获取历史订单\n    getHisData: function getHisData() {\n      var _this3 = this;\n\n      var url = '/order/otc/complete';\n      this.axios({\n        url: url,\n        method: 'post',\n        params: {\n          // side: this.axiosSide,\n          isShowCanceled: this.switchFlag ? 1 : 0,\n          pageSize: this.paginationObj.display,\n          // 每页条数\n          page: this.paginationObj.currentPage,\n          // 页码\n          coinSymbol: this.axiosSymbol\n        }\n      }).then(function (data) {\n        if (_this3.nowType !== 2) return;\n        _this3.tabelLoading = false;\n\n        if (data.code.toString() === '0') {\n          var list = [];\n          data.data.orderList.forEach(function (item) {\n            var Aurl = '';\n\n            if (process.env.NODE_ENV === 'development') {\n              Aurl = \"/otcDetailOrder?orderId=\".concat(item.sequence);\n            } else {\n              Aurl = \"\".concat(_this3.linkurl.otcUrl, \"/otcDetailOrder?orderId=\").concat(item.sequence);\n            }\n\n            var block = '';\n\n            if (item.orderType) {\n              Aurl = item.url;\n              block = 'target=\"view_frame\"';\n            }\n\n            var flist = [// 订单号\n            [{\n              // type: 'link', text: item.sequence, eventType: 'orderId', classes: ['orderId'],\n              type: 'icon',\n              // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n              iconSvg: \"<a class=\\\"u-8-cl\\\" \".concat(block, \" href=\\\"\").concat(Aurl, \"\\\">\").concat(item.sequence, \"</a>\")\n            }], [{\n              text: item.type,\n              classes: item.side === 'BUY' ? 'b-5-cl' : 'b-6-cl'\n            }], getCoinShowName(item.coinSymbol, _this3.market.coinList), // 币种\n            _this3.currentCoinPriceFix(item.price, item.coinSymbol, item.payCoin), // 价格\n            fixD(item.volume, _this3.getFix(item.coinSymbol)), // 数量\n            _this3.currentCoinPriceFix(item.totalPrice, item.coinSymbol, item.payCoin) // 交易额\n            ];\n\n            if (_this3.excheifFlag) {\n              flist.push(item.relativeFee);\n            }\n\n            var Vlist = [item.status_text, // 状态\n            // 交易对方\n            item.orderType ? item.realName : [{\n              type: 'button',\n              text: item.nickName,\n              eventType: 'userName',\n              subContent: {\n                text: item.realName,\n                classes: ['e-2-cl'] // 默认没有\n\n              }\n            }]];\n            flist = flist.concat(Vlist);\n            list.push({\n              id: JSON.stringify(item),\n              data: flist\n            });\n          });\n          _this3.tabelList = list;\n          _this3.paginationObj.total = data.data.count;\n        }\n      });\n    },\n    // 切换委托\n    currentType: function currentType(item) {\n      if (this.nowType === item.index) {\n        return;\n      }\n\n      this.nowType = item.index;\n      this.paginationObj.currentPage = 1; // 页码\n\n      this.paginationObj.total = 0; // 总条数\n\n      this.tabelList = [];\n      this.tabelLoading = true;\n      this.getData();\n    },\n    // 切换币种\n    symbolChange: function symbolChange(item) {\n      if (this.symbol === item.code) {\n        return;\n      }\n\n      this.symbol = item.code;\n      this.paginationObj.currentPage = 1; // 页码\n\n      this.paginationObj.total = 0; // 总条数\n\n      this.tabelList = [];\n      this.tabelLoading = true;\n      this.getData();\n    },\n    // 切换方向\n    sideChange: function sideChange(item) {\n      if (this.side === item.code) {\n        return;\n      }\n\n      this.side = item.code;\n      this.paginationObj.currentPage = 1; // 页码\n\n      this.paginationObj.total = 0; // 总条数\n\n      this.tabelList = [];\n      this.tabelLoading = true;\n      this.getData();\n    },\n    tableClick: function tableClick(type, v) {\n      var data = JSON.parse(v);\n\n      if (type === 'orderId') {\n        if (this.otcLinkUrl.type === '1') {\n          this.$router.push(\"\".concat(this.otcLinkUrl.url, \"/otcDetailOrder?orderId=\").concat(data.sequence));\n        } else if (this.otcLinkUrl.type === '2') {\n          window.location.href = \"\".concat(this.otcLinkUrl.url, \"/otcDetailOrder?orderId=\").concat(data.sequence);\n        }\n      } else if (type === 'userName') {\n        var id = '';\n\n        if (data.side === 'BUY') {\n          id = data.sellerId;\n        } else if (data.side === 'SELL') {\n          id = data.buyerId;\n        }\n\n        if (this.otcLinkUrl.type === '1') {\n          this.$router.push(\"\".concat(this.otcLinkUrl.url, \"/stranger?uid=\").concat(id));\n        } else if (this.otcLinkUrl.type === '2') {\n          window.location.href = \"\".concat(this.otcLinkUrl.url, \"/stranger?uid=\").concat(id);\n        }\n      }\n    },\n    pagechange: function pagechange(v) {\n      this.paginationObj.currentPage = v;\n      this.getData();\n    }\n  }\n};",null]}