{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/Downloads/BlockChain-ui-privatization/PC/common-mixin/personal/krwBank/krwBank.js","dependencies":[{"path":"/Users/h/Downloads/BlockChain-ui-privatization/PC/common-mixin/personal/krwBank/krwBank.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.to-string\";\nexport default {\n  name: 'changePassword',\n  data: function data() {\n    return {\n      userName: '',\n      // 户名\n      backType: '',\n      // 开户行\n      bankAccount: '',\n      // 银行账号\n      // 开户行列表\n      backTypeOptions: [],\n      smsCode: '',\n      googleCode: '',\n      submitLoading: false // 提交按钮loading\n\n    };\n  },\n  watch: {\n    userInfo: function userInfo(v) {\n      if (v) {\n        if (v.realName.length) {\n          this.userName = v.realName;\n        } else {\n          this.userName = v.phone_auth_name;\n        }\n\n        this.initStatus();\n      }\n    }\n  },\n  computed: {\n    // 用户是否开启谷歌\n    OpenGoogle: function OpenGoogle() {\n      var flag = false;\n      var userInfo = this.$store.state.baseData.userInfo;\n\n      if (userInfo && userInfo.googleStatus.toString() === '1') {\n        flag = true;\n      }\n\n      return flag;\n    },\n    // 该用户是否完成nice认证\n    krwPhoneAuth: function krwPhoneAuth() {\n      var str = '0';\n\n      if (this.userInfo && this.userInfo.is_krw_phone_auth) {\n        str = this.userInfo.is_krw_phone_auth.toString();\n      }\n\n      return str;\n    },\n    authLevel: function authLevel() {\n      var str = '';\n\n      if (this.userInfo) {\n        str = this.userInfo.authLevel.toString();\n      }\n\n      return str;\n    },\n    krwUserBank: function krwUserBank() {\n      return this.$store.state.personal.krwUserBank;\n    },\n    regExps: function regExps() {\n      return this.$store.state.regExp;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    // 用户是否开启手机\n    OpenMobile: function OpenMobile() {\n      var flag = false;\n      var userInfo = this.$store.state.baseData.userInfo;\n\n      if (userInfo && userInfo.isOpenMobileCheck.toString() === '1') {\n        flag = true;\n      }\n\n      return flag;\n    },\n    // 银行账号\n    bankAccountFlag: function bankAccountFlag() {\n      return this.regExps.number.test(this.bankAccount);\n    },\n    // 银行账号是否为错误\n    bankAccountErrorFlag: function bankAccountErrorFlag() {\n      if (this.bankAccount.length !== 0 && !this.bankAccountFlag) return true;\n      return false;\n    },\n    // 短信验证码 -- 正则验证\n    smsCodeFlag: function smsCodeFlag() {\n      return this.regExps.verification.test(this.smsCode);\n    },\n    // 银行账号是否为错误\n    smsCodeFlagErrorFlag: function smsCodeFlagErrorFlag() {\n      if (this.smsCode.length !== 0 && !this.smsCodeFlag) return true;\n      return false;\n    },\n    // 谷歌验证码 -- 正则验证\n    googleCodeFlag: function googleCodeFlag() {\n      return this.regExps.verification.test(this.googleCode);\n    },\n    // 银行账号是否为错误\n    googleCodeFlagErrorFlag: function googleCodeFlagErrorFlag() {\n      if (this.googleCode.length !== 0 && !this.googleCodeFlag) return true;\n      return false;\n    },\n    submitDisabled: function submitDisabled() {\n      var phone = true;\n      var google = true;\n\n      if (this.OpenMobile) {\n        phone = this.smsCodeFlag;\n      }\n\n      if (this.OpenGoogle) {\n        google = this.googleCodeFlag;\n      }\n\n      if (this.backType.length && this.bankAccountFlag && phone && google || this.submitLoading) {\n        return false;\n      }\n\n      return true;\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      if (this.userInfo) {\n        if (this.userInfo.realName.length) {\n          this.userName = this.userInfo.realName;\n        } else {\n          this.userName = this.userInfo.phone_auth_name;\n        }\n\n        this.initStatus();\n      }\n\n      this.axios({\n        url: 'bank/all',\n        method: 'post'\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          var arr = [];\n          data.data.forEach(function (item) {\n            arr.push({\n              value: item.name,\n              code: item.id.toString()\n            });\n          });\n\n          if (arr.length) {\n            _this.backType = arr[0].code;\n          }\n\n          _this.backTypeOptions = arr;\n        }\n      });\n    },\n    initStatus: function initStatus() {\n      var authFlag = false;\n\n      if (this.krwPhoneAuth === '1' || this.authLevel === '1') {\n        authFlag = true;\n      }\n\n      if (!this.OpenGoogle || !authFlag) {\n        this.$router.push('/personal/userManagement');\n      }\n    },\n    submit: function submit() {\n      var _this2 = this;\n\n      this.submitLoading = true;\n      var url = 'user/bank/add'; // this.userName = '1'\n\n      var params = {\n        bankNo: this.backType,\n        // 开户行id\n        cardNo: this.bankAccount,\n        // 银行账号\n        name: this.userName,\n        // 姓名\n        smsAuthCode: this.smsCode,\n        googleCode: this.googleCode\n      }; // 修改\n\n      if (this.krwUserBank) {\n        url = 'user/bank/edit';\n        params.id = this.krwUserBank.id;\n      }\n\n      this.axios({\n        url: url,\n        params: params\n      }).then(function (data) {\n        _this2.submitLoading = false;\n\n        if (data.code.toString() !== '0') {\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        } else {\n          _this2.$store.dispatch('krwGetUserBank');\n\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n\n          _this2.$router.push('/personal/userManagement');\n        }\n      });\n    },\n    getCodeClick: function getCodeClick() {\n      var _this3 = this;\n\n      var operationType = '30';\n\n      if (this.krwUserBank) {\n        operationType = '31';\n      }\n\n      this.axios({\n        url: 'v4/common/smsValidCode',\n        params: {\n          operationType: operationType\n        }\n      }).then(function (data) {\n        if (data.code.toString() !== '0') {\n          setTimeout(function () {\n            // 倒计时重置\n            _this3.$bus.$emit('getCode-clear', 'smsCode'); // tip框提示错误\n\n\n            _this3.$bus.$emit('tip', {\n              text: data.msg,\n              type: 'error'\n            });\n          }, 2000);\n        } else {\n          // 短信已发送，请注意查收\n          _this3.$bus.$emit('tip', {\n            text: _this3.$t('assets.addressMent.phoneSendSuccess'),\n            type: 'success'\n          });\n        }\n      });\n    },\n    inputChanges: function inputChanges(value, name) {\n      this[name] = value;\n    },\n    backTypeChange: function backTypeChange(item) {\n      this.backType = item.code;\n    }\n  }\n};",{"version":3,"sources":["/Users/h/Downloads/BlockChain-ui-privatization/PC/common-mixin/personal/krwBank/krwBank.js"],"names":["name","data","userName","backType","bankAccount","backTypeOptions","smsCode","googleCode","submitLoading","watch","userInfo","v","realName","length","phone_auth_name","initStatus","computed","OpenGoogle","flag","$store","state","baseData","googleStatus","toString","krwPhoneAuth","str","is_krw_phone_auth","authLevel","krwUserBank","personal","regExps","regExp","OpenMobile","isOpenMobileCheck","bankAccountFlag","number","test","bankAccountErrorFlag","smsCodeFlag","verification","smsCodeFlagErrorFlag","googleCodeFlag","googleCodeFlagErrorFlag","submitDisabled","phone","google","methods","init","axios","url","method","then","code","arr","forEach","item","push","value","id","authFlag","$router","submit","params","bankNo","cardNo","smsAuthCode","$bus","$emit","text","msg","type","dispatch","getCodeClick","operationType","setTimeout","$t","inputChanges","backTypeChange"],"mappings":"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","sourcesContent":["export default {\r\n  name: 'changePassword',\r\n  data() {\r\n    return {\r\n      userName: '', // 户名\r\n      backType: '', // 开户行\r\n      bankAccount: '', // 银行账号\r\n      // 开户行列表\r\n      backTypeOptions: [],\r\n      smsCode: '',\r\n      googleCode: '',\r\n      submitLoading: false, // 提交按钮loading\r\n    };\r\n  },\r\n  watch: {\r\n    userInfo(v) {\r\n      if (v) {\r\n        if (v.realName.length) {\r\n          this.userName = v.realName;\r\n        } else {\r\n          this.userName = v.phone_auth_name;\r\n        }\r\n        this.initStatus();\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    // 用户是否开启谷歌\r\n    OpenGoogle() {\r\n      let flag = false;\r\n      const { userInfo } = this.$store.state.baseData;\r\n      if (userInfo && userInfo.googleStatus.toString() === '1') {\r\n        flag = true;\r\n      }\r\n      return flag;\r\n    },\r\n    // 该用户是否完成nice认证\r\n    krwPhoneAuth() {\r\n      let str = '0';\r\n      if (this.userInfo\r\n        && this.userInfo.is_krw_phone_auth) {\r\n        str = this.userInfo.is_krw_phone_auth.toString();\r\n      }\r\n      return str;\r\n    },\r\n    authLevel() {\r\n      let str = '';\r\n      if (this.userInfo) {\r\n        str = this.userInfo.authLevel.toString();\r\n      }\r\n      return str;\r\n    },\r\n    krwUserBank() {\r\n      return this.$store.state.personal.krwUserBank;\r\n    },\r\n    regExps() { return this.$store.state.regExp; },\r\n    userInfo() {\r\n      return this.$store.state.baseData.userInfo;\r\n    },\r\n    // 用户是否开启手机\r\n    OpenMobile() {\r\n      let flag = false;\r\n      const { userInfo } = this.$store.state.baseData;\r\n      if (userInfo && userInfo.isOpenMobileCheck.toString() === '1') {\r\n        flag = true;\r\n      }\r\n      return flag;\r\n    },\r\n    // 银行账号\r\n    bankAccountFlag() { return this.regExps.number.test(this.bankAccount); },\r\n    // 银行账号是否为错误\r\n    bankAccountErrorFlag() {\r\n      if (this.bankAccount.length !== 0 && !this.bankAccountFlag) return true;\r\n      return false;\r\n    },\r\n    // 短信验证码 -- 正则验证\r\n    smsCodeFlag() { return this.regExps.verification.test(this.smsCode); },\r\n    // 银行账号是否为错误\r\n    smsCodeFlagErrorFlag() {\r\n      if (this.smsCode.length !== 0 && !this.smsCodeFlag) return true;\r\n      return false;\r\n    },\r\n    // 谷歌验证码 -- 正则验证\r\n    googleCodeFlag() { return this.regExps.verification.test(this.googleCode); },\r\n    // 银行账号是否为错误\r\n    googleCodeFlagErrorFlag() {\r\n      if (this.googleCode.length !== 0 && !this.googleCodeFlag) return true;\r\n      return false;\r\n    },\r\n    submitDisabled() {\r\n      let phone = true;\r\n      let google = true;\r\n      if (this.OpenMobile) { phone = this.smsCodeFlag; }\r\n      if (this.OpenGoogle) { google = this.googleCodeFlag; }\r\n      if ((this.backType.length\r\n       && this.bankAccountFlag\r\n       && phone && google) || this.submitLoading) {\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      if (this.userInfo) {\r\n        if (this.userInfo.realName.length) {\r\n          this.userName = this.userInfo.realName;\r\n        } else {\r\n          this.userName = this.userInfo.phone_auth_name;\r\n        }\r\n        this.initStatus();\r\n      }\r\n      this.axios({\r\n        url: 'bank/all',\r\n        method: 'post',\r\n      }).then((data) => {\r\n        if (data.code.toString() === '0') {\r\n          const arr = [];\r\n          data.data.forEach((item) => {\r\n            arr.push({\r\n              value: item.name,\r\n              code: item.id.toString(),\r\n            });\r\n          });\r\n          if (arr.length) {\r\n            this.backType = arr[0].code;\r\n          }\r\n          this.backTypeOptions = arr;\r\n        }\r\n      });\r\n    },\r\n    initStatus() {\r\n      let authFlag = false;\r\n      if (this.krwPhoneAuth === '1' || this.authLevel === '1') {\r\n        authFlag = true;\r\n      }\r\n      if (!this.OpenGoogle || !authFlag) {\r\n        this.$router.push('/personal/userManagement');\r\n      }\r\n    },\r\n    submit() {\r\n      this.submitLoading = true;\r\n      let url = 'user/bank/add';\r\n      // this.userName = '1'\r\n      const params = {\r\n        bankNo: this.backType, // 开户行id\r\n        cardNo: this.bankAccount, // 银行账号\r\n        name: this.userName, // 姓名\r\n        smsAuthCode: this.smsCode,\r\n        googleCode: this.googleCode,\r\n      };\r\n      // 修改\r\n      if (this.krwUserBank) {\r\n        url = 'user/bank/edit';\r\n        params.id = this.krwUserBank.id;\r\n      }\r\n      this.axios({\r\n        url,\r\n        params,\r\n      }).then((data) => {\r\n        this.submitLoading = false;\r\n        if (data.code.toString() !== '0') {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        } else {\r\n          this.$store.dispatch('krwGetUserBank');\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'success' });\r\n          this.$router.push('/personal/userManagement');\r\n        }\r\n      });\r\n    },\r\n    getCodeClick() {\r\n      let operationType = '30';\r\n      if (this.krwUserBank) {\r\n        operationType = '31';\r\n      }\r\n      this.axios({\r\n        url: 'v4/common/smsValidCode',\r\n        params: { operationType },\r\n      }).then((data) => {\r\n        if (data.code.toString() !== '0') {\r\n          setTimeout(() => {\r\n            // 倒计时重置\r\n            this.$bus.$emit('getCode-clear', 'smsCode');\r\n            // tip框提示错误\r\n            this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n          }, 2000);\r\n        } else {\r\n          // 短信已发送，请注意查收\r\n          this.$bus.$emit('tip', { text: this.$t('assets.addressMent.phoneSendSuccess'), type: 'success' });\r\n        }\r\n      });\r\n    },\r\n    inputChanges(value, name) {\r\n      this[name] = value;\r\n    },\r\n    backTypeChange(item) {\r\n      this.backType = item.code;\r\n    },\r\n  },\r\n};\r\n"]}]}