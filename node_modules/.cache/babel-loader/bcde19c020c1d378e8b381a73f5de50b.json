{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/assets/exchangeAccount/exchangeAccount.js","dependencies":[{"path":"/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/assets/exchangeAccount/exchangeAccount.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.sort\";\nimport _toConsumableArray from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.number.constructor\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { myStorage, fixD, fixRate, getCoinShowName, colorMap, imgMap } from '@/utils';\nexport default {\n  name: 'page-exchangeAccount',\n  data: function data() {\n    return {\n      tabelLoading: true,\n      exchangeHeader: \"background: url(\".concat(imgMap.zc_ex, \")\"),\n      tabelLength: 20,\n      imgMap: imgMap,\n      colorMap: colorMap,\n      switchFlag: false,\n      // 是否隐藏零资产\n      findValue: '',\n      // 搜索框内容\n      dataList: [],\n      totalBalance: '--',\n      // 总资产折合\n      totalRate: '--',\n      // 折合法币\n      totalBalanceSymbol: '',\n      // 总资产折合单位\n      colors: ['rgba(255, 255, 255, 1)', 'rgba(255, 255, 255, 0.8)', 'rgba(255, 255, 255, 0.6)', 'rgba(255, 255, 255, 0.4)', 'rgba(255, 255, 255, 0.25)', 'rgba(255, 255, 255, 0.1)'],\n      // colors: ['red', 'blue', 'pink', 'green', '#fff', '#000'],\n      canvasPages: [],\n      havePosition: false,\n      // 平台锁仓\n      positionV2: false,\n      // 代币锁仓\n      positionV3: false,\n      // 理财锁仓\n      searchTimer: null,\n      searchListResult: [],\n      search: false,\n      isShowDialog: false\n    };\n  },\n  computed: {\n    baseData: function baseData() {\n      return this.$store.state.baseData.publicInfo;\n    },\n    isCoOpen: function isCoOpen() {\n      var base = this.$store.state.baseData.publicInfo;\n\n      if (base && base.switch && base.switch.indep_co_switch === '1') {\n        return true;\n      }\n\n      return false;\n    },\n    // 提现是否开启了必须实名认证\n    withdrawKycOpen: function withdrawKycOpen() {\n      var isOpen = 0;\n\n      if (this.baseData && this.baseData.kycLimitConfig) {\n        isOpen = this.baseData.kycLimitConfig.withdraw_kyc_open;\n      }\n\n      return Number(isOpen);\n    },\n    // 充值是否开启了必须实名认证\n    depositeKycOpen: function depositeKycOpen() {\n      var isOpen = 0;\n\n      if (this.baseData && this.baseData.kycLimitConfig) {\n        isOpen = this.baseData.kycLimitConfig.deposite_kyc_open;\n      }\n\n      return Number(isOpen);\n    },\n    // 用户信息\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    // 认证信息\n    idAuth: function idAuth() {\n      var idAuth = 0;\n\n      if (this.userInfo) {\n        idAuth = Number(this.userInfo.authLevel);\n      }\n\n      return idAuth;\n    },\n    linkurl: function linkurl() {\n      if (this.$store.state.baseData.publicInfo) {\n        return this.$store.state.baseData.publicInfo.url;\n      }\n\n      return {};\n    },\n    tradeLinkUrl: function tradeLinkUrl() {\n      if (process.env.NODE_ENV === 'development') {\n        return this.isCoOpen ? '/co/trade' : '/ex/trade';\n      }\n\n      if (this.$store.state.baseData && this.$store.state.baseData.publicInfo) {\n        return this.isCoOpen ? \"\".concat(this.linkurl.coUrl, \"/trade\") : \"\".concat(this.linkurl.exUrl, \"/trade\");\n      }\n\n      return '';\n    },\n    // 表格title\n    columns: function columns() {\n      var arr = [];\n\n      if (this.havePosition || this.positionV2 || this.positionV3) {\n        arr = [{\n          title: this.$t('assets.exchangeAccount.position'),\n          width: ''\n        }];\n      }\n\n      return [{\n        title: this.$t('assets.exchangeAccount.coin'),\n        width: '100px'\n      }, // 币种\n      {\n        title: this.$t('assets.exchangeAccount.lumpSum'),\n        width: ''\n      }, // 总额\n      {\n        title: this.$t('assets.exchangeAccount.Available'),\n        width: ''\n      }, // 可用\n      {\n        title: this.$t('assets.exchangeAccount.freeze'),\n        width: ''\n      }].concat(_toConsumableArray(arr), [{\n        title: \"\".concat(this.$t('assets.exchangeAccount.AssetFolding'), \"(\").concat(this.showTotalBalanceSymbol, \")\"),\n        width: ''\n      }, // 资产折合\n      {\n        title: this.$t('assets.exchangeAccount.options'),\n        width: '200px'\n      } // 操作\n      ]);\n    },\n    // finance/account_balance 接口返回成功的数据\n    exchangeData: function exchangeData() {\n      return this.$store.state.assets.exchangeData;\n    },\n    // market 接口\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    // 饼图 数据（包含饼图 和 指标）\n    canvasPagesFilter: function canvasPagesFilter() {\n      var _this = this;\n\n      var arr = []; // 去除零资产\n\n      var list = this.canvasPages.filter(function (item) {\n        return parseFloat(item.spk) > 0;\n      }); // 排序\n\n      list.sort(this.compare('spk')); // 非0资产的币种少于6种时\n\n      if (list.length < 6) {\n        list.forEach(function (item, index) {\n          var coinList = _this.market.coinList;\n          var coinName = getCoinShowName(item.symbol, coinList);\n          arr.push(_objectSpread(_objectSpread({}, item), {}, {\n            symbol: coinName,\n            color: _this.colors[index]\n          }));\n        }); // 非0资产的币种多于等于6种时\n      } else if (list.length >= 6) {\n        var evenSum = 0; // 选出前五个\n\n        list.forEach(function (item, index) {\n          if (index < 5) {\n            var coinList = _this.market.coinList;\n            var coinName = getCoinShowName(item.symbol, coinList);\n            arr.push(_objectSpread(_objectSpread({}, item), {}, {\n              symbol: coinName,\n              color: _this.colors[index]\n            }));\n          } else {\n            evenSum += item.spk;\n          }\n        }); // 剩余币种归纳为其他\n\n        arr.push({\n          symbol: this.$t('assets.exchangeAccount.other'),\n          // 其他\n          spk: evenSum,\n          color: this.colors[5]\n        });\n      }\n\n      return arr;\n    },\n    showTotalBalanceSymbol: function showTotalBalanceSymbol() {\n      var str = this.totalBalanceSymbol;\n\n      if (this.market && this.market.coinList && this.market.coinList[this.totalBalanceSymbol]) {\n        str = getCoinShowName(this.totalBalanceSymbol, this.market.coinList);\n      }\n\n      return str;\n    }\n  },\n  watch: {\n    exchangeData: function exchangeData(v) {\n      if (v && this.market) {\n        this.setData();\n      }\n    },\n    market: function market(v) {\n      if (v && this.exchangeData) {\n        this.setData();\n      }\n    },\n    canvasPagesFilter: function canvasPagesFilter(v) {\n      if (v.length === 0) {\n        this.canvasInit();\n      } else {\n        this.canvasMap();\n      }\n    }\n  },\n  methods: {\n    init: function init() {\n      if (myStorage.get('assetsSwitch')) {\n        this.switchFlag = myStorage.get('assetsSwitch');\n      }\n\n      this.canvasInit();\n      this.$store.dispatch('assetsExchangeData');\n\n      if (this.exchangeData && this.market) {\n        this.setData();\n      }\n    },\n    setData: function setData() {\n      var _this$exchangeData = this.exchangeData,\n          totalBalance = _this$exchangeData.totalBalance,\n          totalBalanceSymbol = _this$exchangeData.totalBalanceSymbol,\n          platformCoin = _this$exchangeData.platformCoin,\n          allCoinMap = _this$exchangeData.allCoinMap;\n      this.positionV3 = Object.keys(allCoinMap).some(function (key) {\n        return Number(allCoinMap[key].lock_increment_amount) > 0;\n      });\n      var _this$market = this.market,\n          coinList = _this$market.coinList,\n          rate = _this$market.rate;\n      var fix = coinList[totalBalanceSymbol] && coinList[totalBalanceSymbol].showPrecision || 0;\n      this.totalBalance = fixD(totalBalance, fix); // 折合资产\n\n      this.totalBalanceSymbol = totalBalanceSymbol; // 折合币种\n\n      this.totalRate = fixRate(totalBalance, rate, totalBalanceSymbol); // 折合法币\n\n      if (platformCoin && platformCoin.length) {\n        var obj = allCoinMap[platformCoin];\n\n        if (obj && Number(obj.lock_position_balance)) {\n          this.havePosition = true;\n        }\n      }\n\n      if (this.baseData.switch.lock_position_v2_status && this.baseData.switch.lock_position_v2_status.toString() === '1') {\n        this.positionV2 = true;\n      }\n\n      this.setDataList(allCoinMap, totalBalance);\n    },\n    compare: function compare(property) {\n      return function fn(a, b) {\n        var value1 = a[property];\n        var value2 = b[property];\n        return value2 - value1;\n      };\n    },\n    switchChange: function switchChange() {\n      this.switchFlag = !this.switchFlag;\n      myStorage.set('assetsSwitch', this.switchFlag);\n      this.findChanges(this.findValue);\n    },\n    canvasMap: function canvasMap() {\n      var ctx = this.$refs.canvas.getContext('2d');\n      this.$refs.canvas.width = 100;\n      this.$refs.canvas.height = 100;\n      var start = 0;\n      this.canvasPagesFilter.forEach(function (item) {\n        var spk = start + item.spk * 2;\n\n        if (start >= 2) {\n          return;\n        } // 防止 2-xx的值\n\n\n        if (spk > 2) {\n          spk = 2;\n        } // 防止 1.x - 2.x的值\n\n\n        ctx.beginPath();\n        ctx.moveTo(50, 50);\n        ctx.fillStyle = item.color;\n        ctx.arc(50, 50, 50, Math.PI * start, Math.PI * spk);\n        ctx.closePath();\n        ctx.fill();\n        start = spk;\n      });\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#294EBB';\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    },\n    canvasInit: function canvasInit() {\n      var ctx = this.$refs.canvas.getContext('2d');\n      this.$refs.canvas.width = 100;\n      this.$refs.canvas.height = 100;\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#e0e0e0';\n      ctx.arc(50, 50, 50, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#294EBB';\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    },\n    findChanges: function findChanges(v) {\n      var _this2 = this;\n\n      this.findValue = v;\n      if (this.searchTimer) clearTimeout(this.searchTimer);\n\n      if (v !== '') {\n        this.searchTimer = setTimeout(function () {\n          var result = _this2.dataList.filter(function (item) {\n            var isSamll = !_this2.switchFlag || _this2.switchFlag && item.classes !== 'smail-account';\n            var isSearch = isSamll && item.data[0].toUpperCase().indexOf(v.toUpperCase()) !== -1;\n            return isSearch;\n          });\n\n          _this2.searchListResult = result;\n          _this2.search = true;\n        }, 400);\n      } else {\n        this.search = false;\n      }\n    },\n    tableClick: function tableClick(type, symbol) {\n      // 提现\n      if (type === 'withdraw') {\n        // 如果开启了必须认证 并且 未认证成功 禁止提现\n        if (this.withdrawKycOpen && this.idAuth !== 1) {\n          this.isShowDialog = true;\n        } else {\n          this.$router.push(\"withdraw?symbol=\".concat(symbol));\n        }\n      } // 充值\n\n\n      if (type === 'recharge') {\n        if (this.depositeKycOpen && this.idAuth !== 1) {\n          this.isShowDialog = true;\n        } else {\n          this.$router.push(\"recharge?symbol=\".concat(symbol));\n        }\n      }\n\n      if (type === 'goTrade') {\n        var mSymbol = symbol.code;\n\n        if (mSymbol.toString().indexOf('/') === -1) {\n          return;\n        }\n\n        myStorage.set('markTitle', mSymbol.split('/')[1]);\n        myStorage.set('sSymbolName', mSymbol); // this.$router.push('/trade');\n\n        window.location.href = this.tradeLinkUrl;\n      } else if (type === 'goTradeIn') {\n        // this.$router.push('/trade');\n        window.location.href = this.tradeLinkUrl;\n      }\n    },\n    // 弹框取消\n    dialogClose: function dialogClose() {\n      this.isShowDialog = false;\n    },\n    // 去认证\n    gotoAuth: function gotoAuth() {\n      this.$router.push('/personal/userManagement');\n    },\n    setDataList: function setDataList(data, sum) {\n      var _this3 = this;\n\n      var list = [];\n      var canvasList = [];\n      Object.keys(data).forEach(function (item) {\n        if (data[item].isFiat) {\n          return;\n        }\n\n        canvasList.push({\n          symbol: item,\n          spk: data[item].allBtcValuatin / sum\n        }); // 该币种精度\n\n        var _this3$market = _this3.market,\n            coinList = _this3$market.coinList,\n            market = _this3$market.market;\n        var fix = coinList[item] && coinList[item].showPrecision || 0; // 资产折合精度\n\n        var totle = _this3.totalBalanceSymbol;\n        var btcFix = coinList[totle] && coinList[totle].showPrecision || 0; // 逻辑 1 如果 优先找出交易币种为当前货币的\n        //     2 如果 1条件未筛选出，则去看当前货币是否为计价货币 把以该货币为计价货币的币对都加进去\n\n        var selectOption = [];\n        var by = [];\n        Object.keys(market).forEach(function (v) {\n          Object.keys(market[v]).forEach(function (cv) {\n            var showSymbol = market[v][cv].showName || market[v][cv].name;\n\n            if (cv.split('/')[0] === item) {\n              selectOption.push({\n                value: showSymbol,\n                code: market[v][cv].name\n              });\n            }\n\n            if (v === item) {\n              by.push({\n                value: showSymbol,\n                code: market[v][cv].name\n              });\n            }\n          });\n        });\n\n        if (selectOption.length === 0) {\n          selectOption = by;\n        }\n\n        var arr = []; // 平台币锁仓数量\n\n        var lockPositionBalance = data[item].lock_position_balance || '0'; // 代币锁仓数量\n\n        var lockPositionV2Amount = data[item].lock_position_v2_amount || '0'; // 理财锁仓数量\n\n        var lockIncrementAmount = data[item].lock_increment_amount || '0'; // // 判断当前锁仓类型大于一个的时候\n\n        if (_this3.havePosition || _this3.positionV2 || _this3.positionV3) {\n          var num = Number(lockPositionBalance) + Number(lockPositionV2Amount) + Number(lockIncrementAmount);\n          var selectList = [];\n\n          if (Number(lockPositionBalance)) {\n            selectList.push(\"\".concat(_this3.$t('assets.exchangeAccount.positionBalance'), \"\\uFF1A\\n                    \").concat(fixD(lockPositionBalance, fix)));\n          }\n\n          if (Number(lockPositionV2Amount)) {\n            selectList.push(\"\".concat(_this3.$t('assets.exchangeAccount.positionV2Amount'), \"\\uFF1A\\n                  \").concat(fixD(lockPositionV2Amount, fix)));\n          }\n\n          if (Number(lockIncrementAmount)) {\n            selectList.push(\"\".concat(_this3.$t('assets.exchangeAccount.incomeLock'), \"\\uFF1A\").concat(fixD(lockIncrementAmount, fix)));\n          }\n\n          arr = [num ? [{\n            type: 'select',\n            iconSvg: \"<span class=\\\"position\\\">\".concat(fixD(num, fix), \"</span>\"),\n            selectOption: selectList,\n            iconClass: ['aaa'],\n            eventType: '',\n            selectWidth: '150'\n          }] : fixD(num, fix)];\n        }\n\n        var coinName = getCoinShowName(item, coinList);\n        var showUnlockSell = false;\n\n        if (coinList[item] && coinList[item].isOvercharge && coinList[item].isOvercharge.toString() === '1') {\n          showUnlockSell = true;\n        }\n\n        var btcValuation = fixD(data[item].allBtcValuatin, btcFix);\n        list.push({\n          // id: data[item].sort,\n          id: item,\n          btcValuation: btcValuation,\n          classes: btcValuation >= 0.0001 ? '' : 'smail-account',\n          data: [coinName, fixD(data[item].total_balance, fix), showUnlockSell ? [{\n            text: fixD(data[item].normal_balance, fix),\n            subContent: {\n              text: \"\".concat(fixD(data[item].overcharge_balance || 0, fix), \" (\").concat(_this3.$t('assets.exchangeAccount.limit'), \")\"),\n              classes: 'showUnlockSell'\n            }\n          }] : fixD(data[item].normal_balance, fix), fixD(data[item].lock_balance, fix)].concat(_toConsumableArray(arr), [fixD(data[item].allBtcValuatin, btcFix), [data[item].coinName === _this3.baseData.financing_symbol ? {\n            type: data[item].coinName === _this3.baseData.financing_symbol ? 'link' : 'label',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            text: '去理财',\n            // 去理财\n            links: '/manageFinances',\n            classes: [data[item].coinName === _this3.baseData.financing_symbol ? '' : 'tableNownStyle b-2-cl']\n          } : '', {\n            type: data[item].depositOpen ? 'button' : 'label',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            text: _this3.$t('assets.exchangeAccount.Recharge'),\n            // 充值\n            links: \"recharge?symbol=\".concat(item),\n            eventType: 'recharge',\n            classes: [data[item].depositOpen ? '' : 'tableNownStyle b-2-cl']\n          }, {\n            type: data[item].withdrawOpen ? 'button' : 'label',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            text: _this3.$t('assets.exchangeAccount.withdraw'),\n            // 提现\n            links: \"withdraw?symbol=\".concat(item),\n            eventType: 'withdraw',\n            classes: [data[item].withdrawOpen ? '' : 'tableNownStyle tableTithDraw b-2-cl']\n          }, selectOption.length ? {\n            type: 'select',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            iconSvg: '<svg class=\"icon icon-16\" aria-hidden=\"true\"><use xlink:href=\"#icon-c_1\"></use></svg>',\n            selectOption: selectOption,\n            iconClass: [''],\n            eventType: 'goTrade'\n          } : {\n            type: 'icon',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            iconSvg: '<span style=\"display: inline-block; width: 16px; height: 16px\"></span>' // eventType: 'goTradeIn',\n\n          }]])\n        });\n      });\n      this.canvasPages = canvasList;\n      this.tabelLoading = false;\n      this.tabelLength = list.length;\n      this.dataList = list.sort(function (a, b) {\n        return a.id - b.id;\n      }); // this.smailData = this.dataList.filter(item => parseFloat(item.btcValuation) >= 0.0001);\n    }\n  }\n};",null]}