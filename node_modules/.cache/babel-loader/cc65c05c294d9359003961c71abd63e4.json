{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/UserManagement/UserManagement.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/UserManagement/UserManagement.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport { imgMap, colorMap } from '@/utils';\nimport countryMinix from \"../../countryList/countryList\";\nexport default {\n  name: 'userManagement',\n  mixins: [countryMinix],\n  data: function data() {\n    return {\n      id: '',\n      // uid\n      mobileNumber: '',\n      // 手机号或者邮箱显示\n      authLevel: '',\n      // 身份/实名认证状态，0、未审核，1、通过，2、未通过  3未认证\n      nickName: '',\n      // 昵称\n      userName: '',\n      email: '',\n      // 邮箱\n      dialogFlag: false,\n      dialogConfirmLoading: false,\n      dialogConfirmDisabled: false,\n      checkErrorFlag: false,\n      checkValue: '',\n      promptText: this.$t('personal.dialog.name'),\n      errorText: this.$t('personal.dialog.text'),\n      oldName: '',\n      // 用户最初昵称\n      smsCode: false,\n      // false对应0 关闭 true对应1 开启(手机短信认证)\n      googleCode: false,\n      // false对应0 关闭 true对应1 开启(google认证)\n      switchValue: false,\n      // 手续费设置\n      clickType: true,\n      // 可点击状态\n      alertFlag: false,\n      imgMap: imgMap,\n      colorMap: colorMap,\n      feeCoinOpen: '0',\n      photo: imgMap.photo1,\n      dialogType: 1,\n      inviteCodeShow: true,\n      inviteUrlShow: true,\n      // 邀请码信息\n      inviteCode: '',\n      inviteQECode: '',\n      inviteUrl: '',\n      titleText: this.$t('personal.dialog.title'),\n      kycPhoneFlag: false,\n      // kyc选择国家弹窗\n      country: '',\n      // kyc用户选择的国家\n      kycLoading: false,\n      state: 'KYC_AUTH'\n    };\n  },\n  watch: {\n    // 默认区号\n    defaultCountryCode: function defaultCountryCode(v) {\n      if (v && this.country === '') {\n        this.country = v;\n      }\n    },\n    userInfo: function userInfo(userinfo) {\n      // 监听userinfo接口\n      if (userinfo) {\n        this.getUserInfo(); // 获取用户信息\n      }\n\n      this.googleCode = !!Number(userinfo.googleStatus);\n      this.smsCode = !!Number(userinfo.isOpenMobileCheck);\n      this.id = userinfo.id;\n    },\n    modifyNickName: function modifyNickName(_modifyNickName) {\n      // 修改昵称逻辑操作\n      if (_modifyNickName !== null) {\n        if (_modifyNickName.text === 'success') {\n          // tip框提示\n          this.$bus.$emit('tip', {\n            text: _modifyNickName.msg,\n            type: 'success'\n          }); // 重新获取 userinfo\n\n          this.$store.dispatch('getUserInfo');\n          this.dialogConfirmFlag = false;\n          this.dialogFlag = false;\n          this.checkValue = this.oldName;\n          this.checkErrorFlag = false;\n          this.dialogConfirmLoading = false;\n          this.$store.dispatch('resetType');\n        } else {\n          // tip框提示错误\n          this.$bus.$emit('tip', {\n            text: _modifyNickName.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n          this.dialogConfirmLoading = false;\n        }\n      }\n    },\n    openMobileVerify: function openMobileVerify(_openMobileVerify) {\n      if (_openMobileVerify !== null) {\n        if (_openMobileVerify.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _openMobileVerify.msg,\n            type: 'success'\n          });\n          this.$store.dispatch('resetType');\n          this.$store.dispatch('getUserInfo');\n        } else {\n          this.$bus.$emit('tip', {\n            text: _openMobileVerify.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    },\n    updateFeeCoinOpen: function updateFeeCoinOpen(_updateFeeCoinOpen) {\n      if (_updateFeeCoinOpen !== null) {\n        var type = this.switchValue;\n\n        if (_updateFeeCoinOpen.text === 'success') {\n          if (type) {\n            this.$bus.$emit('tip', {\n              text: this.$t('personal.state.closeSuccess'),\n              type: 'success'\n            });\n            this.switchValue = !type;\n            this.$store.dispatch('resetType');\n          } else {\n            this.$bus.$emit('tip', {\n              text: this.$t('personal.state.openSuccess'),\n              type: 'success'\n            });\n            this.switchValue = !type;\n            this.$store.dispatch('resetType');\n          }\n        } else {\n          this.$bus.$emit('tip', {\n            text: _updateFeeCoinOpen.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    }\n  },\n  computed: {\n    interfaceSwitch: function interfaceSwitch() {\n      return this.$store.state.baseData.interfaceSwitch;\n    },\n    templateLayoutType: function templateLayoutType() {\n      return this.$store.state.baseData.templateLayoutType;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    modifyNickName: function modifyNickName() {\n      return this.$store.state.personal.modifyNickName;\n    },\n    openMobileVerify: function openMobileVerify() {\n      return this.$store.state.personal.openMobileVerify;\n    },\n    updateFeeCoinOpen: function updateFeeCoinOpen() {\n      return this.$store.state.personal.updateFeeCoinOpen;\n    },\n    headImg: function headImg() {\n      return imgMap.head;\n    },\n    publicInfo: function publicInfo() {\n      return this.$store.state.baseData.publicInfo;\n    },\n    // ”00“ face++\n    // ”01“羽山kyc\n    // “02”简版自动\n    // ”10“ 人工\n    nameVerifiedType: function nameVerifiedType() {\n      return this.$store.state.baseData.nameVerifiedType;\n    }\n  },\n  methods: {\n    init: function init() {\n      this.$store.dispatch('getUserInfo');\n    },\n    goAgent: function goAgent() {\n      this.$router.push('/agent');\n    },\n    // kyc 弹窗关闭\n    kycPhoneClose: function kycPhoneClose() {\n      // 关闭弹窗\n      this.kycPhoneFlag = false; // 初始化select内容\n\n      this.country = this.defaultCountryCodeReal ? this.defaultCountryCodeReal : this.countryMap[this.defaultCountryCode].code; // 所在地\n\n      this.countryKeyCode = this.defaultCountryCode ? this.defaultCountryCode : ''; // 所在地\n    },\n    // kyc 弹窗确认\n    kycPhoneConfirm: function kycPhoneConfirm() {\n      var _this = this;\n\n      // 中国人 - 认证face++\n      if (this.nameVerifiedType === '00' && this.country === '+156') {\n        this.axios({\n          url: '/kyc/Api/get_Valid_QRcode'\n        }).then(function (data) {\n          _this.kycLoading = false;\n\n          if (data.code.toString() === '0') {\n            var _data$data = data.data,\n                openAuto = _data$data.openAuto,\n                limitFlag = _data$data.limitFlag;\n\n            if (openAuto && openAuto.toString() === '0' || limitFlag && limitFlag.toString() === '1') {\n              // if (kycSingaporeOpen && kycSingaporeOpen !== '0') {\n              //   this.$store.dispatch('exccKycConfig', {});\n              // } else {\n              _this.$router.push('/personal/idAuth?country=156&countryKeyCode=86'); // }\n\n            } else {\n              _this.$router.push('/personal/faceAuth?country=156&countryKeyCode=86');\n            }\n          } else {\n            _this.$bus.$emit('tip', {\n              text: data.msg,\n              type: 'error'\n            });\n          }\n        }); // 外国人 - 认证\n      } else {\n        // if (kycSingaporeOpen && kycSingaporeOpen !== '0') {\n        //   this.$store.dispatch('exccKycConfig', {});\n        // } else {\n        var countryNum = this.country.split('+')[1];\n        var countryKeyCodeNum = this.countryKeyCode.split('+')[1];\n        this.$router.push(\"/personal/idAuth?country=\".concat(countryNum, \"&countryKeyCode=\").concat(countryKeyCodeNum)); // }\n\n        this.kycLoading = false;\n      }\n    },\n    copyClick: function copyClick(name) {\n      if (name === 'inviteCode') {\n        this.copy(this.inviteCode);\n      } else {\n        this.copy(this.inviteUrl);\n      }\n    },\n    copy: function copy(str) {\n      this.$bus.$emit('tip', {\n        text: this.$t('personal.prompt.copySucces'),\n        type: 'success'\n      });\n\n      function save(e) {\n        e.clipboardData.setData('text/plain', str); // 下面会说到clipboardData对象\n\n        e.preventDefault(); // 阻止默认行为\n      }\n\n      document.addEventListener('copy', save);\n      document.execCommand('copy'); // 使文档处于可编辑状态，否则无效\n\n      document.removeEventListener('copy', save);\n    },\n    handMouseenter: function handMouseenter(name) {\n      if (name === 'inviteCode') {\n        this.inviteCodeShow = false;\n      } else {\n        this.inviteUrlShow = false;\n      }\n    },\n    handMouseleave: function handMouseleave(name) {\n      if (name === 'inviteCode') {\n        this.inviteCodeShow = true;\n      } else {\n        this.inviteUrlShow = true;\n      }\n    },\n    btnLink: function btnLink(link) {\n      if (link === 'google') {\n        this.$router.push('/personal/bindGoogle');\n      } else if (link === 'phone') {\n        this.$router.push('/personal/bindPhone');\n      } else if (link === 'email') {\n        this.$router.push('/personal/bindEmail');\n      } else if (link === 'identity') {\n        this.kycPhoneFlag = true;\n      } else if (link === 'goID') {\n        this.$router.push('/personal/idAuth');\n      }\n    },\n    dialogClose: function dialogClose() {\n      // 关闭或取消时\n      this.dialogConfirmDisabled = false;\n      this.dialogConfirmFlag = false;\n      this.dialogFlag = false;\n      this.checkValue = this.oldName;\n      this.checkErrorFlag = false;\n    },\n    dialogConfirm: function dialogConfirm() {\n      // 点击确认时\n      if (this.dialogType === 2) {\n        this.dialogConfirmFlag = false;\n        this.dialogFlag = false;\n      } else {\n        var val = this.checkValue;\n\n        if (val.length === 0) {\n          // 为空提示\n          this.checkErrorFlag = true;\n          this.errorText = this.$t('personal.userManagement.nameError1');\n        } else if (val.length > 10) {\n          this.checkErrorFlag = true;\n          this.errorText = this.$t('personal.userManagement.nameError2');\n        } else {\n          // 非空提交\n          this.dialogConfirmLoading = true;\n          this.$store.dispatch('modifyNickName', {\n            nickname: val\n          });\n        }\n      }\n    },\n    inputChanges: function inputChanges(val) {\n      // 获取输入框内容\n      this.checkValue = val;\n    },\n    checkFocus: function checkFocus() {},\n    modify: function modify(num) {\n      if (num === 1) {\n        this.dialogType = 1;\n        this.titleText = this.$t('personal.dialog.title');\n      } else {\n        this.dialogType = 2;\n        this.titleText = this.$t('personal.userManagement.otherList.myInviteCod.text');\n      }\n\n      this.dialogConfirmFlag = true;\n      this.dialogFlag = true;\n    },\n    getUserInfo: function getUserInfo() {\n      if (this.userInfo !== null) {\n        // 邀请码信息\n        this.inviteCode = this.userInfo.inviteCode;\n        this.inviteQECode = this.userInfo.inviteQECode;\n        this.inviteUrl = this.userInfo.inviteUrl; // 邀请码信息\n\n        this.userName = this.userInfo.mobileNumber !== '' ? this.userInfo.mobileNumber : this.userInfo.email; // 有电话号码显示电话号码,无则显示邮箱\n\n        this.mobileNumber = this.userInfo.mobileNumber; // 电话号码\n\n        this.nickName = this.userInfo.nickName !== '' ? this.userInfo.nickName : this.$t('personal.userManagement.userName');\n        this.email = this.userInfo.email; // 邮箱\n\n        this.checkValue = this.userInfo.nickName;\n        this.oldName = this.userInfo.nickName;\n        this.authLevel = this.userInfo.authLevel; // 身份认证状态\n\n        if (Number(this.userInfo.useFeeCoinOpen) === 1) {\n          // 是否开启手续费设置 1 开启 0 关闭\n          this.switchValue = true;\n        } else {\n          this.switchValue = false;\n        }\n\n        this.feeCoinOpen = this.userInfo.fee_coin_open;\n      }\n    },\n    openMobile: function openMobile() {\n      this.$store.dispatch('openMobileVerify');\n    },\n    switchChange: function switchChange() {\n      var _this2 = this;\n\n      if (this.clickType) {\n        this.clickType = false;\n        setTimeout(function () {\n          _this2.clickType = true;\n        }, 1000);\n\n        if (this.switchValue) {\n          var info = {\n            useFeeCoinOpen: '0'\n          };\n          this.$store.dispatch('updateFeeCoinOpen', info);\n        } else {\n          var _info = {\n            useFeeCoinOpen: '1'\n          };\n          this.$store.dispatch('updateFeeCoinOpen', _info);\n        }\n      }\n    },\n    changePassword: function changePassword() {\n      if (this.smsCode === true || this.googleCode === true) {\n        this.$router.push('/personal/changePassword');\n      } else {\n        this.alertFlag = true;\n      }\n    },\n    changeEmail: function changeEmail() {\n      if (this.smsCode === true || this.googleCode === true) {\n        this.$router.push('/personal/changeEmail');\n      } else {\n        this.alertFlag = true;\n      }\n    },\n    alertClose: function alertClose() {\n      this.alertFlag = false;\n    },\n    alertGo: function alertGo() {\n      this.alertFlag = false;\n    }\n  }\n};",null]}