{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/freeStaking/myPos/myPos.js","dependencies":[{"path":"/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/freeStaking/myPos/myPos.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport { colorMap, imgMap } from '@/utils';\nexport default {\n  data: function data() {\n    return {\n      colorMap: colorMap,\n      imgMap: imgMap,\n      currentType: 0,\n      // 0 锁仓  1 持仓\n      startTime: '',\n      endTime: '',\n      posData: [],\n      paginationData: {\n        total: 100,\n        // 数据总条数\n        display: 10,\n        // 每页显示条数\n        currentPage: 1 // 当前页码\n\n      },\n      subTableData: null,\n      subTableDataId: null,\n      subPosData: [],\n      loading: false,\n      pageData: {}\n    };\n  },\n  computed: {\n    startTimeNum: function startTimeNum() {\n      return (new Date(this.startTime.replace(/-/g, '/')).getTime() / 1000).toString();\n    },\n    endTimeNum: function endTimeNum() {\n      return (new Date(this.endTime.replace(/-/g, '/')).getTime() / 1000).toString();\n    },\n    columns: function columns() {\n      var lockPosTable = [{\n        title: this.$t('freeStaking.myPos.lockPosTable[0]'),\n        width: '10%'\n      }, {\n        title: this.$t('manageFinances.startTime'),\n        width: '20%'\n      }, {\n        title: this.$t('freeStaking.myPos.lockPosTable[2]'),\n        width: '15%'\n      }, {\n        title: this.$t('freeStaking.myPos.lockPosTable[3]'),\n        width: '20%'\n      }, {\n        title: this.$t('freeStaking.myPos.lockPosTable[4]'),\n        width: '20%'\n      }, {\n        title: this.pageData.tipStatus,\n        width: '15%'\n      }];\n      var unLockPosTable = [{\n        title: this.$t('freeStaking.myPos.unLockPosTable[0]'),\n        width: '20%'\n      }, {\n        title: this.$t('freeStaking.myPos.unLockPosTable[1]'),\n        width: '20%'\n      }, {\n        title: this.$t('freeStaking.myPos.unLockPosTable[2]'),\n        width: '20%'\n      }, {\n        title: this.$t('freeStaking.myPos.unLockPosTable[3]'),\n        width: '20%'\n      }, {\n        title: this.$t('freeStaking.myPos.unLockPosTable[4]'),\n        width: '20%'\n      }];\n      return this.currentType ? unLockPosTable : lockPosTable;\n    },\n    subColumns: function subColumns() {\n      var columns = [{\n        text: this.$t('freeStaking.detail.incomeTime'),\n        class: 'table-custom-class'\n      }, {\n        text: this.$t('freeStaking.detail.incomeNum'),\n        class: 'table-custom-class'\n      }];\n      return this.currentType ? [] : columns;\n    },\n    navTabList: function navTabList() {\n      return [{\n        name: this.pageData.tipLock,\n        index: 0\n      }, {\n        name: this.pageData.tipNormal,\n        index: 1\n      }];\n    },\n    startTimeText: function startTimeText() {\n      return this.$t('broker.startTime');\n    },\n    endTimeText: function endTimeText() {\n      return this.$t('freeStaking.myPos.endTime');\n    }\n  },\n  methods: {\n    init: function init() {\n      this.startTime = this.getNowTime(this.getMonth(-3));\n      this.endTime = this.getNowTime(this.getMonth(3));\n      this.getUserPosData(this.currentType);\n    },\n    getMonth: function getMonth(n) {\n      var date = new Date();\n      return date.setMonth(date.getMonth() + n);\n    },\n    getUserPosData: function getUserPosData(currentType) {\n      var _this = this;\n\n      var _this$paginationData = this.paginationData,\n          currentPage = _this$paginationData.currentPage,\n          display = _this$paginationData.display;\n      this.loading = true;\n      this.axios({\n        url: this.$store.state.url.freeStaking.pos_history,\n        headers: {},\n        params: {\n          page: currentPage,\n          pageSize: display,\n          projectType: currentType ? 1 : 3,\n          strTime: this.startTime,\n          entTime: this.endTime\n        },\n        method: 'post'\n      }).then(function (data) {\n        if (data.code === '0' && currentType === _this.currentType) {\n          var _data$data = data.data,\n              count = _data$data.count,\n              posList = _data$data.posList;\n          _this.pageData = data.data;\n          _this.paginationData.total = count;\n          _this.posData = _this.initPosData(posList);\n          _this.loading = false;\n        }\n      });\n    },\n    reducePost: function reducePost() {\n      var _this2 = this;\n\n      if (this.timer) clearTimeout(this.timer);\n      this.timer = setTimeout(function () {\n        _this2.getUserPosData(_this2.currentType);\n      }, 500);\n    },\n    initPosData: function initPosData(data) {\n      var _this3 = this;\n\n      if (!Array.isArray(data)) return false;\n      var subPosData = [];\n      var posData = data.map(function (item, index) {\n        var lockData = [item.baseCoin, item.ltime, item.totalAmount, \"\".concat(item.gainRate, \"%\"), [{\n          text: item.totalUserGainAmount\n        }, {\n          type: 'subTable'\n        }], _this3.countStatusText(item.projectStatus)];\n        var unLockData = [item.baseCoin, item.revenueTime, item.baseAmount, item.gainRate, item.gainAmount];\n        var subPosDataItem = !_this3.currentType && Array.isArray(item.userGainList) ? item.userGainList : [];\n        var subPosDataItemAddClass = subPosDataItem.map(function (el) {\n          return [{\n            text: el.gainTime,\n            class: 'table-custom-class'\n          }, {\n            text: el.gainAmount,\n            class: 'table-custom-class'\n          }];\n        });\n        subPosData.push(subPosDataItemAddClass);\n        return {\n          id: index,\n          data: _this3.currentType ? unLockData : lockData\n        };\n      });\n      this.subPosData = subPosData;\n      return posData;\n    },\n    getNowTime: function getNowTime() {\n      var time = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var date = new Date(time);\n      var year = date.getFullYear();\n      var month = date.getMonth() + 1;\n      var day = date.getDate();\n      return \"\".concat(year, \"-\").concat(month, \"-\").concat(day);\n    },\n    selectType: function selectType(item) {\n      if (this.loading) return;\n      this.currentType = item.index;\n      this.subTableDataId = null;\n      this.getUserPosData(this.currentType);\n    },\n    setStartTime: function setStartTime(time) {\n      this.startTime = time;\n      this.reducePost();\n    },\n    setEndTime: function setEndTime(time) {\n      this.endTime = time;\n      this.reducePost();\n    },\n    countStatusText: function countStatusText(status) {\n      var statusText = {\n        0: this.$t('freeStaking.home.status[0]'),\n        1: this.$t('freeStaking.home.status[1]'),\n        2: this.$t('freeStaking.home.status[2]'),\n        3: this.$t('freeStaking.home.status[3]'),\n        4: this.$t('freeStaking.home.status[4]'),\n        5: this.$t('freeStaking.home.status[5]'),\n        6: this.$t('freeStaking.home.status[6]')\n      };\n      return statusText[status];\n    },\n    pagechange: function pagechange(e) {\n      if (this.loading) return;\n      this.paginationData.currentPage = e;\n      this.subTableDataId = null;\n      this.getUserPosData(this.currentType);\n    },\n    tableClick: function tableClick(element, data) {\n      if (!this.currentType) {\n        this.subTableData = this.subPosData[data.id];\n        this.subTableDataId = data.id;\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/freeStaking/myPos/myPos.js"],"names":["colorMap","imgMap","data","currentType","startTime","endTime","posData","paginationData","total","display","currentPage","subTableData","subTableDataId","subPosData","loading","pageData","computed","startTimeNum","Date","replace","getTime","toString","endTimeNum","columns","lockPosTable","title","$t","width","tipStatus","unLockPosTable","subColumns","text","class","navTabList","name","tipLock","index","tipNormal","startTimeText","endTimeText","methods","init","getNowTime","getMonth","getUserPosData","n","date","setMonth","axios","url","$store","state","freeStaking","pos_history","headers","params","page","pageSize","projectType","strTime","entTime","method","then","code","count","posList","initPosData","reducePost","timer","clearTimeout","setTimeout","Array","isArray","map","item","lockData","baseCoin","ltime","totalAmount","gainRate","totalUserGainAmount","type","countStatusText","projectStatus","unLockData","revenueTime","baseAmount","gainAmount","subPosDataItem","userGainList","subPosDataItemAddClass","el","gainTime","push","id","time","year","getFullYear","month","day","getDate","selectType","setStartTime","setEndTime","status","statusText","pagechange","e","tableClick","element"],"mappings":"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","sourcesContent":["import { colorMap, imgMap } from '@/utils';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      colorMap,\r\n      imgMap,\r\n      currentType: 0, // 0 锁仓  1 持仓\r\n      startTime: '',\r\n      endTime: '',\r\n      posData: [],\r\n      paginationData: {\r\n        total: 100, // 数据总条数\r\n        display: 10, // 每页显示条数\r\n        currentPage: 1, // 当前页码\r\n      },\r\n      subTableData: null,\r\n      subTableDataId: null,\r\n      subPosData: [],\r\n      loading: false,\r\n      pageData: {},\r\n    };\r\n  },\r\n  computed: {\r\n    startTimeNum() {\r\n      return (new Date(this.startTime.replace(/-/g, '/')).getTime() / 1000).toString();\r\n    },\r\n    endTimeNum() {\r\n      return (new Date(this.endTime.replace(/-/g, '/')).getTime() / 1000).toString();\r\n    },\r\n    columns() {\r\n      const lockPosTable = [\r\n        { title: this.$t('freeStaking.myPos.lockPosTable[0]'), width: '10%' },\r\n        { title: this.$t('manageFinances.startTime'), width: '20%' },\r\n        { title: this.$t('freeStaking.myPos.lockPosTable[2]'), width: '15%' },\r\n        { title: this.$t('freeStaking.myPos.lockPosTable[3]'), width: '20%' },\r\n        { title: this.$t('freeStaking.myPos.lockPosTable[4]'), width: '20%' },\r\n        { title: this.pageData.tipStatus, width: '15%' },\r\n      ];\r\n\r\n      const unLockPosTable = [\r\n        { title: this.$t('freeStaking.myPos.unLockPosTable[0]'), width: '20%' },\r\n        { title: this.$t('freeStaking.myPos.unLockPosTable[1]'), width: '20%' },\r\n        { title: this.$t('freeStaking.myPos.unLockPosTable[2]'), width: '20%' },\r\n        { title: this.$t('freeStaking.myPos.unLockPosTable[3]'), width: '20%' },\r\n        { title: this.$t('freeStaking.myPos.unLockPosTable[4]'), width: '20%' },\r\n      ];\r\n\r\n      return this.currentType ? unLockPosTable : lockPosTable;\r\n    },\r\n    subColumns() {\r\n      const columns = [\r\n        { text: this.$t('freeStaking.detail.incomeTime'), class: 'table-custom-class' },\r\n        { text: this.$t('freeStaking.detail.incomeNum'), class: 'table-custom-class' },\r\n      ];\r\n\r\n      return this.currentType ? [] : columns;\r\n    },\r\n    navTabList() {\r\n      return [{\r\n        name: this.pageData.tipLock,\r\n        index: 0,\r\n      }, {\r\n        name: this.pageData.tipNormal,\r\n        index: 1,\r\n      }];\r\n    },\r\n    startTimeText() {\r\n      return this.$t('broker.startTime');\r\n    },\r\n    endTimeText() {\r\n      return this.$t('freeStaking.myPos.endTime');\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.startTime = this.getNowTime(this.getMonth(-3));\r\n      this.endTime = this.getNowTime(this.getMonth(3));\r\n      this.getUserPosData(this.currentType);\r\n    },\r\n    getMonth(n) {\r\n      const date = new Date();\r\n      return date.setMonth(date.getMonth() + n);\r\n    },\r\n    getUserPosData(currentType) {\r\n      const { currentPage, display } = this.paginationData;\r\n      this.loading = true;\r\n\r\n      this.axios({\r\n        url: this.$store.state.url.freeStaking.pos_history,\r\n        headers: {},\r\n        params: {\r\n          page: currentPage,\r\n          pageSize: display,\r\n          projectType: currentType ? 1 : 3,\r\n          strTime: this.startTime,\r\n          entTime: this.endTime,\r\n        },\r\n        method: 'post',\r\n      }).then((data) => {\r\n        if (data.code === '0' && currentType === this.currentType) {\r\n          const { count, posList } = data.data;\r\n          this.pageData = data.data;\r\n          this.paginationData.total = count;\r\n          this.posData = this.initPosData(posList);\r\n          this.loading = false;\r\n        }\r\n      });\r\n    },\r\n    reducePost() {\r\n      if (this.timer) clearTimeout(this.timer);\r\n      this.timer = setTimeout(() => {\r\n        this.getUserPosData(this.currentType);\r\n      }, 500);\r\n    },\r\n    initPosData(data) {\r\n      if (!Array.isArray(data)) return false;\r\n      const subPosData = [];\r\n      const posData = data.map((item, index) => {\r\n        const lockData = [\r\n          item.baseCoin,\r\n          item.ltime,\r\n          item.totalAmount,\r\n          `${item.gainRate}%`,\r\n          [\r\n            {\r\n              text: item.totalUserGainAmount,\r\n            },\r\n            {\r\n              type: 'subTable',\r\n            },\r\n          ],\r\n          this.countStatusText(item.projectStatus),\r\n        ];\r\n        const unLockData = [\r\n          item.baseCoin,\r\n          item.revenueTime,\r\n          item.baseAmount,\r\n          item.gainRate,\r\n          item.gainAmount,\r\n        ];\r\n\r\n        const subPosDataItem = !this.currentType && Array.isArray(item.userGainList)\r\n          ? item.userGainList : [];\r\n\r\n        const subPosDataItemAddClass = subPosDataItem.map((el) => [{\r\n          text: el.gainTime,\r\n          class: 'table-custom-class',\r\n        }, {\r\n          text: el.gainAmount,\r\n          class: 'table-custom-class',\r\n        }]);\r\n\r\n        subPosData.push(\r\n          subPosDataItemAddClass,\r\n        );\r\n\r\n        return {\r\n          id: index,\r\n          data: this.currentType ? unLockData : lockData,\r\n        };\r\n      });\r\n\r\n      this.subPosData = subPosData;\r\n\r\n      return posData;\r\n    },\r\n    getNowTime(time = '') {\r\n      const date = new Date(time);\r\n      const year = date.getFullYear();\r\n      const month = date.getMonth() + 1;\r\n      const day = date.getDate();\r\n\r\n      return `${year}-${month}-${day}`;\r\n    },\r\n    selectType(item) {\r\n      if (this.loading) return;\r\n\r\n      this.currentType = item.index;\r\n      this.subTableDataId = null;\r\n      this.getUserPosData(this.currentType);\r\n    },\r\n    setStartTime(time) {\r\n      this.startTime = time;\r\n      this.reducePost();\r\n    },\r\n    setEndTime(time) {\r\n      this.endTime = time;\r\n      this.reducePost();\r\n    },\r\n    countStatusText(status) {\r\n      const statusText = {\r\n        0: this.$t('freeStaking.home.status[0]'),\r\n        1: this.$t('freeStaking.home.status[1]'),\r\n        2: this.$t('freeStaking.home.status[2]'),\r\n        3: this.$t('freeStaking.home.status[3]'),\r\n        4: this.$t('freeStaking.home.status[4]'),\r\n        5: this.$t('freeStaking.home.status[5]'),\r\n        6: this.$t('freeStaking.home.status[6]'),\r\n      };\r\n      return statusText[status];\r\n    },\r\n    pagechange(e) {\r\n      if (this.loading) return;\r\n      this.paginationData.currentPage = e;\r\n      this.subTableDataId = null;\r\n      this.getUserPosData(this.currentType);\r\n    },\r\n    tableClick(element, data) {\r\n      if (!this.currentType) {\r\n        this.subTableData = this.subPosData[data.id];\r\n        this.subTableDataId = data.id;\r\n      }\r\n    },\r\n  },\r\n};\r\n"]}]}