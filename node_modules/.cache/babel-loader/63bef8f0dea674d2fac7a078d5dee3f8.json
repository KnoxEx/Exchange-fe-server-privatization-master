{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/trade/tradingView/tradingView.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/trade/tradingView/tradingView.js","mtime":1642344823221},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.reflect.construct\";\nimport _classCallCheck from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _inherits from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _slicedToArray from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { myStorage, getCookie, colorMap, getHex, imgMap, getCoinShowName, logImg } from '@/utils';\nexport default {\n  name: 'tradingView',\n  data: function data() {\n    return {\n      TvBoxHeight: '455px',\n      // 颜色主题\n      theme: 'theme_default',\n      // 图标类型 TV：1 Echart: 2\n      chartType: 1,\n      symbolCurrent: myStorage.get('sSymbolName'),\n      MywebSocket: null,\n      lastTimeS: myStorage.get('lastTimeS'),\n      language: getCookie('lan') ? getCookie('lan').split('_')[0] : '',\n      lTime: null,\n      fTime: 0,\n      isCreateWidget: false,\n      isshowLoading: true,\n      chartTypeHove: null,\n      isfullTv: false,\n      isfullTvsd: null,\n      // 市场横向滚动参数\n      slidePosition: 0,\n      maxPosition: 0,\n      lanArry: ['ar', 'zh_TW', 'zh', 'cs', 'da_DK', 'nl_NL', 'en', 'et_EE', 'fr', 'de', 'el', 'he_IL', 'hu_HU', 'id_ID', 'it', 'ja', 'ko', 'ms_MY', 'no', 'fa', 'pl', 'pt', 'ro', 'ru', 'sk_SK', 'es', 'sv', 'th', 'tr', 'vi'],\n      // 合约全部币对\n      coSymbolAll: null\n    };\n  },\n  props: {\n    moduleType: {\n      type: String,\n      default: 'ex'\n    }\n  },\n  computed: {\n    publicInfo: function publicInfo() {\n      return this.$store.state.baseData.publicInfo || {};\n    },\n    klineLogo: function klineLogo() {\n      return imgMap.tradingViewLogo || '';\n    },\n    templateLayoutType: function templateLayoutType() {\n      return this.$store.state.baseData.templateLayoutType;\n    },\n    baseTimeArry: function baseTimeArry() {\n      try {\n        return this.$store.state.baseData.market.klineScale;\n      } catch (w) {\n        return ['1min', '5min', '15min', '30min', '60min', '4h', '1day', '1week', '1month'];\n      }\n    },\n    // 当前货币对名称数据\n    symbolName: function symbolName() {\n      if (this.symbolCurrent) {\n        if (this.moduleType === 'co') {\n          var _symbolArr = this.symbolCurrent.toLowerCase().split('/');\n\n          return {\n            base: this.symbolCurrent.split('/')[0],\n            count: this.symbolCurrent.split('/')[1],\n            name: this.symbolCurrent,\n            symbol: _symbolArr[1] ? _symbolArr[0] + _symbolArr[1] : _symbolArr[0]\n          };\n        }\n\n        var symbolArr = this.symbolCurrent.toLowerCase().split('/');\n        var showSymbol = getCoinShowName(this.symbolCurrent, this.symbolAll);\n        var showSymbolArr = showSymbol.toLowerCase().split('/');\n        return {\n          base: this.symbolCurrent.split('/')[0],\n          count: this.symbolCurrent.split('/')[1],\n          name: this.symbolCurrent,\n          symbol: symbolArr[0] + symbolArr[1],\n          showSymbol: showSymbolArr[0] + showSymbolArr[1]\n        };\n      }\n\n      return {\n        base: null,\n        // 基础货币\n        count: null,\n        // 计价货币\n        name: null,\n        // 大写 带/\n        symbol: null // 小写\n\n      };\n    },\n    timeArry: function timeArry() {\n      var a = [];\n\n      if (this.baseTimeArry.length) {\n        this.baseTimeArry.forEach(function (it) {\n          var t = [];\n\n          if (it.indexOf('min') > -1) {\n            t.push(it, parseFloat(it));\n          } else if (it.toLowerCase().indexOf('h') > -1 && it.indexOf('month') < 0) {\n            t.push(it, parseFloat(it) * 60);\n          } else if (it.indexOf('day') > -1) {\n            t.push(it, parseFloat(it) * 24 * 60);\n          } else if (it.indexOf('week') > -1) {\n            t.push(it, parseFloat(it) * 7 * 24 * 60);\n          } else if (it.indexOf('month') > -1) {\n            t.push(it, parseFloat(it) * 30 * 24 * 60);\n          }\n\n          a.push(t);\n        });\n      }\n\n      return a;\n    },\n    // 币币and杠杆 全部货币对\n    symbolAll: function symbolAll() {\n      return this.$store.state.baseData.symbolAll;\n    },\n    themeTV: function themeTV() {\n      var theme = getCookie('cusSkin') || getCookie('defSkin') || '1';\n      var stheme = theme.toString() === '1' ? 'Dark' : 'Light';\n      return stheme;\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      // 杠杆当前选中的币对\n      if (this.moduleType === 'lever') {\n        this.symbolCurrent = myStorage.get('leverSymbolName');\n      } // 合约当前选中的币对\n\n\n      if (this.moduleType === 'co') {\n        this.TvBoxHeight = '710px';\n        this.symbolCurrent = myStorage.get('coNowSymbol');\n      } // 监听TV 是否是全屏状态\n\n\n      document.removeEventListener('fullscreenchange', this.quitfullTv);\n      document.addEventListener('fullscreenchange', this.quitfullTv);\n      this.$bus.$on('SYMBOL_LIST_ALL', function (data) {\n        _this.coSymbolAll = data;\n      }); // 设置国际版TV的高度\n\n      this.setTvBoxHeight();\n      this.$bus.$on('WINFOW_ON_RESIIZE', function () {\n        var _this$$refs = _this.$refs,\n            _this$$refs$topMenuBo = _this$$refs.topMenuBox,\n            topMenuBox = _this$$refs$topMenuBo === void 0 ? null : _this$$refs$topMenuBo,\n            _this$$refs$topMenuBa = _this$$refs.topMenuBar,\n            topMenuBar = _this$$refs$topMenuBa === void 0 ? null : _this$$refs$topMenuBa; // 监听TV 是否是全屏状态\n\n        _this.quitfullTv(); // 设置国际版TV的高度\n\n\n        _this.setTvBoxHeight(); // 市场 个数的超出宽度\n\n\n        if (topMenuBox && topMenuBar) {\n          _this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n        }\n\n        _this.slideMarket('left');\n      });\n\n      if (this.lanArry.indexOf(this.language) <= -1) {\n        this.language = 'en';\n      }\n\n      if (getCookie('lan') === 'el_GR') {\n        this.language = 'zh_TW';\n      }\n\n      if (!myStorage.get('lastTimeS')) {\n        myStorage.set('lastTimeS', '30min');\n        this.lastTimeS = '30min';\n      } // 监听 WebSocket 链接成功\n\n\n      this.$bus.$on('WEBSOCKET_ON_OPEN', function (val) {\n        _this.MywebSocket = val;\n\n        if (_this.MywebSocket) {\n          _this.isCreateWidget = false;\n\n          _this.initTradingView();\n        }\n      }); // 获取 当前选中的货币对\n\n      this.$bus.$on('SYMBOL_CURRENT', function (val) {\n        if (_this.symbolCurrent !== val) {\n          if (_this.chartType === 1) {\n            _this.isshowLoading = true;\n          }\n\n          _this.symbolCurrent = val;\n\n          if (window.tvWidget) {\n            var showSymbol = _this.symbolName.showSymbol;\n\n            if (_this.moduleType === 'co') {\n              showSymbol = _this.symbolName.symbol;\n            }\n\n            window.tvWidget.setSymbol(showSymbol, _this.getTimeMin(true, _this.lastTimeS), function () {\n              _this.widget.chart().executeActionById('chartReset');\n            });\n          }\n        }\n      });\n      this.$bus.$on('HIDE_LOADING', function () {\n        _this.isshowLoading = false;\n      }); // 市场 个数的超出宽度\n\n      this.maxPosition = this.$refs.topMenuBox.offsetWidth - this.$refs.topMenuBar.offsetWidth;\n    },\n    setTvBoxHeight: function setTvBoxHeight() {\n      if (this.templateLayoutType === '2') {\n        var bodyH = document.body.clientHeight;\n\n        if (bodyH < 800) {\n          bodyH = 800;\n        }\n\n        if (this.moduleType === 'co') {\n          this.TvBoxHeight = '100%';\n        } else {\n          this.TvBoxHeight = \"\".concat(bodyH - 475, \"px\");\n        }\n      }\n    },\n    enter: function enter(index) {\n      this.chartTypeHove = index;\n    },\n    leave: function leave() {\n      this.chartTypeHove = null;\n    },\n    chartTypeShow: function chartTypeShow(num) {\n      if (this.chartType === num || this.chartTypeHove === num) {\n        return true;\n      }\n\n      return false;\n    },\n    initTradingView: function initTradingView() {\n      this.createWidget();\n    },\n    // tadingView 生命周期函数\n    udf_datafeed: function udf_datafeed() {\n      var self = this;\n      return {\n        onReady: function onReady(callback) {\n          var cnf = {\n            supported_resolutions: self.getTimeMin(false, 1),\n            // 数组\n            supports_group_request: false,\n            supports_marks: true,\n            supports_search: false,\n            supports_timescale_marks: false\n          };\n          setTimeout(function () {\n            callback(cnf);\n          }, 0);\n        },\n        // 切换币对后\n        resolveSymbol: function resolveSymbol(symbolName, onSymbolResolvedCallback) {\n          setTimeout(function () {\n            onSymbolResolvedCallback({\n              name: symbolName,\n              'exchange-traded': '',\n              'exchange-listed': '',\n              minmov: 1,\n              minmov2: 0,\n              pointvalue: 1,\n              session: '0000-2400:1234567',\n              has_intraday: true,\n              has_no_volume: false,\n              volume_precision: 1,\n              description: symbolName.toUpperCase(),\n              type: 'bitcoin',\n              supported_resolutions: self.getTimeMin(false, 1),\n              pricescale: self.fixDepthNumber(self.symbolName.name),\n              ticker: symbolName.toUpperCase(),\n              timezone: window.jstz.determine().name()\n            });\n          }, 0);\n        },\n        // 获取深度数据（k线无需请求深度）\n        calculateHistoryDepth: function calculateHistoryDepth() {\n          return undefined;\n        },\n        // tradingview 获取历史数据\n        getBars: function getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest) {\n          if (firstDataRequest) {\n            self.lTime = false;\n          }\n\n          var lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'req',\n              symbol: self.symbolName.symbol,\n              lastTimeS: lastTimeS,\n              lTime: self.lTime,\n              number: 50\n            });\n          }\n\n          self.$bus.$off('KLINE_DATA_REQ');\n          self.$bus.$on('KLINE_DATA_REQ', function (data) {\n            var channelArr = data.channel.split('_');\n            var Ntime = channelArr[channelArr.length - 1];\n\n            var _data$channel$split = data.channel.split('_'),\n                _data$channel$split2 = _slicedToArray(_data$channel$split, 2),\n                symbolType = _data$channel$split2[1];\n\n            if (self.moduleType === 'co') {\n              var _data$channel$split3 = data.channel.split('_'),\n                  _data$channel$split4 = _slicedToArray(_data$channel$split3, 3),\n                  symbol = _data$channel$split4[1],\n                  type = _data$channel$split4[2];\n\n              symbolType = \"\".concat(symbol, \"_\").concat(type);\n            }\n\n            if (data.event_rep === 'rep' && symbolType === self.symbolName.symbol && lastTimeS === Ntime) {\n              self.fTime = 0;\n              var klData = data.data;\n              var arrData = [];\n\n              if (data.data && data.data.length) {\n                klData.forEach(function (item) {\n                  arrData.push(self.setData(item));\n                });\n                self.fTime = arrData[arrData.length - 1].time;\n\n                if (self.lTime === klData[0].id) {\n                  onHistoryCallback([], {\n                    noData: true\n                  });\n                  logImg({\n                    host: window.location.host,\n                    type: 'onHistoryCallback',\n                    path: window.location.href,\n                    ds: 'onHistoryCallback noDate',\n                    data: {\n                      symbol: self.symbolCurrent\n                    },\n                    t: new Date().getTime()\n                  });\n                } else {\n                  self.lTime = klData[0].id;\n                  onHistoryCallback(arrData);\n                }\n              } else {\n                if (self.secend < 3) {\n                  self.udf_datafeed().getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest);\n                  self.secend += 1;\n                  return;\n                }\n\n                if (!self.lTime) {\n                  logImg({\n                    host: window.location.host,\n                    type: 'tradingView',\n                    path: window.location.href,\n                    ds: 'first onHistoryCallback noData',\n                    data: data,\n                    t: new Date().getTime()\n                  });\n                }\n\n                onHistoryCallback([], {\n                  noData: true\n                });\n              }\n            }\n          });\n\n          if (!self.isCreateWidget) {\n            self.widget_onChartReady();\n            self.widget.chart().setChartType(1);\n          }\n        },\n        // tradingview 获取实时数据\n        subscribeBars: function subscribeBars(symbolInfo, resolution, onRealtimeCallback) {\n          self.isshowLoading = false;\n          var lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'sub',\n              symbol: self.symbolName.symbol,\n              lastTimeS: lastTimeS\n            });\n          }\n\n          self.$bus.$off('KLINE_DATA_SUB');\n          self.$bus.$on('KLINE_DATA_SUB', function (data) {\n            var channelArr = data.channel.split('_');\n            var Ntime = channelArr[channelArr.length - 1];\n            var symbolType;\n\n            if (self.moduleType === 'co') {\n              var _data$channel$split5 = data.channel.split('_'),\n                  _data$channel$split6 = _slicedToArray(_data$channel$split5, 3),\n                  symbol = _data$channel$split6[1],\n                  type = _data$channel$split6[2];\n\n              symbolType = \"\".concat(symbol, \"_\").concat(type);\n            } else {\n              var _data$channel$split7 = data.channel.split('_');\n\n              var _data$channel$split8 = _slicedToArray(_data$channel$split7, 2);\n\n              symbolType = _data$channel$split8[1];\n            }\n\n            if (data.tick && symbolType === self.symbolName.symbol && Ntime === lastTimeS) {\n              var tickData = self.setData(data.tick);\n\n              if (self.fTime < tickData.time) {\n                onRealtimeCallback(tickData);\n              }\n            }\n          });\n        },\n        // tradingview 取消订阅上一 币对 / 刻度\n        unsubscribeBars: function unsubscribeBars(subscriberUID) {\n          var arr = subscriberUID.split('_');\n          var symbol = arr[0].toLowerCase();\n          var lastTimeS = self.getTimeMin(true, parseFloat(arr[1]));\n\n          if (self.moduleType === 'co') {\n            symbol = arr[0].toLowerCase() + arr[1].toLowerCase();\n            lastTimeS = self.getTimeMin(true, parseFloat(arr[2]));\n          }\n\n          self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n            type: 'unsub',\n            symbol: symbol,\n            lastTimeS: lastTimeS\n          });\n        }\n      };\n    },\n    // 创建 TradingView\n    createWidget: function createWidget() {\n      var F = /*#__PURE__*/function (_window$TradingView$w) {\n        _inherits(F, _window$TradingView$w);\n\n        var _super = _createSuper(F);\n\n        function F() {\n          _classCallCheck(this, F);\n\n          return _super.apply(this, arguments);\n        }\n\n        return F;\n      }(window.TradingView.widget);\n\n      window.tvWidget = new F({\n        debug: false,\n        autosize: true,\n        timezone: window.jstz.determine().name(),\n        symbol: this.symbolName.showSymbol,\n        interval: this.getTimeMin(true, this.lastTimeS),\n        container_id: 'tv_chart_container',\n        // DOM id\n        datafeed: this.udf_datafeed(),\n        // 配置 生命周期\n        library_path: '/static/charting_library/',\n        // 静态文件路径\n        locale: this.language,\n        // 语言\n        disabled_features: ['header_symbol_search', 'timeframes_toolbar', 'volume_force_overlay', 'header_saveload', 'header_resolutions', 'header_compare', 'header_screenshot', 'header_undo_redo', 'adaptive_logo', 'header_fullscreen_button', 'timezone_menu', 'scales_context_menu', 'legend_context_menu', 'symbol_search_hot_key' // 'use_localstorage_for_settings',\n        // 'show_chart_property_page',\n        // 'timeframes_toolbar',\n        // 'symbol_info',\n        // 'header_widget_dom_node',\n        // 'header_indicators',\n        // 'header_widget',\n        // 'pane_context_menu',\n        // 'header_fullscreen_button',\n        // 'display_market_status',\n        // 'header_chart_type',\n        ],\n        enabled_features: [// 'study_templates',\n        'hide_left_toolbar_by_default'],\n        charts_storage_url: \"\".concat(window.location.protocol, \"//saveload.tradingview.com\"),\n        charts_storage_api_version: '1.1',\n        client_id: 'tradingview.com',\n        user_id: 'public_user',\n        toolbar_bg: getHex(colorMap['a-6-bg']),\n        // 工具栏底色\n        theme: this.themeTV,\n        studies_overrides: {\n          'volume.volume.color.0': getHex(colorMap['u-4-bg']),\n          'volume.volume.color.1': getHex(colorMap['u-1-bg']),\n          'volume.volume.transparency': 50\n        },\n        overrides: {\n          // k线的颜色\n          volumePaneSize: 'small',\n          // 成交量大小\n          'scalesProperties.fontSize': 12,\n          // 图标区域xy轴 字体大小\n          'scalesProperties.textColor': getHex(colorMap['b-3-cl']),\n          // 图标区域xy轴 文字颜色\n          'scalesProperties.lineColor': getHex(colorMap['a-3-bd']),\n          // 图标区域xy轴颜色\n          'paneProperties.background': getHex(colorMap['a-6-bg']),\n          // 图标区域 背景色\n          'paneProperties.vertGridProperties.color': getHex(colorMap['a-7-bg']),\n          // 图标区域 表格纵轴颜色\n          'paneProperties.horzGridProperties.color': getHex(colorMap['a-7-bg']),\n          // 图标区域 表格橫轴颜色\n          'paneProperties.crossHairProperties.color': getHex(colorMap['b-2-bg']),\n          // 图标区域 鼠标十字线颜色\n          'paneProperties.legendProperties.showLegend': true,\n          // 折叠信息\n          // 柱状图颜色设置\n          'mainSeriesProperties.candleStyle.upColor': getHex(colorMap['u-1-cl']),\n          'mainSeriesProperties.candleStyle.downColor': getHex(colorMap['u-4-cl']),\n          'mainSeriesProperties.candleStyle.drawWick': true,\n          'mainSeriesProperties.candleStyle.drawBorder': true,\n          'mainSeriesProperties.candleStyle.borderColor': '',\n          'mainSeriesProperties.candleStyle.borderUpColor': getHex(colorMap['u-1-cl']),\n          'mainSeriesProperties.candleStyle.borderDownColor': getHex(colorMap['u-4-cl']),\n          'mainSeriesProperties.candleStyle.wickUpColor': getHex(colorMap['u-1-cl']),\n          'mainSeriesProperties.candleStyle.wickDownColor': getHex(colorMap['u-4-cl']),\n          'mainSeriesProperties.candleStyle.barColorsOnPrevClose': !1,\n          // 分时图颜色设置\n          // 分时背景色渐变 上半部分\n          'mainSeriesProperties.areaStyle.color1': colorMap['a-15-bg'],\n          // 分时背景色渐变 下半部分\n          'mainSeriesProperties.areaStyle.color2': colorMap['a-17-bg'],\n          'mainSeriesProperties.areaStyle.linecolor': getHex(colorMap['a-12-bd']),\n          'mainSeriesProperties.areaStyle.linestyle': 0,\n          'mainSeriesProperties.areaStyle.linewidth': 2,\n          'mainSeriesProperties.areaStyle.priceSource': 'close'\n        }\n      });\n      this.widget = window.tvWidget;\n    },\n    // 格式化时间刻度\n    getTimeMin: function getTimeMin(only, type) {\n      if (only) {\n        var _t = null;\n\n        if (this.timeArry.length) {\n          this.timeArry.forEach(function (item) {\n            var s = item.indexOf(type);\n\n            if (s > -1) {\n              _t = s === 0 ? item[1] : item[0];\n            }\n          });\n        }\n\n        return _t;\n      }\n\n      var t = [];\n      this.timeArry.forEach(function (item) {\n        t.push(item[type]);\n      });\n      return t;\n    },\n    // 精度计算\n    fixDepthNumber: function fixDepthNumber(symbolName) {\n      var n;\n\n      if (this.moduleType === 'co') {\n        n = this.coSymbolAll[symbolName].pricePrecision;\n      } else {\n        n = this.symbolAll[symbolName].price;\n      }\n\n      var b = Math.pow(10, n);\n      return parseFloat(b.toString());\n    },\n    widget_onChartReady: function widget_onChartReady() {\n      var _this2 = this;\n\n      this.isCreateWidget = true;\n      this.creatMA(); // ===== 默认样式皮肤修改 =====\n\n      var style = document.createElement('style');\n      /* eslint-disable */\n\n      var clas = document.createTextNode(\".apply-common-tooltip,.wrap-1GG7GnNO- svg{fill:\" + colorMap[\"b-3-cl\"] + \"!important;color:\" + colorMap[\"b-3-cl\"] + \"!important;cursor: pointer;}.textColor .wrap-18oKCBRc- div,.wrap-18oKCBRc- .apply-common-tooltip:hover,.wrap-1GG7GnNO- svg:hover,.button-263WXsg--.isActive-2mI1-NUL- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-:hover{fill:\" + colorMap[\"a-1-cl\"] + \"!important;color:\" + colorMap[\"a-1-cl\"] + \"!important;}.container-3_8ayT2Q- .background-Q1Fcmxly-{fill: \" + colorMap[\"b-2-cl\"] + \"; stroke: \" + colorMap[\"b-2-cl\"] + \";}.container-3_8ayT2Q- .arrow-WcYWFXUn-, html.theme-dark .container-3_8ayT2Q- .arrow-WcYWFXUn-{stroke: \" + colorMap[\"b-1-cl\"] + \";}.feature-no-touch .container-3_8ayT2Q-:hover .background-Q1Fcmxly-{fill: \" + colorMap[\"a-1-cl\"] + \";stroke: \" + colorMap[\"a-1-cl\"] + \";}\");\n      /* eslint-enable */\n\n      style.append(clas);\n      this.widget.headerReady().then(function () {\n        _this2.widget.createButton().append(style);\n      });\n    },\n    creatMA: function creatMA() {\n      // ===== 创建移动均线 =====\n      this.widget.chart().createStudy('Moving Average', false, false, [5], null, {\n        'plot.color': '#F5CB89'\n      });\n      this.widget.chart().createStudy('Moving Average', false, false, [10], null, {\n        'plot.color': '#5FCFBF'\n      });\n      this.widget.chart().createStudy('Moving Average', false, false, [30], null, {\n        'plot.color': '#DD89F5'\n      });\n    },\n    setMAShow: function setMAShow() {\n      // ===== 显示移动均线 =====\n      var c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, true);\n      this.widget.chart().setEntityVisibility(c[1].id, true);\n      this.widget.chart().setEntityVisibility(c[2].id, true);\n    },\n    setMAHide: function setMAHide() {\n      // ===== 隐藏移动均线 =====\n      var c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, false);\n      this.widget.chart().setEntityVisibility(c[1].id, false);\n      this.widget.chart().setEntityVisibility(c[2].id, false);\n    },\n    timeClike: function timeClike(v) {\n      var _this3 = this;\n\n      if (v !== 'Line' && v !== '1min' && v !== this.lastTimeS) {\n        this.isshowLoading = true;\n      }\n\n      if (v !== this.lastTimeS) {\n        this.lastTimeS = v;\n\n        if (v === 'Line') {\n          myStorage.set('lastTimeS', '1min');\n        } else {\n          myStorage.set('lastTimeS', v);\n        }\n\n        this.$bus.$emit('LAST-TIMES', v);\n\n        if (this.isCreateWidget) {\n          var resolution = this.widget.chart().resolution();\n\n          if (v === 'Line') {\n            if (resolution !== '1') {\n              this.widget.chart().setResolution('1', function () {\n                _this3.widget.chart().setChartType(3); // 折线图\n\n              });\n            } else if (resolution === '1') {\n              this.widget.chart().setChartType(3);\n            }\n\n            this.setMAHide();\n          } else {\n            if (resolution === '1' && v === '1min') {\n              this.widget.chart().setChartType(1); // 蜡烛图\n            } else {\n              var timeS = this.getTimeMin(true, v);\n              this.widget.chart().setResolution(timeS.toString(), function () {\n                _this3.widget.chart().setChartType(1);\n\n                _this3.widget.chart().executeActionById('chartReset');\n              });\n            }\n\n            this.setMAShow();\n          }\n        }\n      }\n    },\n    // 格式化数据\n    setData: function setData(obj) {\n      return {\n        time: obj.id * 1000,\n        close: obj.close,\n        open: obj.open,\n        high: obj.high,\n        low: obj.low,\n        volume: obj.vol\n      };\n    },\n    switchChartType: function switchChartType(type) {\n      var _this4 = this;\n\n      if (type === 2) {\n        this.isshowLoading = false;\n      }\n\n      this.chartType = type;\n      setTimeout(function () {\n        var _this4$$refs = _this4.$refs,\n            _this4$$refs$topMenuB = _this4$$refs.topMenuBox,\n            topMenuBox = _this4$$refs$topMenuB === void 0 ? null : _this4$$refs$topMenuB,\n            _this4$$refs$topMenuB2 = _this4$$refs.topMenuBar,\n            topMenuBar = _this4$$refs$topMenuB2 === void 0 ? null : _this4$$refs$topMenuB2;\n        _this4.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n      }, 500);\n    },\n    quit: function quit(e) {\n      this.isfullTv = false;\n\n      if (this.isfullTv) {\n        var key = e.keyCode;\n\n        if (key === 27) {\n          this.isfullTv = false;\n        }\n      }\n    },\n    fullTv: function fullTv() {\n      if (!this.isfullTv) {\n        this.isfullTv = true;\n        var element = this.$refs.tv_chart_container;\n\n        if (element.requestFullscreen) {\n          element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n          element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n          element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n          element.msRequestFullscreen();\n        }\n      } else {\n        this.isfullTv = false;\n\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    },\n    quitfullTv: function quitfullTv() {\n      // 监听TV 是否是全屏状态\n      if (this.isfullTv) {\n        this.isfullTv = window.fullScreen || document.webkitIsFullScreen || document.msFullscreenElement;\n      }\n    },\n    // 设置时间刻度的滚动\n    slideMarket: function slideMarket(type) {\n      var position = parseFloat(this.slidePosition);\n\n      if (this.$refs.topMenuBar) {\n        if (type === 'left') {\n          position += this.$refs.topMenuBar.offsetWidth / 2;\n\n          if (position > 0) {\n            position = 0;\n          }\n        } else {\n          position -= this.$refs.topMenuBar.offsetWidth / 2;\n\n          if (position < -this.maxPosition) {\n            position = -this.maxPosition;\n          }\n        }\n\n        this.slidePosition = \"\".concat(position, \"px\");\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/trade/tradingView/tradingView.js"],"names":["myStorage","getCookie","colorMap","getHex","imgMap","getCoinShowName","logImg","name","data","TvBoxHeight","theme","chartType","symbolCurrent","get","MywebSocket","lastTimeS","language","split","lTime","fTime","isCreateWidget","isshowLoading","chartTypeHove","isfullTv","isfullTvsd","slidePosition","maxPosition","lanArry","coSymbolAll","props","moduleType","type","String","default","computed","publicInfo","$store","state","baseData","klineLogo","tradingViewLogo","templateLayoutType","baseTimeArry","market","klineScale","w","symbolName","symbolArr","toLowerCase","base","count","symbol","showSymbol","symbolAll","showSymbolArr","timeArry","a","length","forEach","it","t","indexOf","push","parseFloat","themeTV","stheme","toString","methods","init","document","removeEventListener","quitfullTv","addEventListener","$bus","$on","setTvBoxHeight","$refs","topMenuBox","topMenuBar","offsetWidth","slideMarket","set","val","initTradingView","window","tvWidget","setSymbol","getTimeMin","widget","chart","executeActionById","bodyH","body","clientHeight","enter","index","leave","chartTypeShow","num","createWidget","udf_datafeed","self","onReady","callback","cnf","supported_resolutions","supports_group_request","supports_marks","supports_search","supports_timescale_marks","setTimeout","resolveSymbol","onSymbolResolvedCallback","minmov","minmov2","pointvalue","session","has_intraday","has_no_volume","volume_precision","description","toUpperCase","pricescale","fixDepthNumber","ticker","timezone","jstz","determine","calculateHistoryDepth","undefined","getBars","symbolInfo","resolution","from","to","onHistoryCallback","onErrorCallback","firstDataRequest","$emit","number","$off","channelArr","channel","Ntime","symbolType","event_rep","klData","arrData","item","setData","time","id","noData","host","location","path","href","ds","Date","getTime","secend","widget_onChartReady","setChartType","subscribeBars","onRealtimeCallback","tick","tickData","unsubscribeBars","subscriberUID","arr","F","TradingView","debug","autosize","interval","container_id","datafeed","library_path","locale","disabled_features","enabled_features","charts_storage_url","protocol","charts_storage_api_version","client_id","user_id","toolbar_bg","studies_overrides","overrides","volumePaneSize","only","s","n","pricePrecision","price","b","creatMA","style","createElement","clas","createTextNode","append","headerReady","then","createButton","createStudy","setMAShow","c","getAllStudies","setEntityVisibility","setMAHide","timeClike","v","setResolution","timeS","obj","close","open","high","low","volume","vol","switchChartType","quit","e","key","keyCode","fullTv","element","tv_chart_container","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","fullScreen","webkitIsFullScreen","msFullscreenElement","position"],"mappings":"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","sourcesContent":["import {\r\n  myStorage, getCookie, colorMap, getHex, imgMap, getCoinShowName, logImg,\r\n} from '@/utils';\r\n\r\nexport default {\r\n  name: 'tradingView',\r\n  data() {\r\n    return {\r\n      TvBoxHeight: '455px',\r\n      // 颜色主题\r\n      theme: 'theme_default',\r\n      // 图标类型 TV：1 Echart: 2\r\n      chartType: 1,\r\n      symbolCurrent: myStorage.get('sSymbolName'),\r\n      MywebSocket: null,\r\n      lastTimeS: myStorage.get('lastTimeS'),\r\n      language: getCookie('lan') ? getCookie('lan').split('_')[0] : '',\r\n      lTime: null,\r\n      fTime: 0,\r\n      isCreateWidget: false,\r\n      isshowLoading: true,\r\n      chartTypeHove: null,\r\n      isfullTv: false,\r\n      isfullTvsd: null,\r\n      // 市场横向滚动参数\r\n      slidePosition: 0,\r\n      maxPosition: 0,\r\n      lanArry: [\r\n        'ar',\r\n        'zh_TW',\r\n        'zh',\r\n        'cs',\r\n        'da_DK',\r\n        'nl_NL',\r\n        'en',\r\n        'et_EE',\r\n        'fr',\r\n        'de',\r\n        'el',\r\n        'he_IL',\r\n        'hu_HU',\r\n        'id_ID',\r\n        'it',\r\n        'ja',\r\n        'ko',\r\n        'ms_MY',\r\n        'no',\r\n        'fa',\r\n        'pl',\r\n        'pt',\r\n        'ro',\r\n        'ru',\r\n        'sk_SK',\r\n        'es',\r\n        'sv',\r\n        'th',\r\n        'tr',\r\n        'vi',\r\n      ],\r\n      // 合约全部币对\r\n      coSymbolAll: null,\r\n    };\r\n  },\r\n  props: {\r\n    moduleType: {\r\n      type: String,\r\n      default: 'ex',\r\n    },\r\n  },\r\n  computed: {\r\n    publicInfo() {\r\n      return this.$store.state.baseData.publicInfo || {};\r\n    },\r\n    klineLogo() {\r\n      return imgMap.tradingViewLogo || '';\r\n    },\r\n    templateLayoutType() {\r\n      return this.$store.state.baseData.templateLayoutType;\r\n    },\r\n    baseTimeArry() {\r\n      try {\r\n        return this.$store.state.baseData.market.klineScale;\r\n      } catch (w) {\r\n        return [\r\n          '1min',\r\n          '5min',\r\n          '15min',\r\n          '30min',\r\n          '60min',\r\n          '4h',\r\n          '1day',\r\n          '1week',\r\n          '1month',\r\n        ];\r\n      }\r\n    },\r\n    // 当前货币对名称数据\r\n    symbolName() {\r\n      if (this.symbolCurrent) {\r\n        if (this.moduleType === 'co') {\r\n          const symbolArr = this.symbolCurrent.toLowerCase().split('/');\r\n          return {\r\n            base: this.symbolCurrent.split('/')[0],\r\n            count: this.symbolCurrent.split('/')[1],\r\n            name: this.symbolCurrent,\r\n            symbol: symbolArr[1] ? symbolArr[0] + symbolArr[1] : symbolArr[0],\r\n          };\r\n        }\r\n        const symbolArr = this.symbolCurrent.toLowerCase().split('/');\r\n        const showSymbol = getCoinShowName(this.symbolCurrent, this.symbolAll);\r\n        const showSymbolArr = showSymbol.toLowerCase().split('/');\r\n        return {\r\n          base: this.symbolCurrent.split('/')[0],\r\n          count: this.symbolCurrent.split('/')[1],\r\n          name: this.symbolCurrent,\r\n          symbol: symbolArr[0] + symbolArr[1],\r\n          showSymbol: showSymbolArr[0] + showSymbolArr[1],\r\n        };\r\n      }\r\n      return {\r\n        base: null, // 基础货币\r\n        count: null, // 计价货币\r\n        name: null, // 大写 带/\r\n        symbol: null, // 小写\r\n      };\r\n    },\r\n    timeArry() {\r\n      const a = [];\r\n      if (this.baseTimeArry.length) {\r\n        this.baseTimeArry.forEach((it) => {\r\n          const t = [];\r\n          if (it.indexOf('min') > -1) {\r\n            t.push(it, parseFloat(it));\r\n          } else if (\r\n            it.toLowerCase().indexOf('h') > -1\r\n            && it.indexOf('month') < 0\r\n          ) {\r\n            t.push(it, parseFloat(it) * 60);\r\n          } else if (it.indexOf('day') > -1) {\r\n            t.push(it, parseFloat(it) * 24 * 60);\r\n          } else if (it.indexOf('week') > -1) {\r\n            t.push(it, parseFloat(it) * 7 * 24 * 60);\r\n          } else if (it.indexOf('month') > -1) {\r\n            t.push(it, parseFloat(it) * 30 * 24 * 60);\r\n          }\r\n          a.push(t);\r\n        });\r\n      }\r\n      return a;\r\n    },\r\n    // 币币and杠杆 全部货币对\r\n    symbolAll() {\r\n      return this.$store.state.baseData.symbolAll;\r\n    },\r\n    themeTV() {\r\n      const theme = getCookie('cusSkin') || getCookie('defSkin') || '1';\r\n      const stheme = theme.toString() === '1' ? 'Dark' : 'Light';\r\n      return stheme;\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      // 杠杆当前选中的币对\r\n      if (this.moduleType === 'lever') {\r\n        this.symbolCurrent = myStorage.get('leverSymbolName');\r\n      }\r\n      // 合约当前选中的币对\r\n      if (this.moduleType === 'co') {\r\n        this.TvBoxHeight = '710px';\r\n        this.symbolCurrent = myStorage.get('coNowSymbol');\r\n      }\r\n      // 监听TV 是否是全屏状态\r\n      document.removeEventListener('fullscreenchange', this.quitfullTv);\r\n      document.addEventListener('fullscreenchange', this.quitfullTv);\r\n      this.$bus.$on('SYMBOL_LIST_ALL', (data) => {\r\n        this.coSymbolAll = data;\r\n      });\r\n      // 设置国际版TV的高度\r\n      this.setTvBoxHeight();\r\n      this.$bus.$on('WINFOW_ON_RESIIZE', () => {\r\n        const { topMenuBox = null, topMenuBar = null } = this.$refs;\r\n\r\n        // 监听TV 是否是全屏状态\r\n        this.quitfullTv();\r\n        // 设置国际版TV的高度\r\n        this.setTvBoxHeight();\r\n        // 市场 个数的超出宽度\r\n\r\n        if (topMenuBox && topMenuBar) {\r\n          this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\r\n        }\r\n\r\n        this.slideMarket('left');\r\n      });\r\n      if (this.lanArry.indexOf(this.language) <= -1) {\r\n        this.language = 'en';\r\n      }\r\n      if (getCookie('lan') === 'el_GR') {\r\n        this.language = 'zh_TW';\r\n      }\r\n      if (!myStorage.get('lastTimeS')) {\r\n        myStorage.set('lastTimeS', '30min');\r\n        this.lastTimeS = '30min';\r\n      }\r\n      // 监听 WebSocket 链接成功\r\n      this.$bus.$on('WEBSOCKET_ON_OPEN', (val) => {\r\n        this.MywebSocket = val;\r\n        if (this.MywebSocket) {\r\n          this.isCreateWidget = false;\r\n          this.initTradingView();\r\n        }\r\n      });\r\n      // 获取 当前选中的货币对\r\n      this.$bus.$on('SYMBOL_CURRENT', (val) => {\r\n        if (this.symbolCurrent !== val) {\r\n          if (this.chartType === 1) {\r\n            this.isshowLoading = true;\r\n          }\r\n          this.symbolCurrent = val;\r\n          if (window.tvWidget) {\r\n            let { showSymbol } = this.symbolName;\r\n            if (this.moduleType === 'co') {\r\n              showSymbol = this.symbolName.symbol;\r\n            }\r\n            window.tvWidget.setSymbol(\r\n              showSymbol,\r\n              this.getTimeMin(true, this.lastTimeS),\r\n              () => {\r\n                this.widget.chart().executeActionById('chartReset');\r\n              },\r\n            );\r\n          }\r\n        }\r\n      });\r\n      this.$bus.$on('HIDE_LOADING', () => {\r\n        this.isshowLoading = false;\r\n      });\r\n      // 市场 个数的超出宽度\r\n      this.maxPosition = this.$refs.topMenuBox.offsetWidth - this.$refs.topMenuBar.offsetWidth;\r\n    },\r\n    setTvBoxHeight() {\r\n      if (this.templateLayoutType === '2') {\r\n        let bodyH = document.body.clientHeight;\r\n        if (bodyH < 800) {\r\n          bodyH = 800;\r\n        }\r\n        if (this.moduleType === 'co') {\r\n          this.TvBoxHeight = '100%';\r\n        } else {\r\n          this.TvBoxHeight = `${bodyH - 475}px`;\r\n        }\r\n      }\r\n    },\r\n    enter(index) {\r\n      this.chartTypeHove = index;\r\n    },\r\n    leave() {\r\n      this.chartTypeHove = null;\r\n    },\r\n    chartTypeShow(num) {\r\n      if (this.chartType === num || this.chartTypeHove === num) {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    initTradingView() {\r\n      this.createWidget();\r\n    },\r\n    // tadingView 生命周期函数\r\n    udf_datafeed() {\r\n      const self = this;\r\n      return {\r\n        onReady(callback) {\r\n          const cnf = {\r\n            supported_resolutions: self.getTimeMin(false, 1), // 数组\r\n            supports_group_request: false,\r\n            supports_marks: true,\r\n            supports_search: false,\r\n            supports_timescale_marks: false,\r\n          };\r\n          setTimeout(() => {\r\n            callback(cnf);\r\n          }, 0);\r\n        },\r\n        // 切换币对后\r\n        resolveSymbol(symbolName, onSymbolResolvedCallback) {\r\n          setTimeout(() => {\r\n            onSymbolResolvedCallback({\r\n              name: symbolName,\r\n              'exchange-traded': '',\r\n              'exchange-listed': '',\r\n              minmov: 1,\r\n              minmov2: 0,\r\n              pointvalue: 1,\r\n              session: '0000-2400:1234567',\r\n              has_intraday: true,\r\n              has_no_volume: false,\r\n              volume_precision: 1,\r\n              description: symbolName.toUpperCase(),\r\n              type: 'bitcoin',\r\n              supported_resolutions: self.getTimeMin(false, 1),\r\n              pricescale: self.fixDepthNumber(self.symbolName.name),\r\n              ticker: symbolName.toUpperCase(),\r\n              timezone: window.jstz.determine().name(),\r\n            });\r\n          }, 0);\r\n        },\r\n        // 获取深度数据（k线无需请求深度）\r\n        calculateHistoryDepth() {\r\n          return undefined;\r\n        },\r\n        // tradingview 获取历史数据\r\n        getBars(\r\n          symbolInfo,\r\n          resolution,\r\n          from,\r\n          to,\r\n          onHistoryCallback,\r\n          onErrorCallback,\r\n          firstDataRequest,\r\n        ) {\r\n          if (firstDataRequest) {\r\n            self.lTime = false;\r\n          }\r\n          const lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\r\n          if (self.MywebSocket) {\r\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\r\n              type: 'req',\r\n              symbol: self.symbolName.symbol,\r\n              lastTimeS,\r\n              lTime: self.lTime,\r\n              number: 50,\r\n            });\r\n          }\r\n          self.$bus.$off('KLINE_DATA_REQ');\r\n          self.$bus.$on('KLINE_DATA_REQ', (data) => {\r\n            const channelArr = data.channel.split('_');\r\n            const Ntime = channelArr[channelArr.length - 1];\r\n            let [, symbolType] = data.channel.split('_');\r\n            if (self.moduleType === 'co') {\r\n              const [, symbol, type] = data.channel.split('_');\r\n              symbolType = `${symbol}_${type}`;\r\n            }\r\n            if (data.event_rep === 'rep' && symbolType === self.symbolName.symbol && lastTimeS === Ntime) {\r\n              self.fTime = 0;\r\n              const klData = data.data;\r\n              const arrData = [];\r\n              if (data.data && data.data.length) {\r\n                klData.forEach((item) => {\r\n                  arrData.push(self.setData(item));\r\n                });\r\n                self.fTime = arrData[arrData.length - 1].time;\r\n                if (self.lTime === klData[0].id) {\r\n                  onHistoryCallback([], { noData: true });\r\n                  logImg({\r\n                    host: window.location.host,\r\n                    type: 'onHistoryCallback',\r\n                    path: window.location.href,\r\n                    ds: 'onHistoryCallback noDate',\r\n                    data: {\r\n                      symbol: self.symbolCurrent,\r\n                    },\r\n                    t: new Date().getTime(),\r\n                  });\r\n                } else {\r\n                  self.lTime = klData[0].id;\r\n                  onHistoryCallback(arrData);\r\n                }\r\n              } else {\r\n                if (self.secend < 3) {\r\n                  self.udf_datafeed().getBars(\r\n                    symbolInfo,\r\n                    resolution,\r\n                    from,\r\n                    to,\r\n                    onHistoryCallback,\r\n                    onErrorCallback,\r\n                    firstDataRequest,\r\n                  );\r\n                  self.secend += 1;\r\n                  return;\r\n                }\r\n                if (!self.lTime) {\r\n                  logImg({\r\n                    host: window.location.host,\r\n                    type: 'tradingView',\r\n                    path: window.location.href,\r\n                    ds: 'first onHistoryCallback noData',\r\n                    data,\r\n                    t: new Date().getTime(),\r\n                  });\r\n                }\r\n                onHistoryCallback([], { noData: true });\r\n              }\r\n            }\r\n          });\r\n          if (!self.isCreateWidget) {\r\n            self.widget_onChartReady();\r\n            self.widget.chart().setChartType(1);\r\n          }\r\n        },\r\n        // tradingview 获取实时数据\r\n        subscribeBars(symbolInfo, resolution, onRealtimeCallback) {\r\n          self.isshowLoading = false;\r\n          const lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\r\n          if (self.MywebSocket) {\r\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\r\n              type: 'sub',\r\n              symbol: self.symbolName.symbol,\r\n              lastTimeS,\r\n            });\r\n          }\r\n          self.$bus.$off('KLINE_DATA_SUB');\r\n          self.$bus.$on('KLINE_DATA_SUB', (data) => {\r\n            const channelArr = data.channel.split('_');\r\n            const Ntime = channelArr[channelArr.length - 1];\r\n            let symbolType;\r\n            if (self.moduleType === 'co') {\r\n              const [, symbol, type] = data.channel.split('_');\r\n              symbolType = `${symbol}_${type}`;\r\n            } else {\r\n              [, symbolType] = data.channel.split('_');\r\n            }\r\n            if (\r\n              data.tick\r\n              && symbolType === self.symbolName.symbol\r\n              && Ntime === lastTimeS\r\n            ) {\r\n              const tickData = self.setData(data.tick);\r\n              if (self.fTime < tickData.time) {\r\n                onRealtimeCallback(tickData);\r\n              }\r\n            }\r\n          });\r\n        },\r\n        // tradingview 取消订阅上一 币对 / 刻度\r\n        unsubscribeBars(subscriberUID) {\r\n          const arr = subscriberUID.split('_');\r\n          let symbol = arr[0].toLowerCase();\r\n          let lastTimeS = self.getTimeMin(true, parseFloat(arr[1]));\r\n          if (self.moduleType === 'co') {\r\n            symbol = arr[0].toLowerCase() + arr[1].toLowerCase();\r\n            lastTimeS = self.getTimeMin(true, parseFloat(arr[2]));\r\n          }\r\n          self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\r\n            type: 'unsub',\r\n            symbol,\r\n            lastTimeS,\r\n          });\r\n        },\r\n      };\r\n    },\r\n    // 创建 TradingView\r\n    createWidget() {\r\n      class F extends window.TradingView.widget {}\r\n      window.tvWidget = new F({\r\n        debug: false,\r\n        autosize: true,\r\n        timezone: window.jstz.determine().name(),\r\n        symbol: this.symbolName.showSymbol,\r\n        interval: this.getTimeMin(true, this.lastTimeS),\r\n        container_id: 'tv_chart_container', // DOM id\r\n        datafeed: this.udf_datafeed(), // 配置 生命周期\r\n        library_path: '/static/charting_library/', // 静态文件路径\r\n        locale: this.language, // 语言\r\n        disabled_features: [\r\n          'header_symbol_search',\r\n          'timeframes_toolbar',\r\n          'volume_force_overlay',\r\n          'header_saveload',\r\n          'header_resolutions',\r\n          'header_compare',\r\n          'header_screenshot',\r\n          'header_undo_redo',\r\n          'adaptive_logo',\r\n          'header_fullscreen_button',\r\n          'timezone_menu',\r\n          'scales_context_menu',\r\n          'legend_context_menu',\r\n          'symbol_search_hot_key',\r\n          // 'use_localstorage_for_settings',\r\n          // 'show_chart_property_page',\r\n          // 'timeframes_toolbar',\r\n          // 'symbol_info',\r\n          // 'header_widget_dom_node',\r\n          // 'header_indicators',\r\n          // 'header_widget',\r\n          // 'pane_context_menu',\r\n          // 'header_fullscreen_button',\r\n          // 'display_market_status',\r\n          // 'header_chart_type',\r\n        ],\r\n        enabled_features: [\r\n          // 'study_templates',\r\n          'hide_left_toolbar_by_default',\r\n        ],\r\n        charts_storage_url: `${window.location.protocol}//saveload.tradingview.com`,\r\n        charts_storage_api_version: '1.1',\r\n        client_id: 'tradingview.com',\r\n        user_id: 'public_user',\r\n        toolbar_bg: getHex(colorMap['a-6-bg']), // 工具栏底色\r\n        theme: this.themeTV,\r\n        studies_overrides: {\r\n          'volume.volume.color.0': getHex(colorMap['u-4-bg']),\r\n          'volume.volume.color.1': getHex(colorMap['u-1-bg']),\r\n          'volume.volume.transparency': 50,\r\n        },\r\n        overrides: {\r\n          // k线的颜色\r\n          volumePaneSize: 'small', // 成交量大小\r\n          'scalesProperties.fontSize': 12, // 图标区域xy轴 字体大小\r\n          'scalesProperties.textColor': getHex(colorMap['b-3-cl']), // 图标区域xy轴 文字颜色\r\n          'scalesProperties.lineColor': getHex(colorMap['a-3-bd']), // 图标区域xy轴颜色\r\n          'paneProperties.background': getHex(colorMap['a-6-bg']), // 图标区域 背景色\r\n          'paneProperties.vertGridProperties.color': getHex(colorMap['a-7-bg']), // 图标区域 表格纵轴颜色\r\n          'paneProperties.horzGridProperties.color': getHex(colorMap['a-7-bg']), // 图标区域 表格橫轴颜色\r\n          'paneProperties.crossHairProperties.color': getHex(\r\n            colorMap['b-2-bg'],\r\n          ), // 图标区域 鼠标十字线颜色\r\n          'paneProperties.legendProperties.showLegend': true, // 折叠信息\r\n          // 柱状图颜色设置\r\n          'mainSeriesProperties.candleStyle.upColor': getHex(colorMap['u-1-cl']),\r\n          'mainSeriesProperties.candleStyle.downColor': getHex(colorMap['u-4-cl']),\r\n          'mainSeriesProperties.candleStyle.drawWick': true,\r\n          'mainSeriesProperties.candleStyle.drawBorder': true,\r\n          'mainSeriesProperties.candleStyle.borderColor': '',\r\n          'mainSeriesProperties.candleStyle.borderUpColor': getHex(colorMap['u-1-cl']),\r\n          'mainSeriesProperties.candleStyle.borderDownColor': getHex(colorMap['u-4-cl']),\r\n          'mainSeriesProperties.candleStyle.wickUpColor': getHex(colorMap['u-1-cl']),\r\n          'mainSeriesProperties.candleStyle.wickDownColor': getHex(colorMap['u-4-cl']),\r\n          'mainSeriesProperties.candleStyle.barColorsOnPrevClose': !1,\r\n          // 分时图颜色设置\r\n          // 分时背景色渐变 上半部分\r\n          'mainSeriesProperties.areaStyle.color1': colorMap['a-15-bg'],\r\n          // 分时背景色渐变 下半部分\r\n          'mainSeriesProperties.areaStyle.color2': colorMap['a-17-bg'],\r\n          'mainSeriesProperties.areaStyle.linecolor': getHex(\r\n            colorMap['a-12-bd'],\r\n          ),\r\n          'mainSeriesProperties.areaStyle.linestyle': 0,\r\n          'mainSeriesProperties.areaStyle.linewidth': 2,\r\n          'mainSeriesProperties.areaStyle.priceSource': 'close',\r\n        },\r\n      });\r\n      this.widget = window.tvWidget;\r\n    },\r\n    // 格式化时间刻度\r\n    getTimeMin(only, type) {\r\n      if (only) {\r\n        let t = null;\r\n        if (this.timeArry.length) {\r\n          this.timeArry.forEach((item) => {\r\n            const s = item.indexOf(type);\r\n            if (s > -1) {\r\n              t = s === 0 ? item[1] : item[0];\r\n            }\r\n          });\r\n        }\r\n        return t;\r\n      }\r\n      const t = [];\r\n      this.timeArry.forEach((item) => {\r\n        t.push(item[type]);\r\n      });\r\n      return t;\r\n    },\r\n    // 精度计算\r\n    fixDepthNumber(symbolName) {\r\n      let n;\r\n      if (this.moduleType === 'co') {\r\n        n = this.coSymbolAll[symbolName].pricePrecision;\r\n      } else {\r\n        n = this.symbolAll[symbolName].price;\r\n      }\r\n      const b = 10 ** n;\r\n      return parseFloat(b.toString());\r\n    },\r\n    widget_onChartReady() {\r\n      this.isCreateWidget = true;\r\n      this.creatMA();\r\n      // ===== 默认样式皮肤修改 =====\r\n      const style = document.createElement('style');\r\n      /* eslint-disable */\r\n      const clas = document.createTextNode(\r\n        \".apply-common-tooltip,.wrap-1GG7GnNO- svg{fill:\" +\r\n          colorMap[\"b-3-cl\"] +\r\n          \"!important;color:\" +\r\n          colorMap[\"b-3-cl\"] +\r\n          \"!important;cursor: pointer;}.textColor .wrap-18oKCBRc- div,.wrap-18oKCBRc- .apply-common-tooltip:hover,.wrap-1GG7GnNO- svg:hover,.button-263WXsg--.isActive-2mI1-NUL- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-:hover{fill:\" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \"!important;color:\" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \"!important;}.container-3_8ayT2Q- .background-Q1Fcmxly-{fill: \" +\r\n          colorMap[\"b-2-cl\"] +\r\n          \"; stroke: \" +\r\n          colorMap[\"b-2-cl\"] +\r\n          \";}.container-3_8ayT2Q- .arrow-WcYWFXUn-, html.theme-dark .container-3_8ayT2Q- .arrow-WcYWFXUn-{stroke: \" +\r\n          colorMap[\"b-1-cl\"] +\r\n          \";}.feature-no-touch .container-3_8ayT2Q-:hover .background-Q1Fcmxly-{fill: \" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \";stroke: \" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \";}\"\r\n      );\r\n    /* eslint-enable */\r\n      style.append(clas);\r\n      this.widget.headerReady().then(() => {\r\n        this.widget.createButton().append(style);\r\n      });\r\n    },\r\n    creatMA() {\r\n      // ===== 创建移动均线 =====\r\n      this.widget\r\n        .chart()\r\n        .createStudy('Moving Average', false, false, [5], null, {\r\n          'plot.color': '#F5CB89',\r\n        });\r\n      this.widget\r\n        .chart()\r\n        .createStudy('Moving Average', false, false, [10], null, {\r\n          'plot.color': '#5FCFBF',\r\n        });\r\n      this.widget\r\n        .chart()\r\n        .createStudy('Moving Average', false, false, [30], null, {\r\n          'plot.color': '#DD89F5',\r\n        });\r\n    },\r\n    setMAShow() {\r\n      // ===== 显示移动均线 =====\r\n      const c = this.widget.chart().getAllStudies();\r\n      this.widget.chart().setEntityVisibility(c[0].id, true);\r\n      this.widget.chart().setEntityVisibility(c[1].id, true);\r\n      this.widget.chart().setEntityVisibility(c[2].id, true);\r\n    },\r\n    setMAHide() {\r\n      // ===== 隐藏移动均线 =====\r\n      const c = this.widget.chart().getAllStudies();\r\n      this.widget.chart().setEntityVisibility(c[0].id, false);\r\n      this.widget.chart().setEntityVisibility(c[1].id, false);\r\n      this.widget.chart().setEntityVisibility(c[2].id, false);\r\n    },\r\n    timeClike(v) {\r\n      if (v !== 'Line' && v !== '1min' && v !== this.lastTimeS) {\r\n        this.isshowLoading = true;\r\n      }\r\n      if (v !== this.lastTimeS) {\r\n        this.lastTimeS = v;\r\n        if (v === 'Line') {\r\n          myStorage.set('lastTimeS', '1min');\r\n        } else {\r\n          myStorage.set('lastTimeS', v);\r\n        }\r\n        this.$bus.$emit('LAST-TIMES', v);\r\n        if (this.isCreateWidget) {\r\n          const resolution = this.widget.chart().resolution();\r\n          if (v === 'Line') {\r\n            if (resolution !== '1') {\r\n              this.widget.chart().setResolution('1', () => {\r\n                this.widget.chart().setChartType(3); // 折线图\r\n              });\r\n            } else if (resolution === '1') {\r\n              this.widget.chart().setChartType(3);\r\n            }\r\n            this.setMAHide();\r\n          } else {\r\n            if (resolution === '1' && v === '1min') {\r\n              this.widget.chart().setChartType(1); // 蜡烛图\r\n            } else {\r\n              const timeS = this.getTimeMin(true, v);\r\n              this.widget.chart().setResolution(timeS.toString(), () => {\r\n                this.widget.chart().setChartType(1);\r\n                this.widget.chart().executeActionById('chartReset');\r\n              });\r\n            }\r\n            this.setMAShow();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    // 格式化数据\r\n    setData(obj) {\r\n      return {\r\n        time: obj.id * 1000,\r\n        close: obj.close,\r\n        open: obj.open,\r\n        high: obj.high,\r\n        low: obj.low,\r\n        volume: obj.vol,\r\n      };\r\n    },\r\n    switchChartType(type) {\r\n      if (type === 2) {\r\n        this.isshowLoading = false;\r\n      }\r\n      this.chartType = type;\r\n      setTimeout(() => {\r\n        const { topMenuBox = null, topMenuBar = null } = this.$refs;\r\n        this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\r\n      }, 500);\r\n    },\r\n    quit(e) {\r\n      this.isfullTv = false;\r\n      if (this.isfullTv) {\r\n        const key = e.keyCode;\r\n        if (key === 27) {\r\n          this.isfullTv = false;\r\n        }\r\n      }\r\n    },\r\n    fullTv() {\r\n      if (!this.isfullTv) {\r\n        this.isfullTv = true;\r\n        const element = this.$refs.tv_chart_container;\r\n        if (element.requestFullscreen) {\r\n          element.requestFullscreen();\r\n        } else if (element.mozRequestFullScreen) {\r\n          element.mozRequestFullScreen();\r\n        } else if (element.webkitRequestFullscreen) {\r\n          element.webkitRequestFullscreen();\r\n        } else if (element.msRequestFullscreen) {\r\n          element.msRequestFullscreen();\r\n        }\r\n      } else {\r\n        this.isfullTv = false;\r\n        if (document.exitFullscreen) {\r\n          document.exitFullscreen();\r\n        } else if (document.mozCancelFullScreen) {\r\n          document.mozCancelFullScreen();\r\n        } else if (document.webkitExitFullscreen) {\r\n          document.webkitExitFullscreen();\r\n        }\r\n      }\r\n    },\r\n    quitfullTv() {\r\n      // 监听TV 是否是全屏状态\r\n      if (this.isfullTv) {\r\n        this.isfullTv = window.fullScreen\r\n          || document.webkitIsFullScreen\r\n          || document.msFullscreenElement;\r\n      }\r\n    },\r\n    // 设置时间刻度的滚动\r\n    slideMarket(type) {\r\n      let position = parseFloat(this.slidePosition);\r\n      if (this.$refs.topMenuBar) {\r\n        if (type === 'left') {\r\n          position += this.$refs.topMenuBar.offsetWidth / 2;\r\n          if (position > 0) {\r\n            position = 0;\r\n          }\r\n        } else {\r\n          position -= this.$refs.topMenuBar.offsetWidth / 2;\r\n          if (position < -this.maxPosition) {\r\n            position = -this.maxPosition;\r\n          }\r\n        }\r\n        this.slidePosition = `${position}px`;\r\n      }\r\n    },\r\n  },\r\n\r\n};\r\n"]}]}