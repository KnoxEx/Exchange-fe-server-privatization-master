{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/fiatdeal/creditCard/creditCard.js","dependencies":[{"path":"/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/fiatdeal/creditCard/creditCard.js","mtime":1637244007054},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport { fixInput, fixD } from '@/utils';\nexport default {\n  data: function data() {\n    return {\n      confirmFlag: false,\n      redioFlag: false,\n      activeToken: '',\n      // 当前 数字货币\n      activeFiat: '',\n      // 当前 法币货币\n      tokenList: [],\n      // 数字货币 下拉列表\n      fiatList: [],\n      // 法币货币 下拉列表\n      tokenInput: '',\n      // 输入的数字货币\n      fiatInput: '',\n      // 输入的法币货币\n      nowRate: 0,\n      // 当前币种汇率\n      sourceID: '',\n      spks: {},\n      // 区间\n      dialogConfirmLoading: false,\n      callBackFlag: false // 回调弹窗\n\n    };\n  },\n  computed: {\n    loginFlag: function loginFlag() {\n      var _this$$store$state$ba = this.$store.state.baseData,\n          isLogin = _this$$store$state$ba.isLogin,\n          userInfoIsReady = _this$$store$state$ba.userInfoIsReady;\n\n      if (isLogin && userInfoIsReady) {\n        return true;\n      }\n\n      return false;\n    },\n    warn2Text: function warn2Text() {\n      var value = this.$t('creditCard.warn2');\n      var arr = ['https://buy.moonpay.io/trade_history', '/assets/flowingWater'];\n      return this.setLocals(value, arr);\n    },\n    callBackText1: function callBackText1() {\n      var value = this.$t('creditCard.callBackText1');\n      var arr = ['https://buy.moonpay.io/trade_history'];\n      return this.setLocals(value, arr);\n    },\n    lan: function lan() {\n      if (this.$store.state.baseData) {\n        return this.$store.state.baseData.lan;\n      }\n\n      return null;\n    },\n    linkurl: function linkurl() {\n      if (this.$store.state.baseData.publicInfo) {\n        return this.$store.state.baseData.publicInfo.url;\n      }\n\n      return {};\n    },\n    dialogConfirmDisabled: function dialogConfirmDisabled() {\n      if (this.dialogConfirmLoading) {\n        return false;\n      }\n\n      if (this.redioFlag) {\n        return false;\n      }\n\n      return true;\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    nowSpk: function nowSpk() {\n      var obj = '';\n\n      if (this.spks[this.activeFiat]) {\n        obj = this.spks[this.activeFiat];\n      }\n\n      return obj;\n    },\n    inputError: function inputError() {\n      var obj = {\n        flag: false,\n        show: false,\n        text: ''\n      };\n      var _this$nowSpk = this.nowSpk,\n          minAmount = _this$nowSpk.minAmount,\n          maxAmount = _this$nowSpk.maxAmount;\n      var numb = parseFloat(this.fiatInput);\n\n      if (this.fiatInput && this.nowSpk) {\n        if (minAmount - 1 < numb && numb < maxAmount + 1) {\n          obj.flag = true;\n        } else {\n          obj.show = true; // 下单区间\n\n          obj.text = \"\".concat(this.$t('creditCard.spk'), \"\\uFF1A\").concat(minAmount, \" \").concat(this.activeFiat, \"\\n           ~ \").concat(maxAmount, \" \").concat(this.activeFiat);\n        }\n      }\n\n      return obj;\n    },\n    buttonDisable: function buttonDisable() {\n      var flag = true;\n\n      if (this.activeFiat && this.inputError.flag) {\n        flag = false;\n      }\n\n      return flag;\n    }\n  },\n  watch: {\n    confirmFlag: function confirmFlag(v) {\n      if (!v) {\n        this.redioFlag = false;\n      }\n    } // tokenInput(v) {\n    //   const { coinList } = this.market;\n    //   const fix = (coinList[this.activeToken] && coinList[this.activeToken].showPrecision) || 0;\n    //   // 限制精度和不非数字字符\n    //   this.tokenInput = fixInput(v, fix).toString();\n    // },\n    // fiatInput(v) {\n    //   this.fiatInput = fixInput(v, 2).toString();\n    // },\n\n  },\n  methods: {\n    goLogin: function goLogin() {\n      this.$router.push('/login');\n    },\n    setLocals: function setLocals(value, linkList) {\n      var str = value;\n      var newStr = '';\n\n      if (str) {\n        var arr = str.split('$<');\n        var i = 0;\n        arr.forEach(function (item) {\n          if (item.indexOf('>$') !== -1) {\n            var url = linkList[i];\n            i += 1;\n            var n = item.split('>$');\n            newStr += \"<a class=\\\"u-8-cl\\\" href=\\\"\".concat(url, \"\\\" target=\\\"_block\\\">\\n              \").concat(n[0], \"</a>\").concat(n[1]);\n          } else {\n            newStr += item;\n          }\n        });\n      }\n\n      return newStr;\n    },\n    callBackSubmit: function callBackSubmit() {\n      this.$router.push('/assets/exchangeAccount');\n    },\n    callBackClose: function callBackClose() {\n      this.callBackFlag = false;\n    },\n    setRedio: function setRedio() {\n      this.redioFlag = !this.redioFlag;\n    },\n    submit: function submit() {\n      this.confirmFlag = true;\n    },\n    confirmClose: function confirmClose() {\n      this.confirmFlag = false;\n    },\n    confirmSubmit: function confirmSubmit() {\n      this.dialogConfirmLoading = true; // this.axios({\n      //   url: 'finance/get_charge_address',\n      //   params: {\n      //     symbol: this.activeToken,\n      //   },\n      // }).then((data) => {\n      //   if (data.code.toString() === '0') {\n      //     this.getD();\n      //   } else {\n      //     this.$bus.$emit('tip', { text: data.msg, type: 'error' });\n      //   }\n      // });\n\n      this.getD();\n    },\n    getD: function getD() {\n      var _this = this;\n\n      this.axios({\n        url: 'credit/createOrder',\n        hostType: 'fe-credit-api',\n        params: {\n          token: this.activeToken,\n          // 加密货币\n          fiatCoin: this.activeFiat,\n          // 法定货币\n          amount: this.fiatInput // 法定货币数额 （正整数）\n          // source: this.sourceID, // 服务商ID\n\n        },\n        method: 'post'\n      }).then(function (data) {\n        _this.dialogConfirmLoading = false;\n\n        if (data.code === '0') {\n          // window.location.href = data.data.url;\n          window.open(data.data.orderUrl);\n          _this.confirmFlag = false;\n          _this.callBackFlag = true;\n        } else {\n          _this.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    inputChanges: function inputChanges(value, name) {\n      this[name] = value;\n      var coinList = this.market.coinList;\n      var fix = coinList[this.activeToken] && coinList[this.activeToken].showPrecision || 0;\n\n      if (name === 'tokenInput') {\n        // 限制精度和不非数字字符\n        this.tokenInput = fixInput(value, fix);\n        this.fiatInput = fixD(this.tokenInput * this.nowRate, 0);\n      } else {\n        this.fiatInput = fixInput(value, 0);\n        this.tokenInput = fixD(this.fiatInput / this.nowRate, fix);\n      }\n    },\n    init: function init() {\n      this.getLogos();\n      this.getCoins();\n    },\n    // 获取头部logo\n    getLogos: function getLogos() {// this.axios({\n      //   url: 'middleman/bankList',\n      //   hostType: 'fe-credit-api',\n      //   params: {},\n      //   method: 'post',\n      // }).then((data) => {\n      //   if (data.code === '0') {\n      //     console.log(data);\n      //   } else {\n      //     this.$bus.$emit('tip', { text: data.msg, type: 'error' });\n      //   }\n      // });\n    },\n    // 获取币种列表\n    getCoins: function getCoins() {\n      var _this2 = this;\n\n      this.axios({\n        url: 'credit/availableCoins',\n        hostType: 'fe-credit-api',\n        params: {},\n        method: 'post'\n      }).then(function (data) {\n        if (data.code === '0') {\n          var _data$data = data.data,\n              fiatList = _data$data.fiatList,\n              tokenList = _data$data.tokenList;\n          var fiatArr = [];\n          fiatList.forEach(function (item) {\n            fiatArr.push({\n              value: item.fiatCoin,\n              code: item.fiatCoin\n            });\n\n            if (item.isDefault) {\n              _this2.activeFiat = item.fiatCoin;\n            }\n\n            _this2.spks[item.fiatCoin] = item;\n          });\n          var tokenArr = [];\n          tokenList.forEach(function (item) {\n            var value = item.coin;\n\n            if (value === 'EUSDT') {\n              value = 'USDT(ERC20)';\n            }\n\n            tokenArr.push({\n              value: value,\n              code: item.coin\n            });\n\n            if (item.isDefault) {\n              _this2.activeToken = item.coin;\n            }\n          });\n          _this2.fiatList = fiatArr;\n          _this2.tokenList = tokenArr;\n\n          _this2.getMess();\n        } else {// this.$bus.$emit('tip', { text: data.msg, type: 'error' });\n        }\n      });\n    },\n    getMess: function getMess() {\n      var _this3 = this;\n\n      this.axios({\n        url: 'credit/moonPayRate',\n        hostType: 'fe-credit-api',\n        params: {\n          token: this.activeToken,\n          // 加密货币\n          fiatCoin: this.activeFiat // 法定货币\n\n        },\n        method: 'post'\n      }).then(function (data) {\n        if (data.code === '0') {\n          if (_this3.fiatInput || _this3.tokenInput) {\n            _this3.fiatInput = '';\n            _this3.tokenInput = ''; // 汇率已更新，请重新下单\n\n            _this3.$bus.$emit('tip', {\n              text: _this3.$t('creditCard.warningText'),\n              type: 'warning'\n            });\n          }\n\n          _this3.nowRate = data.data.moonPayRate; // this.sourceID = data.data.serverList[0].id;\n        } else {// this.$bus.$emit('tip', { text: data.msg, type: 'error' });\n        }\n      });\n    },\n    reset: function reset() {\n      this.tokenInput = '';\n      this.fiatInput = '';\n      this.nowRate = 0;\n      this.getMess();\n    },\n    tokenChange: function tokenChange(item) {\n      if (item.code === this.activeToken) return;\n      this.activeToken = item.code;\n      this.reset();\n    },\n    fiatChange: function fiatChange(item) {\n      if (item.code === this.activeFiat) return;\n      this.activeFiat = item.code;\n      this.reset();\n    }\n  }\n};",null]}