{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/SetUp/SetUp.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/SetUp/SetUp.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\nexport default {\n  name: 'setUp',\n  data: function data() {\n    return {\n      loading: false,\n      paymentList: [],\n      // 判断是否已有收款方式\n      paymentId: '',\n      collectionWays: '',\n      certificateTypeErrorFlag: false,\n      certificateTypeList: [],\n      paycoinsWays: '',\n      paycoinsTypeErrorFlag: false,\n      paycoinsTypeList: [],\n      certificateData: [],\n      cardFlag: false,\n      payment: 1,\n      payments: null,\n      payments2: null,\n      payments3: null,\n      payments4: null,\n      disabled: true,\n      // 验证码部分\n      promptText1: this.$t('personal.label.smsCodeText'),\n      errorText1: this.$t('personal.prompt.errorCode'),\n      checkErrorFlag1: false,\n      checkValue1: '',\n      promptText2: this.$t('personal.label.googleCodeText'),\n      errorText2: this.$t('personal.prompt.errorCode'),\n      checkErrorFlag2: false,\n      checkValue2: '',\n      // 验证框显示隐藏\n      smsCode: false,\n      googleCode: false,\n      // 提交时\n      // 公用参数\n      userName: '',\n      account: '',\n      // 西联汇款可不填\n      accountType: '',\n      // 账号类型\n      // 非银行卡情况\n      qrcodeImg: '',\n      // 银行卡相关\n      bank: '',\n      branch: '',\n      // 选填\n      // 判断是修改还是添加 0为添加1为修改\n      set: 0,\n      obj: {},\n      id: ''\n    };\n  },\n  methods: {\n    init: function init() {\n      // 这里请求otcPublicInfo\n      var paymentId = this.$route.query.paymentId; // url参数\n\n      var otcPublicInfo = this.$store.state.baseData.otcPublicInfo; // otc publicinfo\n\n      var userInfo = this.$store.state.baseData.userInfo; // userinfo\n\n      var otcPaymentFind = this.$store.state.personal.otcPaymentFind; // 支付列表\n\n      this.$store.dispatch('otcPaymentFind');\n\n      if (paymentId) {\n        // 有值则为修改\n        this.set = 1;\n        this.paymentId = paymentId; // 查看是否有数据\n\n        if (otcPaymentFind) {\n          // 有则使用\n          this.modifyData(otcPaymentFind);\n        } else {\n          // 无则请求\n          this.$store.dispatch('otcPaymentFind');\n        }\n      } else {\n        // 无值为新增\n        this.set = 0;\n        this.payment = 1;\n        this.payments = {\n          name: this.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n          title: this.$t('personal.setUp.paymentMethods.paymentsWA.title')\n        };\n      }\n\n      if (otcPublicInfo !== null) {\n        // 数据处理\n        this.collectionWays = otcPublicInfo.payments[0].key;\n\n        if (this.excheifFlag) {\n          this.paycoinsWays = otcPublicInfo.paycoins[0].key;\n        }\n\n        this.dataProcessing(otcPublicInfo);\n      } else {\n        this.$store.dispatch('getOtcPublicInfo');\n      }\n\n      if (userInfo !== null) {\n        this.googleCode = !!Number(userInfo.googleStatus);\n        this.smsCode = !!Number(userInfo.isOpenMobileCheck);\n      }\n    },\n    codeFlag: function codeFlag(val) {\n      return this.$store.state.regExp.verification.test(val);\n    },\n    judge: function judge() {\n      // 判断非银行卡非西联情况下 提交按钮是否开启\n      if (this.userName && this.account && this.qrcodeImg && !this.checkErrorFlag1 && !this.checkErrorFlag2) {\n        if (this.smsCode) {\n          this.disabled = !this.checkValue1;\n        }\n\n        if (this.googleCode) {\n          this.disabled = !this.checkValue2;\n        }\n\n        this.$forceUpdate();\n      } else {\n        this.disabled = true;\n      }\n    },\n    judge2: function judge2() {\n      // 银行卡\n      if (this.userName && this.account && this.bank && !this.checkErrorFlag1 && !this.checkErrorFlag2) {\n        if (this.smsCode) {\n          this.disabled = !this.checkValue1;\n        }\n\n        if (this.googleCode) {\n          this.disabled = !this.checkValue2;\n        }\n\n        this.$forceUpdate();\n      } else {\n        this.disabled = true;\n      }\n    },\n    judge3: function judge3() {\n      // paypal\n      if (this.userName && this.account && !this.checkErrorFlag1 && !this.checkErrorFlag2) {\n        if (this.smsCode) {\n          this.disabled = !this.checkValue1;\n        }\n\n        if (this.googleCode) {\n          this.disabled = !this.checkValue2;\n        }\n\n        this.$forceUpdate();\n      } else {\n        this.disabled = true;\n      }\n    },\n    judge4: function judge4() {\n      // 其他\n      if (this.userName && this.account && this.accountType !== '' && !this.checkErrorFlag1 && !this.checkErrorFlag2) {\n        if (this.smsCode) {\n          this.disabled = !this.checkValue1;\n        }\n\n        if (this.googleCode) {\n          this.disabled = !this.checkValue2;\n        }\n\n        this.$forceUpdate();\n      } else {\n        this.disabled = true;\n      }\n    },\n    callBack: function callBack(type, name, obj) {\n      if (type === 'payment1') {\n        this[name] = obj[name];\n        this.judge();\n      } else if (type === 'payment2') {\n        // 银行卡 {\n        this[name] = obj[name];\n        this.judge2();\n      } else if (type === 'payment3') {\n        // paypal\n        this[name] = obj[name];\n        this.judge3();\n      } else {\n        this[name] = obj[name];\n        this.accountType = obj.accountType;\n        this.judge4();\n      }\n    },\n    inputChanges: function inputChanges(value, name) {\n      if (this.collectionWays === 'otc.payment.domestic.bank.transfer') {\n        switch (name) {\n          case 'smsCode':\n            this.checkValue1 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag1 = false;\n            } else {\n              this.checkErrorFlag1 = true;\n            }\n\n            break;\n\n          default:\n            this.checkValue2 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag2 = false;\n            } else {\n              this.checkErrorFlag2 = true;\n            }\n\n        }\n\n        this.judge2();\n      } else if (this.collectionWays === 'otc.payment.western.union') {//\n      } else if (this.collectionWays === 'otc.payment.alipay' || this.collectionWays === 'otc.payment.wxpay') {\n        switch (name) {\n          case 'smsCode':\n            this.checkValue1 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag1 = false;\n            } else {\n              this.checkErrorFlag1 = true;\n            }\n\n            break;\n\n          default:\n            this.checkValue2 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag2 = false;\n            } else {\n              this.checkErrorFlag2 = true;\n            }\n\n        }\n\n        this.judge();\n      } else if (this.collectionWays === 'otc.payment.paypal') {\n        switch (name) {\n          case 'smsCode':\n            this.checkValue1 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag1 = false;\n            } else {\n              this.checkErrorFlag1 = true;\n            }\n\n            break;\n\n          default:\n            this.checkValue2 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag2 = false;\n            } else {\n              this.checkErrorFlag2 = true;\n            }\n\n        }\n\n        this.judge3();\n      } else {\n        switch (name) {\n          case 'smsCode':\n            this.checkValue1 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag1 = false;\n            } else {\n              this.checkErrorFlag1 = true;\n            }\n\n            break;\n\n          default:\n            this.checkValue2 = value;\n\n            if (this.codeFlag(value)) {\n              this.checkErrorFlag2 = false;\n            } else {\n              this.checkErrorFlag2 = true;\n            }\n\n        }\n\n        this.judge4();\n      }\n    },\n    getCodeClick: function getCodeClick() {\n      this.$bus.$emit('getCode-start', 'phone');\n      var info = {\n        operationType: 28\n      };\n      this.$store.dispatch('sendSmsCode', info);\n    },\n    btnLink: function btnLink() {\n      this.loading = true;\n      var info = {};\n\n      if (this.collectionWays === 'otc.payment.domestic.bank.transfer') {\n        info.payment = this.collectionWays;\n        info.userName = this.userName;\n        info.bankName = this.bank;\n        info.bankOfDeposit = this.branch;\n        info.account = this.account;\n        info.smsAuthCode = this.checkValue1;\n        info.googleCode = this.checkValue2;\n        info.coinName = this.paycoinsWays;\n        info.id = this.id;\n      } else if (this.collectionWays === 'otc.payment.western.union') {// console.log('西联');\n      } else if (this.collectionWays === 'otc.payment.alipay' || this.collectionWays === 'otc.payment.wxpay') {\n        info.payment = this.collectionWays;\n        info.userName = this.userName;\n        info.account = this.account;\n        info.qrcodeImg = this.qrcodeImg;\n        info.smsAuthCode = this.checkValue1;\n        info.googleCode = this.checkValue2;\n        info.id = this.id;\n      } else if (this.collectionWays === 'otc.payment.paypal') {\n        info.payment = this.collectionWays;\n        info.userName = this.userName;\n        info.account = this.account;\n        info.smsAuthCode = this.checkValue1;\n        info.googleCode = this.checkValue2;\n        info.id = this.id;\n      } else {\n        info.payment = this.collectionWays;\n        info.userName = this.userName;\n        info.account = this.account;\n        info.accountType = this.accountType;\n        info.smsAuthCode = this.checkValue1;\n        info.googleCode = this.checkValue2;\n        info.id = this.id;\n      }\n\n      if (!this.set) {\n        this.$store.dispatch('otcPaymentAdd', info);\n      } else {\n        this.$store.dispatch('otcPaymentUpdate', info);\n      }\n    },\n    paymentsChange: function paymentsChange(item) {\n      this.collectionWays = item.code;\n      this.choosePayment(item);\n    },\n    paycoinsChange: function paycoinsChange(item) {\n      this.paycoinsWays = item.code;\n    },\n    // 收款方式联动逻辑根据下拉选择应显示的收款方式，目前根据产品所述分为三种 1.微信支付宝 2.银行卡 3.paypal 4.其他所有\n    choosePayment: function choosePayment(item) {\n      this.checkValue1 = '';\n      this.checkValue2 = '';\n      this.cardFlag = false;\n\n      if (item.code === 'otc.payment.domestic.bank.transfer') {\n        this.payment = 2;\n        this.payments2 = {\n          name: this.$t('personal.setUp.paymentMethods.paymentsCard.name'),\n          bank: this.$t('personal.setUp.paymentMethods.paymentsCard.bank'),\n          branch: this.$t('personal.setUp.paymentMethods.paymentsCard.branch'),\n          account: this.$t('personal.setUp.paymentMethods.paymentsCard.account'),\n          obj: this.obj\n        };\n        this.cardFlag = true;\n      } else if (item.code === 'otc.payment.alipay' || item.code === 'otc.payment.wxpay') {\n        this.payment = 1;\n        this.payments = {\n          name: this.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n          title: item.value + this.$t('personal.setUp.paymentMethods.paymentsWA.title'),\n          obj: this.obj\n        };\n      } else if (item.code === 'otc.payment.paypal') {\n        this.payment = 3;\n        this.payments3 = {\n          name: this.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n          title: item.value + this.$t('personal.setUp.paymentMethods.paymentsWA.title'),\n          obj: this.obj\n        };\n      } else {\n        this.payment = 4;\n        this.payments4 = {\n          name: this.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n          type: this.$t('personal.setUp.paymentMethods.paymentsWA.type'),\n          title: item.value + this.$t('personal.setUp.paymentMethods.paymentsWA.title'),\n          obj: this.obj\n        };\n      }\n    },\n    dataProcessing: function dataProcessing(data) {\n      var _this = this;\n\n      if (this.excheifFlag) {\n        this.paycoinsTypeList.length = 0; // 法币类型数据处理\n\n        data.paycoins.forEach(function (obj, index) {\n          _this.paycoinsTypeList.push({\n            value: obj.title,\n            code: obj.key\n          });\n\n          if (index === 0) {\n            _this.choosePayment({\n              value: obj.title,\n              code: obj.key\n            });\n          }\n        });\n      }\n\n      this.certificateTypeList.length = 0; // select 数据处理 现在只保留三个 支付宝微信银行卡\n\n      if (!this.paymentId) {\n        // 新增\n        data.payments.forEach(function (obj, index) {\n          // 如果excheif商户初始化时判断支付宝微信银行卡\n          if (!_this.excheifFlag) {\n            if (obj.key === 'otc.payment.alipay' || obj.key === 'otc.payment.wxpay' || obj.key === 'otc.payment.domestic.bank.transfer') {\n              _this.certificateTypeList.push({\n                value: obj.title,\n                code: obj.key\n              });\n            }\n          } else {\n            _this.certificateTypeList.push({\n              value: obj.title,\n              code: obj.key\n            });\n          }\n\n          if (index === 0) {\n            _this.choosePayment({\n              value: obj.title,\n              code: obj.key\n            });\n          }\n        });\n      }\n    },\n    modifyData: function modifyData(data) {\n      var _this2 = this;\n\n      // 点进修改 处理数据\n      data.data.forEach(function (obj) {\n        if (obj.id === Number(_this2.paymentId)) {\n          _this2.obj = obj;\n\n          if (_this2.obj.payment === 'otc.payment.domestic.bank.transfer') {\n            _this2.cardFlag = true;\n            _this2.payment = 2;\n            _this2.payments2 = {\n              name: _this2.$t('personal.setUp.paymentMethods.paymentsCard.name'),\n              bank: _this2.$t('personal.setUp.paymentMethods.paymentsCard.bank'),\n              branch: _this2.$t('personal.setUp.paymentMethods.paymentsCard.branch'),\n              account: _this2.$t('personal.setUp.paymentMethods.paymentsCard.account'),\n              obj: _this2.obj\n            };\n            _this2.paycoinsWays = _this2.obj.coinName;\n            _this2.collectionWays = _this2.obj.payment;\n            _this2.userName = _this2.obj.userName;\n            _this2.bank = _this2.obj.bankName;\n            _this2.branch = _this2.obj.bankOfDeposit;\n            _this2.account = _this2.obj.account;\n            _this2.id = _this2.obj.id;\n          } else if (_this2.obj.payment === 'otc.payment.alipay' || _this2.obj.payment === 'otc.payment.wxpay') {\n            _this2.payment = 1;\n            _this2.payments = {\n              name: _this2.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n              title: _this2.obj.title + _this2.$t('personal.setUp.paymentMethods.paymentsWA.title'),\n              obj: _this2.obj\n            };\n            _this2.collectionWays = _this2.obj.payment;\n            _this2.userName = _this2.obj.userName;\n            _this2.account = _this2.obj.account;\n            _this2.qrcodeImg = _this2.obj.qrcodeImg;\n            _this2.id = _this2.obj.id;\n          } else if (_this2.obj.payment === 'otc.payment.paypal') {\n            _this2.payment = 3;\n            _this2.payments3 = {\n              name: _this2.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n              title: _this2.obj.title + _this2.$t('personal.setUp.paymentMethods.paymentsWA.title'),\n              obj: _this2.obj\n            };\n            _this2.collectionWays = _this2.obj.payment;\n            _this2.userName = _this2.obj.userName;\n            _this2.account = _this2.obj.account;\n            _this2.id = _this2.obj.id;\n          } else {\n            _this2.payment = 4;\n            _this2.payments4 = {\n              name: _this2.$t('personal.setUp.paymentMethods.paymentsWA.name'),\n              type: _this2.$t('personal.setUp.paymentMethods.paymentsWA.type'),\n              title: _this2.obj.title + _this2.$t('personal.setUp.paymentMethods.paymentsWA.title'),\n              obj: _this2.obj\n            };\n            _this2.collectionWays = _this2.obj.payment;\n            _this2.userName = _this2.obj.userName;\n            _this2.account = _this2.obj.account;\n            _this2.accountType = _this2.obj.accountType;\n            _this2.id = _this2.obj.id;\n          }\n        }\n      });\n    }\n  },\n  computed: {\n    enforceGoogleAuth: function enforceGoogleAuth() {\n      return this.$store.state.baseData.is_enforce_google_auth || 0;\n    },\n    getOtcPublicInfo: function getOtcPublicInfo() {\n      return this.$store.state.baseData.otcPublicInfo;\n    },\n    sendSmsCode: function sendSmsCode() {\n      return this.$store.state.personal.sendSmsCode;\n    },\n    otcPaymentAdd: function otcPaymentAdd() {\n      return this.$store.state.personal.otcPaymentAdd;\n    },\n    setPayment: function setPayment() {\n      return this.$store.state.personal.setPayment;\n    },\n    otcPaymentUpdate: function otcPaymentUpdate() {\n      return this.$store.state.personal.otcPaymentUpdate;\n    },\n    otcPaymentFind: function otcPaymentFind() {\n      return this.$store.state.personal.otcPaymentFind;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    excheifFlag: function excheifFlag() {\n      return Boolean(this.$store.state.baseData.exchief_project_switch);\n    }\n  },\n  watch: {\n    userInfo: function userInfo(_userInfo) {\n      if (_userInfo !== null) {\n        this.googleCode = !!Number(_userInfo.googleStatus);\n        this.smsCode = !!Number(_userInfo.isOpenMobileCheck);\n      }\n    },\n    otcPaymentFind: function otcPaymentFind(_otcPaymentFind) {\n      if (_otcPaymentFind !== null) {\n        this.paymentList = _otcPaymentFind.data; // 数据处理\n\n        this.modifyData(_otcPaymentFind);\n      }\n    },\n    getOtcPublicInfo: function getOtcPublicInfo(_getOtcPublicInfo) {\n      if (_getOtcPublicInfo !== null) {\n        // 数据处理\n        this.dataProcessing(_getOtcPublicInfo);\n        this.collectionWays = _getOtcPublicInfo.payments[0].key;\n\n        if (this.excheifFlag) {\n          this.paycoinsWays = _getOtcPublicInfo.paycoins[0].key;\n        }\n      }\n    },\n    sendSmsCode: function sendSmsCode(_sendSmsCode) {\n      if (_sendSmsCode !== null) {\n        if (_sendSmsCode.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _sendSmsCode.msg,\n            type: 'success'\n          });\n          this.$store.dispatch('resetType');\n        } else {\n          this.$bus.$emit('tip', {\n            text: _sendSmsCode.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n          this.$bus.$emit('getCode-clear', 'phone');\n        }\n      }\n    },\n    otcPaymentAdd: function otcPaymentAdd(_otcPaymentAdd) {\n      if (_otcPaymentAdd !== null) {\n        this.loading = false;\n\n        if (_otcPaymentAdd.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _otcPaymentAdd.msg,\n            type: 'success'\n          });\n          this.$store.dispatch('resetType');\n          this.$router.push('/personal/leaglTenderSet');\n        } else {\n          this.$bus.$emit('tip', {\n            text: _otcPaymentAdd.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    },\n    setPayment: function setPayment(_setPayment) {\n      if (_setPayment !== null) {\n        this.set = _setPayment.set; // console.log(setPayment);\n      }\n    },\n    otcPaymentUpdate: function otcPaymentUpdate(_otcPaymentUpdate) {\n      if (_otcPaymentUpdate !== null) {\n        this.loading = false;\n\n        if (_otcPaymentUpdate.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _otcPaymentUpdate.msg,\n            type: 'success'\n          });\n          this.$store.dispatch('resetType');\n          this.$router.push('/personal/leaglTenderSet');\n        } else {\n          this.$bus.$emit('tip', {\n            text: _otcPaymentUpdate.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    }\n  }\n};",null]}