{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/otcAccount/otcAccount.js","dependencies":[{"path":"/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/otcAccount/otcAccount.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.number.is-nan\";\nimport _defineProperty from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.sort\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { myStorage, fixD, fixRate, fixInput, colorMap, imgMap, getCoinShowName } from '@/utils';\nvar defaultIcon = imgMap.f_1;\nexport default {\n  name: 'page-otcAccount',\n  data: function data() {\n    return {\n      otcHeader: \"background: url(\".concat(imgMap.zc_otc, \")\"),\n      imgMap: imgMap,\n      colorMap: colorMap,\n      transferObj: null,\n      // 当前划转币种的信息\n      transferSide: '1',\n      // 划转方向 1 为从现货到场外  2 为场外到现货\n      dialogConfirmLoading: false,\n      // 弹窗的确认按钮loading\n      dialogFlag: false,\n      // 对话框\n      transferValue: '',\n      // 划转数量input\n      tabelLoading: true,\n      // 表格 loading\n      dataList: [],\n      // 表格 数据\n      totalBalance: '--',\n      // 资产折合\n      totalBalanceSymbol: '',\n      // 资产折合币种\n      totalRate: '--',\n      // 资产折合汇率\n      canvasPages: [],\n      // canvas\n      switchFlag: false,\n      // 是否隐藏零资产\n      findValue: '',\n      // 搜索币种\n      colors: ['rgba(255, 255, 255, 1)', 'rgba(255, 255, 255, 0.8)', 'rgba(255, 255, 255, 0.6)', 'rgba(255, 255, 255, 0.4)', 'rgba(255, 255, 255, 0.25)', 'rgba(255, 255, 255, 0.1)']\n    };\n  },\n  computed: {\n    isCoOpen: function isCoOpen() {\n      var base = this.$store.state.baseData.publicInfo;\n\n      if (base && base.switch && base.switch.indep_co_switch === '1') {\n        return true;\n      }\n\n      return false;\n    },\n    side: function side() {\n      var ex = this.isCoOpen ? this.$t('assets.index.coExchangeAccount') : this.$t('assets.index.exchangeAccount');\n      var otc = this.$t('assets.otcAccount.otcAccount');\n      var from = '';\n      var to = '';\n\n      if (this.transferSide === '1') {\n        from = ex;\n        to = otc;\n      } else {\n        from = otc;\n        to = ex;\n      }\n\n      return {\n        from: from,\n        to: to\n      };\n    },\n    // input框警示文案\n    transferWarningText: function transferWarningText() {\n      var text = this.$t('assets.otcAccount.can'); // 可转\n\n      var _this$transferData = this.transferData,\n          coin = _this$transferData.coin,\n          exNormal = _this$transferData.exNormal,\n          otcNormal = _this$transferData.otcNormal;\n      var num = this.transferSide === '1' ? exNormal : otcNormal;\n      return text + num + this.getShowCoin(coin);\n    },\n    // 饼图 数据（包含饼图 和 指标）\n    canvasPagesFilter: function canvasPagesFilter() {\n      var _this = this;\n\n      var arr = []; // 去除零资产\n\n      var list = this.canvasPages.filter(function (item) {\n        return parseFloat(item.spk) > 0;\n      }); // 排序\n\n      list.sort(this.compare('spk')); // 非0资产的币种少于6种时\n\n      if (list.length < 6) {\n        list.forEach(function (item, index) {\n          arr.push(_objectSpread(_objectSpread({}, item), {}, {\n            color: _this.colors[index]\n          }));\n        }); // 非0资产的币种多于等于6种时\n      } else if (list.length >= 6) {\n        var evenSum = 0; // 选出前五个\n\n        list.forEach(function (item, index) {\n          if (index < 5) {\n            arr.push(_objectSpread(_objectSpread({}, item), {}, {\n              color: _this.colors[index]\n            }));\n          } else {\n            evenSum += item.spk;\n          }\n        }); // 剩余币种归纳为其他\n\n        arr.push({\n          symbol: this.$t('assets.otcAccount.other'),\n          spk: evenSum,\n          color: this.colors[5]\n        });\n      }\n\n      return arr;\n    },\n    // 弹窗是否可点击\n    dialogConfirmDisabled: function dialogConfirmDisabled() {\n      if (this.dialogConfirmLoading) {\n        return false;\n      }\n\n      var flag = true;\n\n      if (parseFloat(this.transferValue) > 0 && !this.transferError) {\n        flag = false;\n      }\n\n      return flag;\n    },\n    transferError: function transferError() {\n      var flag = false; // 限制最大数量\n\n      if (this.transferSide === '1') {\n        if (parseFloat(this.transferValue) > parseFloat(this.transferData.exNormal)) {\n          flag = true;\n        }\n      } else if (this.transferSide === '2') {\n        if (parseFloat(this.transferValue) > parseFloat(this.transferData.otcNormal)) {\n          flag = true;\n        }\n      }\n\n      return flag;\n    },\n    transferData: function transferData() {\n      var coin = '',\n          exNormal = '--',\n          otcNormal = '--';\n\n      if (this.transferObj) {\n        coin = this.transferObj.coinSymbol;\n        var coinList = this.market.coinList;\n        var fix = coinList[coin] && coinList[coin].showPrecision || 0; // 现货可用\n\n        if (!Number.isNaN(parseFloat(fixD(this.transferObj.exchangeNormal, fix)))) {\n          exNormal = fixD(this.transferObj.exchangeNormal, fix);\n        } // 场外可用\n\n\n        if (!Number.isNaN(parseFloat(fixD(this.transferObj.normal, fix)))) {\n          otcNormal = fixD(this.transferObj.normal, fix);\n        }\n      }\n\n      return {\n        coin: coin,\n        exNormal: exNormal,\n        otcNormal: otcNormal\n      };\n    },\n    // 表格title\n    columns: function columns() {\n      return [{\n        title: this.$t('assets.otcAccount.coin'),\n        width: '20%'\n      }, // 币种\n      {\n        title: this.$t('assets.otcAccount.Available'),\n        width: '30%'\n      }, // 可用\n      {\n        title: this.$t('assets.otcAccount.freeze'),\n        width: '30%'\n      }, // 冻结\n      {\n        title: this.$t('assets.otcAccount.options'),\n        width: '20%'\n      } // 操作\n      ];\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    // 资金列表展示到页面数据\n    dataListFilter: function dataListFilter() {\n      var _this2 = this;\n\n      // 隐藏零资产功能过滤数据\n      var list = [];\n\n      if (this.switchFlag) {\n        this.dataList.forEach(function (item) {\n          if (parseFloat(item.btcValuation) >= 0.0001) {\n            list.push(item);\n          }\n        });\n      } else {\n        list = this.dataList;\n      } // 搜索框功能过滤数据\n\n\n      var newList = [];\n      list.forEach(function (item) {\n        if (item.data[0][1].text.toUpperCase().indexOf(_this2.findValue.toUpperCase()) !== -1) {\n          newList.push(item);\n        }\n      });\n      return newList;\n    }\n  },\n  watch: {\n    market: function market(v) {\n      if (v) {\n        this.sendOtcAxios();\n      }\n    },\n    transferValue: function transferValue(v) {\n      var coinList = this.market.coinList;\n      var coin = this.transferData.coin;\n      var fix = coinList[coin] && coinList[coin].showPrecision || 0; // 限制精度和不非数字字符\n\n      this.transferValue = fixInput(v, fix);\n    },\n    canvasPagesFilter: function canvasPagesFilter(v) {\n      if (v.length === 0) {\n        this.canvasInit();\n      } else {\n        this.canvasMap();\n      }\n    }\n  },\n  methods: {\n    getShowCoin: function getShowCoin(v) {\n      var str = v;\n\n      if (this.market && this.market.coinList) {\n        str = getCoinShowName(v, this.market.coinList);\n      }\n\n      return str;\n    },\n    init: function init() {\n      if (myStorage.get('assetsSwitch')) {\n        this.switchFlag = myStorage.get('assetsSwitch');\n      }\n\n      if (this.market) {\n        this.sendOtcAxios();\n      }\n\n      this.canvasInit();\n    },\n    compare: function compare(property) {\n      return function fn(a, b) {\n        var value1 = a[property];\n        var value2 = b[property];\n        return value2 - value1;\n      };\n    },\n    // 全部划转\n    allTransfer: function allTransfer() {\n      if (this.transferSide === '1') {\n        if (this.transferData.exNormal === '--') {\n          return;\n        }\n\n        this.transferValue = this.transferData.exNormal;\n      } else if (this.transferSide === '2') {\n        if (this.transferData.exNormal === '--') {\n          return;\n        }\n\n        this.transferValue = this.transferData.otcNormal;\n      }\n    },\n    // 修改划转方向\n    setTransferSide: function setTransferSide() {\n      if (this.transferSide === '1') {\n        this.transferSide = '2';\n      } else if (this.transferSide === '2') {\n        this.transferSide = '1';\n      }\n\n      this.transferValue = ''; // 重置划转数量\n    },\n    inputLineChange: function inputLineChange(value, name) {\n      this[name] = value;\n    },\n    dialogClose: function dialogClose() {\n      this.transferSide = '1'; // 重置划转方向\n\n      this.transferValue = ''; // 重置划转数量\n\n      this.transferObj = null; // 重置划转对象\n\n      this.dialogFlag = false; // 关闭弹窗\n    },\n    dialogConfirm: function dialogConfirm() {\n      var _this3 = this;\n\n      this.dialogConfirmLoading = true;\n      this.axios({\n        url: 'finance/otc_transfer',\n        params: {\n          fromAccount: this.transferSide === '1' ? '1' : '2',\n          toAccount: this.transferSide === '1' ? '2' : '1',\n          amount: this.transferValue,\n          coinSymbol: this.transferData.coin\n        },\n        method: 'post'\n      }).then(function (data) {\n        _this3.dialogConfirmLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n\n          _this3.transferSide = '1'; // 重置划转方向\n\n          _this3.transferValue = ''; // 重置划转数量\n\n          _this3.transferObj = null; // 重置划转对象\n\n          _this3.dialogFlag = false;\n          _this3.tabelLoading = true;\n\n          _this3.sendOtcAxios(); // 重新获取数据\n\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 获取列表\n    sendOtcAxios: function sendOtcAxios() {\n      var _this4 = this;\n\n      this.axios({\n        url: 'finance/v4/otc_account_list'\n      }).then(function (data) {\n        _this4.tabelLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this4.setData(data.data);\n        } else {\n          _this4.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 处理列表数据\n    setData: function setData(_ref) {\n      var _this5 = this;\n\n      var totalBalance = _ref.totalBalance,\n          totalBalanceSymbol = _ref.totalBalanceSymbol,\n          allCoinMap = _ref.allCoinMap;\n      var _this$market = this.market,\n          coinList = _this$market.coinList,\n          rate = _this$market.rate;\n      var FFix = coinList[totalBalanceSymbol] && coinList[totalBalanceSymbol].showPrecision || 0;\n      this.totalBalance = fixD(totalBalance, FFix); // 折合资产\n\n      this.totalBalanceSymbol = totalBalanceSymbol; // 折合币种\n\n      this.totalRate = fixRate(totalBalance, rate, totalBalanceSymbol); // 折合法币\n\n      var btcFix = coinList[totalBalanceSymbol] && coinList[totalBalanceSymbol].showPrecision || 0;\n      var list = [];\n      var canvasList = [];\n      allCoinMap.forEach(function (item) {\n        canvasList.push({\n          symbol: item.coinSymbol,\n          spk: item.btcValuation / totalBalance\n        });\n        var fix = coinList[item.coinSymbol] && coinList[item.coinSymbol].showPrecision || 0;\n        var coinImg = defaultIcon;\n\n        if (coinList[item.coinSymbol] && coinList[item.coinSymbol].icon.length) {\n          coinImg = coinList[item.coinSymbol].icon;\n        }\n\n        list.push({\n          id: JSON.stringify(item),\n          btcValuation: fixD(item.btcValuation, btcFix),\n          data: [[{\n            type: 'icon',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            iconSvg: \"<div class=\\\"coinIcon\\\"><img src=\\\"\".concat(coinImg, \"\\\"/></div>\"),\n            eventType: 'goTradeIn',\n            classes: ['coinBox']\n          }, {\n            text: getCoinShowName(item.coinSymbol, coinList)\n          }], fixD(item.normal, fix), fixD(item.lock, fix), [{\n            type: 'button',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            text: _this5.$t('assets.otcAccount.optionCapitalTransfer'),\n            // 资金划转\n            eventType: 'transfer'\n          }]]\n        });\n      });\n      this.canvasPages = canvasList;\n      this.dataList = list;\n    },\n    canvasMap: function canvasMap() {\n      var ctx = this.$refs.canvas.getContext('2d');\n      this.$refs.canvas.width = 100;\n      this.$refs.canvas.height = 100;\n      var start = 0;\n      this.canvasPagesFilter.forEach(function (item) {\n        var spk = start + item.spk * 2;\n\n        if (start >= 2) {\n          return;\n        } // 防止 2-xx的值\n\n\n        if (spk > 2) {\n          spk = 2;\n        } // 防止 1.x - 2.x的值\n\n\n        ctx.beginPath();\n        ctx.moveTo(50, 50);\n        ctx.fillStyle = item.color;\n        ctx.arc(50, 50, 50, Math.PI * start, Math.PI * spk);\n        ctx.closePath();\n        ctx.fill();\n        start = spk;\n      });\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#4a3dd8';\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    },\n    // canvas初始化\n    canvasInit: function canvasInit() {\n      var ctx = this.$refs.canvas.getContext('2d');\n      this.$refs.canvas.width = 100;\n      this.$refs.canvas.height = 100;\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#e0e0e0';\n      ctx.arc(50, 50, 50, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#4a3dd8';\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    },\n    // 隐藏零资产\n    findChanges: function findChanges(v) {\n      this.findValue = v;\n    },\n    switchChange: function switchChange() {\n      this.switchFlag = !this.switchFlag;\n      myStorage.set('assetsSwitch', this.switchFlag);\n    },\n    tableClick: function tableClick(type, data) {\n      if (type === 'transfer') {\n        this.transferObj = JSON.parse(data);\n        this.dialogFlag = true;\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/otcAccount/otcAccount.js"],"names":["myStorage","fixD","fixRate","fixInput","colorMap","imgMap","getCoinShowName","defaultIcon","f_1","name","data","otcHeader","zc_otc","transferObj","transferSide","dialogConfirmLoading","dialogFlag","transferValue","tabelLoading","dataList","totalBalance","totalBalanceSymbol","totalRate","canvasPages","switchFlag","findValue","colors","computed","isCoOpen","base","$store","state","baseData","publicInfo","switch","indep_co_switch","side","ex","$t","otc","from","to","transferWarningText","text","transferData","coin","exNormal","otcNormal","num","getShowCoin","canvasPagesFilter","arr","list","filter","item","parseFloat","spk","sort","compare","length","forEach","index","push","color","evenSum","symbol","dialogConfirmDisabled","flag","transferError","coinSymbol","coinList","market","fix","showPrecision","Number","isNaN","exchangeNormal","normal","columns","title","width","dataListFilter","btcValuation","newList","toUpperCase","indexOf","watch","v","sendOtcAxios","canvasInit","canvasMap","methods","str","init","get","property","fn","a","b","value1","value2","allTransfer","setTransferSide","inputLineChange","value","dialogClose","dialogConfirm","axios","url","params","fromAccount","toAccount","amount","method","then","code","toString","$bus","$emit","msg","type","setData","allCoinMap","rate","FFix","btcFix","canvasList","coinImg","icon","id","JSON","stringify","iconSvg","eventType","classes","lock","ctx","$refs","canvas","getContext","height","start","beginPath","moveTo","fillStyle","arc","Math","PI","closePath","fill","findChanges","switchChange","set","tableClick","parse"],"mappings":"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","sourcesContent":["import {\r\n  myStorage, fixD, fixRate, fixInput, colorMap, imgMap,\r\n  getCoinShowName,\r\n} from '@/utils';\r\n\r\nconst defaultIcon = imgMap.f_1;\r\n\r\nexport default {\r\n  name: 'page-otcAccount',\r\n  data() {\r\n    return {\r\n      otcHeader: `background: url(${imgMap.zc_otc})`,\r\n      imgMap,\r\n      colorMap,\r\n      transferObj: null, // 当前划转币种的信息\r\n      transferSide: '1', // 划转方向 1 为从现货到场外  2 为场外到现货\r\n      dialogConfirmLoading: false, // 弹窗的确认按钮loading\r\n      dialogFlag: false, // 对话框\r\n      transferValue: '', // 划转数量input\r\n      tabelLoading: true, // 表格 loading\r\n      dataList: [], // 表格 数据\r\n      totalBalance: '--', // 资产折合\r\n      totalBalanceSymbol: '', // 资产折合币种\r\n      totalRate: '--', // 资产折合汇率\r\n      canvasPages: [], // canvas\r\n      switchFlag: false, // 是否隐藏零资产\r\n      findValue: '', // 搜索币种\r\n      colors: [\r\n        'rgba(255, 255, 255, 1)',\r\n        'rgba(255, 255, 255, 0.8)',\r\n        'rgba(255, 255, 255, 0.6)',\r\n        'rgba(255, 255, 255, 0.4)',\r\n        'rgba(255, 255, 255, 0.25)',\r\n        'rgba(255, 255, 255, 0.1)',\r\n      ],\r\n    };\r\n  },\r\n  computed: {\r\n    isCoOpen() {\r\n      const base = this.$store.state.baseData.publicInfo;\r\n      if (base && base.switch && base.switch.indep_co_switch === '1') {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    side() {\r\n      const ex = this.isCoOpen ? this.$t('assets.index.coExchangeAccount') : this.$t('assets.index.exchangeAccount');\r\n      const otc = this.$t('assets.otcAccount.otcAccount');\r\n      let from = '';\r\n      let to = '';\r\n      if (this.transferSide === '1') {\r\n        from = ex;\r\n        to = otc;\r\n      } else {\r\n        from = otc;\r\n        to = ex;\r\n      }\r\n      return {\r\n        from,\r\n        to,\r\n      };\r\n    },\r\n    // input框警示文案\r\n    transferWarningText() {\r\n      const text = this.$t('assets.otcAccount.can'); // 可转\r\n      const { coin, exNormal, otcNormal } = this.transferData;\r\n      const num = this.transferSide === '1' ? exNormal : otcNormal;\r\n      return text + num + this.getShowCoin(coin);\r\n    },\r\n    // 饼图 数据（包含饼图 和 指标）\r\n    canvasPagesFilter() {\r\n      const arr = [];\r\n      // 去除零资产\r\n      const list = this.canvasPages.filter((item) => parseFloat(item.spk) > 0);\r\n      // 排序\r\n      list.sort(this.compare('spk'));\r\n      // 非0资产的币种少于6种时\r\n      if (list.length < 6) {\r\n        list.forEach((item, index) => {\r\n          arr.push({\r\n            ...item,\r\n            color: this.colors[index],\r\n          });\r\n        });\r\n      // 非0资产的币种多于等于6种时\r\n      } else if (list.length >= 6) {\r\n        let evenSum = 0;\r\n        // 选出前五个\r\n        list.forEach((item, index) => {\r\n          if (index < 5) {\r\n            arr.push({\r\n              ...item,\r\n              color: this.colors[index],\r\n            });\r\n          } else {\r\n            evenSum += item.spk;\r\n          }\r\n        });\r\n        // 剩余币种归纳为其他\r\n        arr.push({\r\n          symbol: this.$t('assets.otcAccount.other'),\r\n          spk: evenSum,\r\n          color: this.colors[5],\r\n        });\r\n      }\r\n      return arr;\r\n    },\r\n    // 弹窗是否可点击\r\n    dialogConfirmDisabled() {\r\n      if (this.dialogConfirmLoading) { return false; }\r\n      let flag = true;\r\n      if (parseFloat(this.transferValue) > 0 && !this.transferError) {\r\n        flag = false;\r\n      }\r\n      return flag;\r\n    },\r\n    transferError() {\r\n      let flag = false;\r\n      // 限制最大数量\r\n      if (this.transferSide === '1') {\r\n        if (parseFloat(this.transferValue) > parseFloat(this.transferData.exNormal)) {\r\n          flag = true;\r\n        }\r\n      } else if (this.transferSide === '2') {\r\n        if (parseFloat(this.transferValue) > parseFloat(this.transferData.otcNormal)) {\r\n          flag = true;\r\n        }\r\n      }\r\n      return flag;\r\n    },\r\n    transferData() {\r\n      let [coin, exNormal, otcNormal] = ['', '--', '--'];\r\n      if (this.transferObj) {\r\n        coin = this.transferObj.coinSymbol;\r\n        const { coinList } = this.market;\r\n        const fix = (coinList[coin] && coinList[coin].showPrecision) || 0;\r\n        // 现货可用\r\n        if (!Number.isNaN(parseFloat(fixD(this.transferObj.exchangeNormal, fix)))) {\r\n          exNormal = fixD(this.transferObj.exchangeNormal, fix);\r\n        }\r\n        // 场外可用\r\n        if (!Number.isNaN(parseFloat(fixD(this.transferObj.normal, fix)))) {\r\n          otcNormal = fixD(this.transferObj.normal, fix);\r\n        }\r\n      }\r\n      return {\r\n        coin,\r\n        exNormal,\r\n        otcNormal,\r\n      };\r\n    },\r\n    // 表格title\r\n    columns() {\r\n      return [\r\n        { title: this.$t('assets.otcAccount.coin'), width: '20%' }, // 币种\r\n        { title: this.$t('assets.otcAccount.Available'), width: '30%' }, // 可用\r\n        { title: this.$t('assets.otcAccount.freeze'), width: '30%' }, // 冻结\r\n        { title: this.$t('assets.otcAccount.options'), width: '20%' }, // 操作\r\n      ];\r\n    },\r\n    market() { return this.$store.state.baseData.market; },\r\n    // 资金列表展示到页面数据\r\n    dataListFilter() {\r\n      // 隐藏零资产功能过滤数据\r\n      let list = [];\r\n      if (this.switchFlag) {\r\n        this.dataList.forEach((item) => {\r\n          if (parseFloat(item.btcValuation) >= 0.0001) {\r\n            list.push(item);\r\n          }\r\n        });\r\n      } else {\r\n        list = this.dataList;\r\n      }\r\n      // 搜索框功能过滤数据\r\n      const newList = [];\r\n      list.forEach((item) => {\r\n        if (item.data[0][1].text.toUpperCase().indexOf(this.findValue.toUpperCase()) !== -1) {\r\n          newList.push(item);\r\n        }\r\n      });\r\n      return newList;\r\n    },\r\n  },\r\n  watch: {\r\n    market(v) { if (v) { this.sendOtcAxios(); } },\r\n    transferValue(v) {\r\n      const { coinList } = this.market;\r\n      const { coin } = this.transferData;\r\n      const fix = (coinList[coin] && coinList[coin].showPrecision) || 0;\r\n      // 限制精度和不非数字字符\r\n      this.transferValue = fixInput(v, fix);\r\n    },\r\n    canvasPagesFilter(v) {\r\n      if (v.length === 0) {\r\n        this.canvasInit();\r\n      } else {\r\n        this.canvasMap();\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    getShowCoin(v) {\r\n      let str = v;\r\n      if (this.market && this.market.coinList) {\r\n        str = getCoinShowName(v, this.market.coinList);\r\n      }\r\n      return str;\r\n    },\r\n    init() {\r\n      if (myStorage.get('assetsSwitch')) {\r\n        this.switchFlag = myStorage.get('assetsSwitch');\r\n      }\r\n      if (this.market) { this.sendOtcAxios(); }\r\n      this.canvasInit();\r\n    },\r\n    compare(property) {\r\n      return function fn(a, b) {\r\n        const value1 = a[property];\r\n        const value2 = b[property];\r\n        return value2 - value1;\r\n      };\r\n    },\r\n    // 全部划转\r\n    allTransfer() {\r\n      if (this.transferSide === '1') {\r\n        if (this.transferData.exNormal === '--') { return; }\r\n        this.transferValue = this.transferData.exNormal;\r\n      } else if (this.transferSide === '2') {\r\n        if (this.transferData.exNormal === '--') { return; }\r\n        this.transferValue = this.transferData.otcNormal;\r\n      }\r\n    },\r\n    // 修改划转方向\r\n    setTransferSide() {\r\n      if (this.transferSide === '1') { this.transferSide = '2'; } else if (this.transferSide === '2') { this.transferSide = '1'; }\r\n      this.transferValue = ''; // 重置划转数量\r\n    },\r\n    inputLineChange(value, name) {\r\n      this[name] = value;\r\n    },\r\n    dialogClose() {\r\n      this.transferSide = '1'; // 重置划转方向\r\n      this.transferValue = ''; // 重置划转数量\r\n      this.transferObj = null; // 重置划转对象\r\n      this.dialogFlag = false; // 关闭弹窗\r\n    },\r\n    dialogConfirm() {\r\n      this.dialogConfirmLoading = true;\r\n      this.axios({\r\n        url: 'finance/otc_transfer',\r\n        params: {\r\n          fromAccount: this.transferSide === '1' ? '1' : '2',\r\n          toAccount: this.transferSide === '1' ? '2' : '1',\r\n          amount: this.transferValue,\r\n          coinSymbol: this.transferData.coin,\r\n        },\r\n        method: 'post',\r\n      }).then((data) => {\r\n        this.dialogConfirmLoading = false;\r\n        if (data.code.toString() === '0') {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'success' });\r\n          this.transferSide = '1'; // 重置划转方向\r\n          this.transferValue = ''; // 重置划转数量\r\n          this.transferObj = null; // 重置划转对象\r\n          this.dialogFlag = false;\r\n          this.tabelLoading = true;\r\n          this.sendOtcAxios(); // 重新获取数据\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    // 获取列表\r\n    sendOtcAxios() {\r\n      this.axios({\r\n        url: 'finance/v4/otc_account_list',\r\n      }).then((data) => {\r\n        this.tabelLoading = false;\r\n        if (data.code.toString() === '0') {\r\n          this.setData(data.data);\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    // 处理列表数据\r\n    setData({ totalBalance, totalBalanceSymbol, allCoinMap }) {\r\n      const { coinList, rate } = this.market;\r\n      const FFix = (coinList[totalBalanceSymbol]\r\n        && coinList[totalBalanceSymbol].showPrecision) || 0;\r\n      this.totalBalance = fixD(totalBalance, FFix); // 折合资产\r\n      this.totalBalanceSymbol = totalBalanceSymbol; // 折合币种\r\n      this.totalRate = fixRate(totalBalance, rate, totalBalanceSymbol); // 折合法币\r\n      const btcFix = (coinList[totalBalanceSymbol]\r\n        && coinList[totalBalanceSymbol].showPrecision) || 0;\r\n      const list = [];\r\n      const canvasList = [];\r\n      allCoinMap.forEach((item) => {\r\n        canvasList.push({\r\n          symbol: item.coinSymbol,\r\n          spk: item.btcValuation / totalBalance,\r\n        });\r\n        const fix = (coinList[item.coinSymbol] && coinList[item.coinSymbol].showPrecision) || 0;\r\n        let coinImg = defaultIcon;\r\n        if (coinList[item.coinSymbol] && coinList[item.coinSymbol].icon.length) {\r\n          coinImg = coinList[item.coinSymbol].icon;\r\n        }\r\n        list.push({\r\n          id: JSON.stringify(item),\r\n          btcValuation: fixD(item.btcValuation, btcFix),\r\n          data: [\r\n            [\r\n              {\r\n                type: 'icon', // 'link' ' button' ,'html', 'label', 'icon' ‘str’\r\n                iconSvg: `<div class=\"coinIcon\"><img src=\"${coinImg}\"/></div>`,\r\n                eventType: 'goTradeIn',\r\n                classes: ['coinBox'],\r\n              },\r\n              {\r\n                text: getCoinShowName(item.coinSymbol, coinList),\r\n              },\r\n            ],\r\n            fixD(item.normal, fix),\r\n            fixD(item.lock, fix),\r\n            [{\r\n              type: 'button', // 'link' ' button' ,'html', 'label', 'icon' ‘str’\r\n              text: this.$t('assets.otcAccount.optionCapitalTransfer'), // 资金划转\r\n              eventType: 'transfer',\r\n            }],\r\n          ],\r\n        });\r\n      });\r\n      this.canvasPages = canvasList;\r\n      this.dataList = list;\r\n    },\r\n    canvasMap() {\r\n      const ctx = this.$refs.canvas.getContext('2d');\r\n      this.$refs.canvas.width = 100;\r\n      this.$refs.canvas.height = 100;\r\n      let start = 0;\r\n      this.canvasPagesFilter.forEach((item) => {\r\n        let spk = start + item.spk * 2;\r\n        if (start >= 2) { return; } // 防止 2-xx的值\r\n        if (spk > 2) { spk = 2; } // 防止 1.x - 2.x的值\r\n        ctx.beginPath();\r\n        ctx.moveTo(50, 50);\r\n        ctx.fillStyle = item.color;\r\n        ctx.arc(50, 50, 50, Math.PI * start, Math.PI * spk);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        start = spk;\r\n      });\r\n      ctx.beginPath();\r\n      ctx.moveTo(50, 50);\r\n      ctx.fillStyle = '#4a3dd8';\r\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    },\r\n    // canvas初始化\r\n    canvasInit() {\r\n      const ctx = this.$refs.canvas.getContext('2d');\r\n      this.$refs.canvas.width = 100;\r\n      this.$refs.canvas.height = 100;\r\n      ctx.beginPath();\r\n      ctx.moveTo(50, 50);\r\n      ctx.fillStyle = '#e0e0e0';\r\n      ctx.arc(50, 50, 50, 0, Math.PI * 2);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.moveTo(50, 50);\r\n      ctx.fillStyle = '#4a3dd8';\r\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    },\r\n    // 隐藏零资产\r\n    findChanges(v) {\r\n      this.findValue = v;\r\n    },\r\n    switchChange() {\r\n      this.switchFlag = !this.switchFlag;\r\n      myStorage.set('assetsSwitch', this.switchFlag);\r\n    },\r\n    tableClick(type, data) {\r\n      if (type === 'transfer') {\r\n        this.transferObj = JSON.parse(data);\r\n        this.dialogFlag = true;\r\n      }\r\n    },\r\n  },\r\n};\r\n"]}]}