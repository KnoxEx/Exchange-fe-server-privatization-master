{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui/PC/common-mixin/modules/coTrade/tradingView/tradingView.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui/PC/common-mixin/modules/coTrade/tradingView/tradingView.js","mtime":1623835967000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.reflect.construct\";\nimport _classCallCheck from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _inherits from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _slicedToArray from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.regexp.split\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { myStorage, getCookie, colorMap, getHex, imgMap, logImg, getScript, nul } from '@/utils';\nexport default {\n  name: 'tradingView',\n  data: function data() {\n    return {\n      TvBoxHeight: '472px',\n      // 颜色主题\n      theme: 'theme_default',\n      // 图标类型 TV：1 Echart: 2\n      chartType: 1,\n      MywebSocket: null,\n      lastTimeS: myStorage.get('lastTimeS'),\n      language: getCookie('lan') ? getCookie('lan').split('_')[0] : '',\n      lTime: null,\n      fTime: 0,\n      isCreateWidget: false,\n      isshowLoading: true,\n      maskBg: true,\n      chartTypeHove: null,\n      loadingEchart: false,\n      isfullTv: false,\n      isfullTvsd: null,\n      echartLoaded: false,\n      // 市场横向滚动参数\n      slidePosition: 0,\n      maxPosition: 0,\n      lanArry: ['ar', 'zh_TW', 'zh', 'cs', 'da_DK', 'nl_NL', 'en', 'et_EE', 'fr', 'de', 'el', 'he_IL', 'hu_HU', 'id_ID', 'it', 'ja', 'ko', 'ms_MY', 'no', 'fa', 'pl', 'pt', 'ro', 'ru', 'sk_SK', 'es', 'sv', 'th', 'tr', 'vi'],\n      // 合约全部币对\n      coSymbolAll: null,\n      // 是否是移动端\n      isMobile: window.isMobile,\n      // 隐藏K线工具选项\n      disabled_features_arr: ['header_symbol_search', 'timeframes_toolbar', 'volume_force_overlay', 'header_saveload', 'header_resolutions', 'header_compare', 'header_screenshot', 'header_undo_redo', 'adaptive_logo', 'header_fullscreen_button', 'timezone_menu', 'scales_context_menu', 'legend_context_menu', 'symbol_search_hot_key' // 'header_settings',\n      // 'header_widget',\n      // 'use_localstorage_for_settings',\n      // 'show_chart_property_page',\n      // 'timeframes_toolbar',\n      // 'symbol_info',\n      // 'header_widget_dom_node',\n      // 'header_indicators',\n      // 'header_widget',\n      // 'pane_context_menu',\n      // 'header_fullscreen_button',\n      // 'display_market_status',\n      // 'header_chart_type',\n      ]\n    };\n  },\n  computed: {\n    // 当前合约币对\n    symbolCurrent: function symbolCurrent() {\n      return this.$store.state.future.coTypeSymbol;\n    },\n    // 数量单位类型Number（1标的货币 2张）\n    coUnitType: function coUnitType() {\n      return this.$store.state.future.coUnitType;\n    },\n    // 当前合约面值\n    multiplier: function multiplier() {\n      return Number(this.$store.state.future.multiplier);\n    },\n    // 当前币对价格精度\n    pricefix: function pricefix() {\n      return this.$store.state.future.pricefix;\n    },\n    klineLogo: function klineLogo() {\n      return imgMap.tradingViewLogo || '';\n    },\n    templateLayoutType: function templateLayoutType() {\n      return this.$store.state.baseData.templateLayoutType;\n    },\n    baseTimeArry: function baseTimeArry() {\n      try {\n        return this.$store.state.baseData.market.klineScale;\n      } catch (w) {\n        return ['1min', '5min', '15min', '30min', '60min', '4h', '1day', '1week', '1month'];\n      }\n    },\n    timeArry: function timeArry() {\n      var a = [];\n\n      if (this.baseTimeArry.length) {\n        this.baseTimeArry.forEach(function (it) {\n          var t = [];\n\n          if (it.indexOf('min') > -1) {\n            t.push(it, parseFloat(it));\n          } else if (it.toLowerCase().indexOf('h') > -1 && it.indexOf('month') < 0) {\n            t.push(it, parseFloat(it) * 60);\n          } else if (it.indexOf('day') > -1) {\n            t.push(it, parseFloat(it) * 24 * 60);\n          } else if (it.indexOf('week') > -1) {\n            t.push(it, parseFloat(it) * 7 * 24 * 60);\n          } else if (it.indexOf('month') > -1) {\n            t.push(it, parseFloat(it) * 30 * 24 * 60);\n          }\n\n          a.push(t);\n        });\n      }\n\n      return a;\n    },\n    // 币币and杠杆 全部货币对\n    symbolAll: function symbolAll() {\n      return this.$store.state.baseData.symbolAll;\n    },\n    themeTV: function themeTV() {\n      var theme = getCookie('cusSkin') || getCookie('defSkin') || '1';\n      var stheme = theme.toString() === '1' ? 'Dark' : 'Light';\n      return stheme;\n    }\n  },\n  watch: {\n    symbolCurrent: function symbolCurrent(val, old) {\n      var _this = this;\n\n      if (val && old) {\n        if (this.chartType === 1) {\n          this.isshowLoading = true;\n        }\n\n        if (window.tvWidget) {\n          var arr = this.symbolCurrent.split('_');\n          var symbolCurrent = arr[1];\n\n          if (arr && arr.length) {\n            if (arr[0] !== 'e' && arr[0] !== 's') {\n              symbolCurrent = \"\".concat(arr[1], \"-\").concat(arr[0]);\n            }\n          }\n\n          window.tvWidget.setSymbol(symbolCurrent, this.getTimeMin(true, this.lastTimeS), function () {\n            _this.widget.chart().executeActionById('chartReset');\n          });\n        }\n      }\n    },\n    coUnitType: function coUnitType(val, old) {\n      var _this2 = this;\n\n      if (val && old) {\n        if (this.chartType === 1) {\n          this.isshowLoading = true;\n        }\n\n        if (this.lastTimeS === 'Line') {\n          this.lastTimeS = '1min';\n        }\n\n        if (window.tvWidget) {\n          this.widget.setLanguage(this.language);\n          setTimeout(function () {\n            _this2.creatMA();\n          }, 1000);\n        }\n      }\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this3 = this;\n\n      // 监听TV 是否是全屏状态\n      document.removeEventListener('fullscreenchange', this.quitfullTv);\n      document.addEventListener('fullscreenchange', this.quitfullTv);\n\n      if (this.lanArry.indexOf(this.language) <= -1) {\n        this.language = 'en';\n      }\n\n      if (getCookie('lan') === 'el_GR') {\n        this.language = 'zh_TW';\n      }\n\n      if (!myStorage.get('lastTimeS')) {\n        myStorage.set('lastTimeS', '1day');\n        this.lastTimeS = '1day';\n      } // 监听 WebSocket 链接成功\n\n\n      this.$bus.$on('WEBSOCKET_ON_OPEN', function (val) {\n        _this3.MywebSocket = JSON.parse(JSON.stringify(val));\n\n        if (_this3.MywebSocket) {\n          _this3.isCreateWidget = false;\n\n          _this3.initTradingView();\n        }\n      }); // 隐藏loading\n\n      this.$bus.$on('HIDE_LOADING', function () {\n        _this3.isshowLoading = false;\n      }); // 市场 个数的超出宽度\n\n      this.maxPosition = this.$refs.topMenuBox.offsetWidth - this.$refs.topMenuBar.offsetWidth;\n    },\n    enter: function enter(index) {\n      this.chartTypeHove = index;\n    },\n    leave: function leave() {\n      this.chartTypeHove = null;\n    },\n    chartTypeShow: function chartTypeShow(num) {\n      if (this.chartType === num || this.chartTypeHove === num) {\n        return true;\n      }\n\n      return false;\n    },\n    initTradingView: function initTradingView() {\n      this.createWidget();\n    },\n    // tadingView 生命周期函数\n    udf_datafeed: function udf_datafeed() {\n      var self = this;\n      return {\n        onReady: function onReady(callback) {\n          var cnf = {\n            supported_resolutions: self.getTimeMin(false, 1),\n            // 数组\n            supports_group_request: false,\n            supports_marks: true,\n            supports_search: false,\n            supports_timescale_marks: false\n          };\n          setTimeout(function () {\n            callback(cnf);\n          }, 0);\n        },\n        // 切换币对后\n        resolveSymbol: function resolveSymbol(symbolName, onSymbolResolvedCallback) {\n          setTimeout(function () {\n            onSymbolResolvedCallback({\n              name: symbolName,\n              'exchange-traded': '',\n              'exchange-listed': '',\n              minmov: 1,\n              minmov2: 0,\n              pointvalue: 1,\n              session: '0000-2400:1234567',\n              has_intraday: true,\n              has_no_volume: false,\n              volume_precision: 1,\n              description: symbolName.toUpperCase(),\n              type: 'bitcoin',\n              supported_resolutions: self.getTimeMin(false, 1),\n              pricescale: self.fixDepthNumber(),\n              ticker: symbolName.toUpperCase(),\n              timezone: window.jstz.determine().name()\n            });\n          }, 0);\n        },\n        // 获取深度数据（k线无需请求深度）\n        calculateHistoryDepth: function calculateHistoryDepth() {\n          return undefined;\n        },\n        // tradingview 获取历史数据\n        getBars: function getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest) {\n          if (firstDataRequest) {\n            self.lTime = false;\n          }\n\n          var lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'req',\n              symbol: self.symbolCurrent,\n              lastTimeS: lastTimeS,\n              lTime: self.lTime,\n              number: 50\n            });\n          }\n\n          self.$bus.$off('KLINE_DATA_REQ');\n          self.$bus.$on('KLINE_DATA_REQ', function (data) {\n            var wsData = JSON.parse(data);\n            self.fTime = 0;\n            var channelArr = wsData.channel.split('_');\n            var Ntime = channelArr[channelArr.length - 1];\n\n            var _wsData$channel$split = wsData.channel.split('_'),\n                _wsData$channel$split2 = _slicedToArray(_wsData$channel$split, 3),\n                type = _wsData$channel$split2[1],\n                symbol = _wsData$channel$split2[2];\n\n            var symbolType = \"\".concat(type, \"_\").concat(symbol);\n\n            if (symbolType === self.symbolCurrent && lastTimeS === Ntime) {\n              var klData = wsData.data;\n              var arrData = [];\n\n              if (klData && klData.length) {\n                klData.forEach(function (item) {\n                  arrData.push(self.setData(item));\n                });\n\n                if (firstDataRequest) {\n                  self.fTime = arrData[arrData.length - 1].time;\n                }\n\n                if (self.lTime === klData[0].id) {\n                  onHistoryCallback([], {\n                    noData: true\n                  });\n                  logImg({\n                    host: window.location.host,\n                    type: 'onHistoryCallback',\n                    path: window.location.href,\n                    ds: 'onHistoryCallback noDate',\n                    data: {\n                      symbol: self.symbolCurrent\n                    },\n                    t: new Date().getTime()\n                  });\n                } else {\n                  self.lTime = klData[0].id;\n                  onHistoryCallback(arrData);\n                }\n              } else {\n                if (self.secend < 3) {\n                  self.udf_datafeed().getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest);\n                  self.secend += 1;\n                  return;\n                }\n\n                if (!self.lTime) {\n                  logImg({\n                    host: window.location.host,\n                    type: 'tradingView',\n                    path: window.location.href,\n                    ds: 'first onHistoryCallback noData',\n                    data: data,\n                    t: new Date().getTime()\n                  });\n                }\n\n                onHistoryCallback([], {\n                  noData: true\n                });\n              }\n            }\n          });\n\n          if (!self.isCreateWidget) {\n            self.widget_onChartReady();\n            self.widget.chart().setChartType(1);\n          }\n        },\n        // tradingview 获取实时数据\n        subscribeBars: function subscribeBars(symbolInfo, resolution, onRealtimeCallback) {\n          self.isshowLoading = false;\n          self.maskBg = false;\n          var lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'sub',\n              symbol: self.symbolCurrent,\n              lastTimeS: lastTimeS\n            });\n          }\n\n          self.$bus.$off('KLINE_DATA_SUB');\n          self.$bus.$on('KLINE_DATA_SUB', function (data) {\n            var wsData = JSON.parse(data); // console.log('实时数据', wsData);\n\n            var channelArr = wsData.channel.split('_');\n            var Ntime = channelArr[channelArr.length - 1];\n\n            var _wsData$channel$split3 = wsData.channel.split('_'),\n                _wsData$channel$split4 = _slicedToArray(_wsData$channel$split3, 3),\n                type = _wsData$channel$split4[1],\n                symbol = _wsData$channel$split4[2];\n\n            var symbolType = \"\".concat(type, \"_\").concat(symbol);\n\n            if (wsData.tick && Ntime === lastTimeS && symbolType === self.symbolCurrent) {\n              var tickData = self.setData(wsData.tick);\n\n              if (self.fTime < tickData.time) {\n                onRealtimeCallback(tickData);\n              }\n            }\n          });\n        },\n        // tradingview 取消订阅上一 币对 / 刻度\n        unsubscribeBars: function unsubscribeBars(subscriberUID) {\n          var arr = subscriberUID.split('_');\n          var symbol = \"\".concat(arr[0], \"_\").concat(arr[1]);\n          self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n            type: 'unsub',\n            symbol: symbol.toLowerCase(),\n            lastTimeS: self.getTimeMin(true, parseFloat(arr[2]))\n          });\n        }\n      };\n    },\n    // 创建 TradingView\n    createWidget: function createWidget() {\n      var F = /*#__PURE__*/function (_window$TradingView$w) {\n        _inherits(F, _window$TradingView$w);\n\n        var _super = _createSuper(F);\n\n        function F() {\n          _classCallCheck(this, F);\n\n          return _super.apply(this, arguments);\n        }\n\n        return F;\n      }(window.TradingView.widget);\n\n      if (this.symbolCurrent) {\n        var symbolCurrent = this.symbolCurrent.split('_')[1];\n        window.tvWidget = new F({\n          debug: false,\n          autosize: true,\n          timezone: window.jstz.determine().name(),\n          symbol: symbolCurrent,\n          interval: this.getTimeMin(true, this.lastTimeS),\n          container_id: 'tv_chart_container',\n          // DOM id\n          datafeed: this.udf_datafeed(),\n          // 配置 生命周期\n          library_path: '/static/charting_library/',\n          // 静态文件路径\n          locale: this.language,\n          // 语言\n          disabled_features: this.disabled_features_arr,\n          enabled_features: [// 'study_templates',\n          'hide_left_toolbar_by_default'],\n          charts_storage_url: \"\".concat(window.location.protocol, \"//saveload.tradingview.com\"),\n          charts_storage_api_version: '1.1',\n          client_id: 'tradingview.com',\n          user_id: 'public_user',\n          toolbar_bg: getHex(colorMap['a-6-bg']),\n          // 工具栏底色\n          theme: this.themeTV,\n          studies_overrides: {\n            'volume.volume.color.0': getHex(colorMap['u-4-bg']),\n            'volume.volume.color.1': getHex(colorMap['u-1-bg']),\n            'volume.volume.transparency': 50\n          },\n          overrides: {\n            // k线的颜色\n            volumePaneSize: 'small',\n            // 成交量大小\n            'scalesProperties.fontSize': 12,\n            // 图标区域xy轴 字体大小\n            'scalesProperties.textColor': getHex(colorMap['b-3-cl']),\n            // 图标区域xy轴 文字颜色\n            'scalesProperties.lineColor': getHex(colorMap['a-3-bd']),\n            // 图标区域xy轴颜色\n            'paneProperties.background': getHex(colorMap['a-6-bg']),\n            // 图标区域 背景色\n            'paneProperties.vertGridProperties.color': getHex(colorMap['a-7-bg']),\n            // 图标区域 表格纵轴颜色\n            'paneProperties.horzGridProperties.color': getHex(colorMap['a-7-bg']),\n            // 图标区域 表格橫轴颜色\n            'paneProperties.crossHairProperties.color': getHex(colorMap['b-2-bg']),\n            // 图标区域 鼠标十字线颜色\n            'paneProperties.legendProperties.showLegend': true,\n            // 折叠信息\n            // 柱状图颜色设置\n            'mainSeriesProperties.candleStyle.upColor': getHex(colorMap['u-1-cl']),\n            'mainSeriesProperties.candleStyle.downColor': getHex(colorMap['u-4-cl']),\n            'mainSeriesProperties.candleStyle.drawWick': true,\n            'mainSeriesProperties.candleStyle.drawBorder': true,\n            'mainSeriesProperties.candleStyle.borderColor': '',\n            'mainSeriesProperties.candleStyle.borderUpColor': getHex(colorMap['u-1-cl']),\n            'mainSeriesProperties.candleStyle.borderDownColor': getHex(colorMap['u-4-cl']),\n            'mainSeriesProperties.candleStyle.wickUpColor': getHex(colorMap['u-1-cl']),\n            'mainSeriesProperties.candleStyle.wickDownColor': getHex(colorMap['u-4-cl']),\n            'mainSeriesProperties.candleStyle.barColorsOnPrevClose': !1,\n            // 分时图颜色设置\n            // 分时背景色渐变 上半部分\n            'mainSeriesProperties.areaStyle.color1': colorMap['a-15-bg'],\n            // 分时背景色渐变 下半部分\n            'mainSeriesProperties.areaStyle.color2': colorMap['a-17-bg'],\n            'mainSeriesProperties.areaStyle.linecolor': getHex(colorMap['a-12-bd']),\n            'mainSeriesProperties.areaStyle.linestyle': 0,\n            'mainSeriesProperties.areaStyle.linewidth': 2,\n            'mainSeriesProperties.areaStyle.priceSource': 'close'\n          }\n        });\n        this.widget = window.tvWidget;\n      }\n    },\n    // 格式化时间刻度\n    getTimeMin: function getTimeMin(only, type) {\n      if (only) {\n        var _t = null;\n\n        if (this.timeArry.length) {\n          this.timeArry.forEach(function (item) {\n            var s = item.indexOf(type);\n\n            if (s > -1) {\n              _t = s === 0 ? item[1] : item[0];\n            }\n          });\n        }\n\n        return _t;\n      }\n\n      var t = [];\n      this.timeArry.forEach(function (item) {\n        t.push(item[type]);\n      });\n      return t;\n    },\n    // 精度计算\n    fixDepthNumber: function fixDepthNumber() {\n      var b = Math.pow(10, this.pricefix);\n      return parseFloat(b.toString());\n    },\n    widget_onChartReady: function widget_onChartReady() {\n      var _this4 = this;\n\n      this.isCreateWidget = true;\n      this.creatMA(); // ===== 默认样式皮肤修改 =====\n\n      var style = document.createElement('style');\n      /* eslint-disable */\n\n      var clas = document.createTextNode(\".apply-common-tooltip,.wrap-1GG7GnNO- svg{fill:\" + colorMap[\"b-3-cl\"] + \"!important;color:\" + colorMap[\"b-3-cl\"] + \"!important;cursor: pointer;}.textColor .wrap-18oKCBRc- div,.wrap-18oKCBRc- .apply-common-tooltip:hover,.wrap-1GG7GnNO- svg:hover,.button-263WXsg--.isActive-2mI1-NUL- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-:hover{fill:\" + colorMap[\"a-1-cl\"] + \"!important;color:\" + colorMap[\"a-1-cl\"] + \"!important;}.container-3_8ayT2Q- .background-Q1Fcmxly-{fill: \" + colorMap[\"b-2-cl\"] + \"; stroke: \" + colorMap[\"b-2-cl\"] + \";}.container-3_8ayT2Q- .arrow-WcYWFXUn-, html.theme-dark .container-3_8ayT2Q- .arrow-WcYWFXUn-{stroke: \" + colorMap[\"b-1-cl\"] + \";}.feature-no-touch .container-3_8ayT2Q-:hover .background-Q1Fcmxly-{fill: \" + colorMap[\"a-1-cl\"] + \";stroke: \" + colorMap[\"a-1-cl\"] + \";}\");\n      /* eslint-enable */\n\n      style.append(clas);\n      this.widget.headerReady().then(function () {\n        _this4.widget.createButton().append(style);\n      });\n    },\n    creatMA: function creatMA() {\n      // ===== 创建移动均线 =====\n      this.widget.chart().createStudy('Moving Average', false, false, [5], null, {\n        'plot.color': '#F5CB89'\n      });\n      this.widget.chart().createStudy('Moving Average', false, false, [10], null, {\n        'plot.color': '#5FCFBF'\n      });\n      this.widget.chart().createStudy('Moving Average', false, false, [30], null, {\n        'plot.color': '#DD89F5'\n      });\n    },\n    setMAShow: function setMAShow() {\n      // ===== 显示移动均线 =====\n      var c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, true);\n      this.widget.chart().setEntityVisibility(c[1].id, true);\n      this.widget.chart().setEntityVisibility(c[2].id, true);\n    },\n    setMAHide: function setMAHide() {\n      // ===== 隐藏移动均线 =====\n      var c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, false);\n      this.widget.chart().setEntityVisibility(c[1].id, false);\n      this.widget.chart().setEntityVisibility(c[2].id, false);\n    },\n    timeClike: function timeClike(v) {\n      var _this5 = this;\n\n      if (v !== 'Line' && v !== '1min' && v !== this.lastTimeS) {\n        this.isshowLoading = true;\n      }\n\n      if (v !== this.lastTimeS) {\n        this.lastTimeS = v;\n\n        if (v === 'Line') {\n          myStorage.set('lastTimeS', '1min');\n        } else {\n          myStorage.set('lastTimeS', v);\n        }\n\n        this.$bus.$emit('LAST-TIMES', v);\n\n        if (this.isCreateWidget) {\n          var resolution = this.widget.chart().resolution();\n\n          if (v === 'Line') {\n            if (resolution !== '1') {\n              this.widget.chart().setResolution('1', function () {\n                _this5.widget.chart().setChartType(3); // 折线图\n\n              });\n            } else if (resolution === '1') {\n              this.widget.chart().setChartType(3);\n            }\n\n            this.setMAHide();\n          } else {\n            if (resolution === '1' && v === '1min') {\n              this.widget.chart().setChartType(1); // 蜡烛图\n            } else {\n              var timeS = this.getTimeMin(true, v);\n              this.widget.chart().setResolution(timeS.toString(), function () {\n                _this5.widget.chart().setChartType(1);\n\n                _this5.widget.chart().executeActionById('chartReset');\n              });\n            }\n\n            this.setMAShow();\n          }\n        }\n      }\n    },\n    // 格式化数据\n    setData: function setData(obj) {\n      var volume = obj.vol;\n\n      if (this.coUnitType === 1) {\n        volume = nul(obj.vol, this.multiplier);\n      }\n\n      return {\n        time: obj.id * 1000,\n        close: obj.close,\n        open: obj.open,\n        high: obj.high,\n        low: obj.low,\n        volume: volume\n      };\n    },\n    setChartType: function setChartType(type) {\n      var _this6 = this;\n\n      this.chartType = type;\n      setTimeout(function () {\n        var _this6$$refs = _this6.$refs,\n            _this6$$refs$topMenuB = _this6$$refs.topMenuBox,\n            topMenuBox = _this6$$refs$topMenuB === void 0 ? null : _this6$$refs$topMenuB,\n            _this6$$refs$topMenuB2 = _this6$$refs.topMenuBar,\n            topMenuBar = _this6$$refs$topMenuB2 === void 0 ? null : _this6$$refs$topMenuB2;\n        _this6.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n      }, 500);\n    },\n    switchChartType: function switchChartType(type) {\n      var _this7 = this;\n\n      if (type === 2) {\n        if (!window.echarts && !this.loadingEchart) {\n          this.loadingEchart = true;\n          getScript(\"\".concat(process.env.BASE_URL, \"static/js/echarts.min.js\")).then(function () {\n            _this7.loadingEchart = false;\n            _this7.isshowLoading = false;\n            _this7.echartLoaded = true;\n\n            _this7.setChartType(type);\n          });\n        } else {\n          this.setChartType(type);\n        }\n      } else {\n        this.setChartType(type);\n      }\n    },\n    quit: function quit(e) {\n      this.isfullTv = false;\n\n      if (this.isfullTv) {\n        var key = e.keyCode;\n\n        if (key === 27) {\n          this.isfullTv = false;\n        }\n      }\n    },\n    fullTv: function fullTv() {\n      if (!this.isfullTv) {\n        this.isfullTv = true;\n        var element = this.$refs.tv_chart_container;\n\n        if (element.requestFullscreen) {\n          element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n          element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n          element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n          element.msRequestFullscreen();\n        }\n      } else {\n        this.isfullTv = false;\n\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    },\n    quitfullTv: function quitfullTv() {\n      // 监听TV 是否是全屏状态\n      if (this.isfullTv) {\n        this.isfullTv = window.fullScreen || document.webkitIsFullScreen || document.msFullscreenElement;\n      }\n    },\n    // 设置时间刻度的滚动\n    slideMarket: function slideMarket(type) {\n      var position = parseFloat(this.slidePosition);\n\n      if (this.$refs.topMenuBar) {\n        if (type === 'left') {\n          position += this.$refs.topMenuBar.offsetWidth / 2;\n\n          if (position > 0) {\n            position = 0;\n          }\n        } else {\n          var _this$$refs = this.$refs,\n              _this$$refs$topMenuBo = _this$$refs.topMenuBox,\n              topMenuBox = _this$$refs$topMenuBo === void 0 ? null : _this$$refs$topMenuBo,\n              _this$$refs$topMenuBa = _this$$refs.topMenuBar,\n              topMenuBar = _this$$refs$topMenuBa === void 0 ? null : _this$$refs$topMenuBa;\n          this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n          position -= this.$refs.topMenuBar.offsetWidth / 2;\n\n          if (position < -this.maxPosition) {\n            position = -this.maxPosition;\n          }\n        }\n\n        this.slidePosition = \"\".concat(position, \"px\");\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/h/partTimeJob/BlockChain-ui/PC/common-mixin/modules/coTrade/tradingView/tradingView.js"],"names":["myStorage","getCookie","colorMap","getHex","imgMap","logImg","getScript","nul","name","data","TvBoxHeight","theme","chartType","MywebSocket","lastTimeS","get","language","split","lTime","fTime","isCreateWidget","isshowLoading","maskBg","chartTypeHove","loadingEchart","isfullTv","isfullTvsd","echartLoaded","slidePosition","maxPosition","lanArry","coSymbolAll","isMobile","window","disabled_features_arr","computed","symbolCurrent","$store","state","future","coTypeSymbol","coUnitType","multiplier","Number","pricefix","klineLogo","tradingViewLogo","templateLayoutType","baseData","baseTimeArry","market","klineScale","w","timeArry","a","length","forEach","it","t","indexOf","push","parseFloat","toLowerCase","symbolAll","themeTV","stheme","toString","watch","val","old","tvWidget","arr","setSymbol","getTimeMin","widget","chart","executeActionById","setLanguage","setTimeout","creatMA","methods","init","document","removeEventListener","quitfullTv","addEventListener","set","$bus","$on","JSON","parse","stringify","initTradingView","$refs","topMenuBox","offsetWidth","topMenuBar","enter","index","leave","chartTypeShow","num","createWidget","udf_datafeed","self","onReady","callback","cnf","supported_resolutions","supports_group_request","supports_marks","supports_search","supports_timescale_marks","resolveSymbol","symbolName","onSymbolResolvedCallback","minmov","minmov2","pointvalue","session","has_intraday","has_no_volume","volume_precision","description","toUpperCase","type","pricescale","fixDepthNumber","ticker","timezone","jstz","determine","calculateHistoryDepth","undefined","getBars","symbolInfo","resolution","from","to","onHistoryCallback","onErrorCallback","firstDataRequest","$emit","symbol","number","$off","wsData","channelArr","channel","Ntime","symbolType","klData","arrData","item","setData","time","id","noData","host","location","path","href","ds","Date","getTime","secend","widget_onChartReady","setChartType","subscribeBars","onRealtimeCallback","tick","tickData","unsubscribeBars","subscriberUID","F","TradingView","debug","autosize","interval","container_id","datafeed","library_path","locale","disabled_features","enabled_features","charts_storage_url","protocol","charts_storage_api_version","client_id","user_id","toolbar_bg","studies_overrides","overrides","volumePaneSize","only","s","b","style","createElement","clas","createTextNode","append","headerReady","then","createButton","createStudy","setMAShow","c","getAllStudies","setEntityVisibility","setMAHide","timeClike","v","setResolution","timeS","obj","volume","vol","close","open","high","low","switchChartType","echarts","process","env","BASE_URL","quit","e","key","keyCode","fullTv","element","tv_chart_container","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","fullScreen","webkitIsFullScreen","msFullscreenElement","slideMarket","position"],"mappings":";;;;;;;;;;;;;;;;AAAA,SACEA,SADF,EAEEC,SAFF,EAGEC,QAHF,EAIEC,MAJF,EAKEC,MALF,EAMEC,MANF,EAOEC,SAPF,EAQEC,GARF,QASO,SATP;AAWA,eAAe;AACbC,EAAAA,IAAI,EAAE,aADO;AAEbC,EAAAA,IAFa,kBAEN;AACL,WAAO;AACLC,MAAAA,WAAW,EAAE,OADR;AAEL;AACAC,MAAAA,KAAK,EAAE,eAHF;AAIL;AACAC,MAAAA,SAAS,EAAE,CALN;AAMLC,MAAAA,WAAW,EAAE,IANR;AAOLC,MAAAA,SAAS,EAAEd,SAAS,CAACe,GAAV,CAAc,WAAd,CAPN;AAQLC,MAAAA,QAAQ,EAAEf,SAAS,CAAC,KAAD,CAAT,GAAmBA,SAAS,CAAC,KAAD,CAAT,CAAiBgB,KAAjB,CAAuB,GAAvB,EAA4B,CAA5B,CAAnB,GAAoD,EARzD;AASLC,MAAAA,KAAK,EAAE,IATF;AAULC,MAAAA,KAAK,EAAE,CAVF;AAWLC,MAAAA,cAAc,EAAE,KAXX;AAYLC,MAAAA,aAAa,EAAE,IAZV;AAaLC,MAAAA,MAAM,EAAE,IAbH;AAcLC,MAAAA,aAAa,EAAE,IAdV;AAeLC,MAAAA,aAAa,EAAE,KAfV;AAgBLC,MAAAA,QAAQ,EAAE,KAhBL;AAiBLC,MAAAA,UAAU,EAAE,IAjBP;AAkBLC,MAAAA,YAAY,EAAE,KAlBT;AAmBL;AACAC,MAAAA,aAAa,EAAE,CApBV;AAqBLC,MAAAA,WAAW,EAAE,CArBR;AAsBLC,MAAAA,OAAO,EAAE,CACP,IADO,EAEP,OAFO,EAGP,IAHO,EAIP,IAJO,EAKP,OALO,EAMP,OANO,EAOP,IAPO,EAQP,OARO,EASP,IATO,EAUP,IAVO,EAWP,IAXO,EAYP,OAZO,EAaP,OAbO,EAcP,OAdO,EAeP,IAfO,EAgBP,IAhBO,EAiBP,IAjBO,EAkBP,OAlBO,EAmBP,IAnBO,EAoBP,IApBO,EAqBP,IArBO,EAsBP,IAtBO,EAuBP,IAvBO,EAwBP,IAxBO,EAyBP,OAzBO,EA0BP,IA1BO,EA2BP,IA3BO,EA4BP,IA5BO,EA6BP,IA7BO,EA8BP,IA9BO,CAtBJ;AAsDL;AACAC,MAAAA,WAAW,EAAE,IAvDR;AAwDL;AACAC,MAAAA,QAAQ,EAAEC,MAAM,CAACD,QAzDZ;AA0DL;AACAE,MAAAA,qBAAqB,EAAE,CACrB,sBADqB,EAErB,oBAFqB,EAGrB,sBAHqB,EAIrB,iBAJqB,EAKrB,oBALqB,EAMrB,gBANqB,EAOrB,mBAPqB,EAQrB,kBARqB,EASrB,eATqB,EAUrB,0BAVqB,EAWrB,eAXqB,EAYrB,qBAZqB,EAarB,qBAbqB,EAcrB,uBAdqB,CAerB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3BqB;AA3DlB,KAAP;AAyFD,GA5FY;AA6FbC,EAAAA,QAAQ,EAAE;AACR;AACAC,IAAAA,aAFQ,2BAEQ;AACd,aAAO,KAAKC,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBC,YAAhC;AACD,KAJO;AAKR;AACAC,IAAAA,UANQ,wBAMK;AACX,aAAO,KAAKJ,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBE,UAAhC;AACD,KARO;AASR;AACAC,IAAAA,UAVQ,wBAUK;AACX,aAAOC,MAAM,CAAC,KAAKN,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBG,UAA1B,CAAb;AACD,KAZO;AAaR;AACAE,IAAAA,QAdQ,sBAcG;AACT,aAAO,KAAKP,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBK,QAAhC;AACD,KAhBO;AAiBRC,IAAAA,SAjBQ,uBAiBI;AACV,aAAOzC,MAAM,CAAC0C,eAAP,IAA0B,EAAjC;AACD,KAnBO;AAoBRC,IAAAA,kBApBQ,gCAoBa;AACnB,aAAO,KAAKV,MAAL,CAAYC,KAAZ,CAAkBU,QAAlB,CAA2BD,kBAAlC;AACD,KAtBO;AAuBRE,IAAAA,YAvBQ,0BAuBO;AACb,UAAI;AACF,eAAO,KAAKZ,MAAL,CAAYC,KAAZ,CAAkBU,QAAlB,CAA2BE,MAA3B,CAAkCC,UAAzC;AACD,OAFD,CAEE,OAAOC,CAAP,EAAU;AACV,eAAO,CACL,MADK,EAEL,MAFK,EAGL,OAHK,EAIL,OAJK,EAKL,OALK,EAML,IANK,EAOL,MAPK,EAQL,OARK,EASL,QATK,CAAP;AAWD;AACF,KAvCO;AAwCRC,IAAAA,QAxCQ,sBAwCG;AACT,UAAMC,CAAC,GAAG,EAAV;;AACA,UAAI,KAAKL,YAAL,CAAkBM,MAAtB,EAA8B;AAC5B,aAAKN,YAAL,CAAkBO,OAAlB,CAA0B,UAACC,EAAD,EAAQ;AAChC,cAAMC,CAAC,GAAG,EAAV;;AACA,cAAID,EAAE,CAACE,OAAH,CAAW,KAAX,IAAoB,CAAC,CAAzB,EAA4B;AAC1BD,YAAAA,CAAC,CAACE,IAAF,CAAOH,EAAP,EAAWI,UAAU,CAACJ,EAAD,CAArB;AACD,WAFD,MAEO,IACLA,EAAE,CAACK,WAAH,GAAiBH,OAAjB,CAAyB,GAAzB,IAAgC,CAAC,CAAjC,IACGF,EAAE,CAACE,OAAH,CAAW,OAAX,IAAsB,CAFpB,EAGL;AACAD,YAAAA,CAAC,CAACE,IAAF,CAAOH,EAAP,EAAWI,UAAU,CAACJ,EAAD,CAAV,GAAiB,EAA5B;AACD,WALM,MAKA,IAAIA,EAAE,CAACE,OAAH,CAAW,KAAX,IAAoB,CAAC,CAAzB,EAA4B;AACjCD,YAAAA,CAAC,CAACE,IAAF,CAAOH,EAAP,EAAWI,UAAU,CAACJ,EAAD,CAAV,GAAiB,EAAjB,GAAsB,EAAjC;AACD,WAFM,MAEA,IAAIA,EAAE,CAACE,OAAH,CAAW,MAAX,IAAqB,CAAC,CAA1B,EAA6B;AAClCD,YAAAA,CAAC,CAACE,IAAF,CAAOH,EAAP,EAAWI,UAAU,CAACJ,EAAD,CAAV,GAAiB,CAAjB,GAAqB,EAArB,GAA0B,EAArC;AACD,WAFM,MAEA,IAAIA,EAAE,CAACE,OAAH,CAAW,OAAX,IAAsB,CAAC,CAA3B,EAA8B;AACnCD,YAAAA,CAAC,CAACE,IAAF,CAAOH,EAAP,EAAWI,UAAU,CAACJ,EAAD,CAAV,GAAiB,EAAjB,GAAsB,EAAtB,GAA2B,EAAtC;AACD;;AACDH,UAAAA,CAAC,CAACM,IAAF,CAAOF,CAAP;AACD,SAjBD;AAkBD;;AACD,aAAOJ,CAAP;AACD,KA/DO;AAgER;AACAS,IAAAA,SAjEQ,uBAiEI;AACV,aAAO,KAAK1B,MAAL,CAAYC,KAAZ,CAAkBU,QAAlB,CAA2Be,SAAlC;AACD,KAnEO;AAoERC,IAAAA,OApEQ,qBAoEE;AACR,UAAMrD,KAAK,GAAGV,SAAS,CAAC,SAAD,CAAT,IAAwBA,SAAS,CAAC,SAAD,CAAjC,IAAgD,GAA9D;AACA,UAAMgE,MAAM,GAAGtD,KAAK,CAACuD,QAAN,OAAqB,GAArB,GAA2B,MAA3B,GAAoC,OAAnD;AACA,aAAOD,MAAP;AACD;AAxEO,GA7FG;AAuKbE,EAAAA,KAAK,EAAE;AACL/B,IAAAA,aADK,yBACSgC,GADT,EACcC,GADd,EACmB;AAAA;;AACtB,UAAID,GAAG,IAAIC,GAAX,EAAgB;AACd,YAAI,KAAKzD,SAAL,KAAmB,CAAvB,EAA0B;AACxB,eAAKS,aAAL,GAAqB,IAArB;AACD;;AACD,YAAIY,MAAM,CAACqC,QAAX,EAAqB;AACnB,cAAMC,GAAG,GAAG,KAAKnC,aAAL,CAAmBnB,KAAnB,CAAyB,GAAzB,CAAZ;AACA,cAAImB,aAAa,GAAGmC,GAAG,CAAC,CAAD,CAAvB;;AACA,cAAIA,GAAG,IAAIA,GAAG,CAAChB,MAAf,EAAuB;AACrB,gBAAIgB,GAAG,CAAC,CAAD,CAAH,KAAW,GAAX,IAAkBA,GAAG,CAAC,CAAD,CAAH,KAAW,GAAjC,EAAsC;AACpCnC,cAAAA,aAAa,aAAMmC,GAAG,CAAC,CAAD,CAAT,cAAgBA,GAAG,CAAC,CAAD,CAAnB,CAAb;AACD;AACF;;AACDtC,UAAAA,MAAM,CAACqC,QAAP,CAAgBE,SAAhB,CACEpC,aADF,EAEE,KAAKqC,UAAL,CAAgB,IAAhB,EAAsB,KAAK3D,SAA3B,CAFF,EAGE,YAAM;AACJ,YAAA,KAAI,CAAC4D,MAAL,CAAYC,KAAZ,GAAoBC,iBAApB,CAAsC,YAAtC;AACD,WALH;AAOD;AACF;AACF,KAvBI;AAwBLnC,IAAAA,UAxBK,sBAwBM2B,GAxBN,EAwBWC,GAxBX,EAwBgB;AAAA;;AACnB,UAAID,GAAG,IAAIC,GAAX,EAAgB;AACd,YAAI,KAAKzD,SAAL,KAAmB,CAAvB,EAA0B;AACxB,eAAKS,aAAL,GAAqB,IAArB;AACD;;AACD,YAAI,KAAKP,SAAL,KAAmB,MAAvB,EAA+B;AAC7B,eAAKA,SAAL,GAAiB,MAAjB;AACD;;AACD,YAAImB,MAAM,CAACqC,QAAX,EAAqB;AACnB,eAAKI,MAAL,CAAYG,WAAZ,CAAwB,KAAK7D,QAA7B;AACA8D,UAAAA,UAAU,CAAC,YAAM;AACf,YAAA,MAAI,CAACC,OAAL;AACD,WAFS,EAEP,IAFO,CAAV;AAGD;AACF;AACF;AAvCI,GAvKM;AAgNbC,EAAAA,OAAO,EAAE;AACPC,IAAAA,IADO,kBACA;AAAA;;AACL;AACAC,MAAAA,QAAQ,CAACC,mBAAT,CAA6B,kBAA7B,EAAiD,KAAKC,UAAtD;AACAF,MAAAA,QAAQ,CAACG,gBAAT,CAA0B,kBAA1B,EAA8C,KAAKD,UAAnD;;AAEA,UAAI,KAAKtD,OAAL,CAAa6B,OAAb,CAAqB,KAAK3C,QAA1B,KAAuC,CAAC,CAA5C,EAA+C;AAC7C,aAAKA,QAAL,GAAgB,IAAhB;AACD;;AACD,UAAIf,SAAS,CAAC,KAAD,CAAT,KAAqB,OAAzB,EAAkC;AAChC,aAAKe,QAAL,GAAgB,OAAhB;AACD;;AACD,UAAI,CAAChB,SAAS,CAACe,GAAV,CAAc,WAAd,CAAL,EAAiC;AAC/Bf,QAAAA,SAAS,CAACsF,GAAV,CAAc,WAAd,EAA2B,MAA3B;AACA,aAAKxE,SAAL,GAAiB,MAAjB;AACD,OAdI,CAeL;;;AACA,WAAKyE,IAAL,CAAUC,GAAV,CAAc,mBAAd,EAAmC,UAACpB,GAAD,EAAS;AAC1C,QAAA,MAAI,CAACvD,WAAL,GAAmB4E,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAevB,GAAf,CAAX,CAAnB;;AACA,YAAI,MAAI,CAACvD,WAAT,EAAsB;AACpB,UAAA,MAAI,CAACO,cAAL,GAAsB,KAAtB;;AACA,UAAA,MAAI,CAACwE,eAAL;AACD;AACF,OAND,EAhBK,CAwBL;;AACA,WAAKL,IAAL,CAAUC,GAAV,CAAc,cAAd,EAA8B,YAAM;AAClC,QAAA,MAAI,CAACnE,aAAL,GAAqB,KAArB;AACD,OAFD,EAzBK,CA4BL;;AACA,WAAKQ,WAAL,GAAmB,KAAKgE,KAAL,CAAWC,UAAX,CAAsBC,WAAtB,GAAoC,KAAKF,KAAL,CAAWG,UAAX,CAAsBD,WAA7E;AACD,KA/BM;AAgCPE,IAAAA,KAhCO,iBAgCDC,KAhCC,EAgCM;AACX,WAAK3E,aAAL,GAAqB2E,KAArB;AACD,KAlCM;AAmCPC,IAAAA,KAnCO,mBAmCC;AACN,WAAK5E,aAAL,GAAqB,IAArB;AACD,KArCM;AAsCP6E,IAAAA,aAtCO,yBAsCOC,GAtCP,EAsCY;AACjB,UAAI,KAAKzF,SAAL,KAAmByF,GAAnB,IAA0B,KAAK9E,aAAL,KAAuB8E,GAArD,EAA0D;AACxD,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD,KA3CM;AA4CPT,IAAAA,eA5CO,6BA4CW;AAChB,WAAKU,YAAL;AACD,KA9CM;AA+CP;AACAC,IAAAA,YAhDO,0BAgDQ;AACb,UAAMC,IAAI,GAAG,IAAb;AACA,aAAO;AACLC,QAAAA,OADK,mBACGC,QADH,EACa;AAChB,cAAMC,GAAG,GAAG;AACVC,YAAAA,qBAAqB,EAAEJ,IAAI,CAAC/B,UAAL,CAAgB,KAAhB,EAAuB,CAAvB,CADb;AACwC;AAClDoC,YAAAA,sBAAsB,EAAE,KAFd;AAGVC,YAAAA,cAAc,EAAE,IAHN;AAIVC,YAAAA,eAAe,EAAE,KAJP;AAKVC,YAAAA,wBAAwB,EAAE;AALhB,WAAZ;AAOAlC,UAAAA,UAAU,CAAC,YAAM;AACf4B,YAAAA,QAAQ,CAACC,GAAD,CAAR;AACD,WAFS,EAEP,CAFO,CAAV;AAGD,SAZI;AAaL;AACAM,QAAAA,aAdK,yBAcSC,UAdT,EAcqBC,wBAdrB,EAc+C;AAClDrC,UAAAA,UAAU,CAAC,YAAM;AACfqC,YAAAA,wBAAwB,CAAC;AACvB3G,cAAAA,IAAI,EAAE0G,UADiB;AAEvB,iCAAmB,EAFI;AAGvB,iCAAmB,EAHI;AAIvBE,cAAAA,MAAM,EAAE,CAJe;AAKvBC,cAAAA,OAAO,EAAE,CALc;AAMvBC,cAAAA,UAAU,EAAE,CANW;AAOvBC,cAAAA,OAAO,EAAE,mBAPc;AAQvBC,cAAAA,YAAY,EAAE,IARS;AASvBC,cAAAA,aAAa,EAAE,KATQ;AAUvBC,cAAAA,gBAAgB,EAAE,CAVK;AAWvBC,cAAAA,WAAW,EAAET,UAAU,CAACU,WAAX,EAXU;AAYvBC,cAAAA,IAAI,EAAE,SAZiB;AAavBjB,cAAAA,qBAAqB,EAAEJ,IAAI,CAAC/B,UAAL,CAAgB,KAAhB,EAAuB,CAAvB,CAbA;AAcvBqD,cAAAA,UAAU,EAAEtB,IAAI,CAACuB,cAAL,EAdW;AAevBC,cAAAA,MAAM,EAAEd,UAAU,CAACU,WAAX,EAfe;AAgBvBK,cAAAA,QAAQ,EAAEhG,MAAM,CAACiG,IAAP,CAAYC,SAAZ,GAAwB3H,IAAxB;AAhBa,aAAD,CAAxB;AAkBD,WAnBS,EAmBP,CAnBO,CAAV;AAoBD,SAnCI;AAoCL;AACA4H,QAAAA,qBArCK,mCAqCmB;AACtB,iBAAOC,SAAP;AACD,SAvCI;AAwCL;AACAC,QAAAA,OAzCK,mBA0CHC,UA1CG,EA2CHC,UA3CG,EA4CHC,IA5CG,EA6CHC,EA7CG,EA8CHC,iBA9CG,EA+CHC,eA/CG,EAgDHC,gBAhDG,EAiDH;AACA,cAAIA,gBAAJ,EAAsB;AACpBrC,YAAAA,IAAI,CAACtF,KAAL,GAAa,KAAb;AACD;;AACD,cAAMJ,SAAS,GAAG0F,IAAI,CAAC1F,SAAL,KAAmB,MAAnB,GAA4B,MAA5B,GAAqC0F,IAAI,CAAC1F,SAA5D;;AACA,cAAI0F,IAAI,CAAC3F,WAAT,EAAsB;AACpB2F,YAAAA,IAAI,CAACjB,IAAL,CAAUuD,KAAV,CAAgB,sBAAhB,EAAwC;AACtCjB,cAAAA,IAAI,EAAE,KADgC;AAEtCkB,cAAAA,MAAM,EAAEvC,IAAI,CAACpE,aAFyB;AAGtCtB,cAAAA,SAAS,EAATA,SAHsC;AAItCI,cAAAA,KAAK,EAAEsF,IAAI,CAACtF,KAJ0B;AAKtC8H,cAAAA,MAAM,EAAE;AAL8B,aAAxC;AAOD;;AACDxC,UAAAA,IAAI,CAACjB,IAAL,CAAU0D,IAAV,CAAe,gBAAf;AACAzC,UAAAA,IAAI,CAACjB,IAAL,CAAUC,GAAV,CAAc,gBAAd,EAAgC,UAAC/E,IAAD,EAAU;AACxC,gBAAMyI,MAAM,GAAGzD,IAAI,CAACC,KAAL,CAAWjF,IAAX,CAAf;AACA+F,YAAAA,IAAI,CAACrF,KAAL,GAAa,CAAb;AACA,gBAAMgI,UAAU,GAAGD,MAAM,CAACE,OAAP,CAAenI,KAAf,CAAqB,GAArB,CAAnB;AACA,gBAAMoI,KAAK,GAAGF,UAAU,CAACA,UAAU,CAAC5F,MAAX,GAAoB,CAArB,CAAxB;;AACA,wCAAyB2F,MAAM,CAACE,OAAP,CAAenI,KAAf,CAAqB,GAArB,CAAzB;AAAA;AAAA,gBAAS4G,IAAT;AAAA,gBAAekB,MAAf;;AACA,gBAAMO,UAAU,aAAMzB,IAAN,cAAckB,MAAd,CAAhB;;AACA,gBAAIO,UAAU,KAAK9C,IAAI,CAACpE,aAApB,IAAqCtB,SAAS,KAAKuI,KAAvD,EAA8D;AAC5D,kBAAME,MAAM,GAAGL,MAAM,CAACzI,IAAtB;AACA,kBAAM+I,OAAO,GAAG,EAAhB;;AACA,kBAAID,MAAM,IAAIA,MAAM,CAAChG,MAArB,EAA6B;AAC3BgG,gBAAAA,MAAM,CAAC/F,OAAP,CAAe,UAACiG,IAAD,EAAU;AACvBD,kBAAAA,OAAO,CAAC5F,IAAR,CAAa4C,IAAI,CAACkD,OAAL,CAAaD,IAAb,CAAb;AACD,iBAFD;;AAGA,oBAAIZ,gBAAJ,EAAsB;AACpBrC,kBAAAA,IAAI,CAACrF,KAAL,GAAaqI,OAAO,CAACA,OAAO,CAACjG,MAAR,GAAiB,CAAlB,CAAP,CAA4BoG,IAAzC;AACD;;AACD,oBAAInD,IAAI,CAACtF,KAAL,KAAeqI,MAAM,CAAC,CAAD,CAAN,CAAUK,EAA7B,EAAiC;AAC/BjB,kBAAAA,iBAAiB,CAAC,EAAD,EAAK;AAAEkB,oBAAAA,MAAM,EAAE;AAAV,mBAAL,CAAjB;AACAxJ,kBAAAA,MAAM,CAAC;AACLyJ,oBAAAA,IAAI,EAAE7H,MAAM,CAAC8H,QAAP,CAAgBD,IADjB;AAELjC,oBAAAA,IAAI,EAAE,mBAFD;AAGLmC,oBAAAA,IAAI,EAAE/H,MAAM,CAAC8H,QAAP,CAAgBE,IAHjB;AAILC,oBAAAA,EAAE,EAAE,0BAJC;AAKLzJ,oBAAAA,IAAI,EAAE;AACJsI,sBAAAA,MAAM,EAAEvC,IAAI,CAACpE;AADT,qBALD;AAQLsB,oBAAAA,CAAC,EAAE,IAAIyG,IAAJ,GAAWC,OAAX;AARE,mBAAD,CAAN;AAUD,iBAZD,MAYO;AACL5D,kBAAAA,IAAI,CAACtF,KAAL,GAAaqI,MAAM,CAAC,CAAD,CAAN,CAAUK,EAAvB;AACAjB,kBAAAA,iBAAiB,CAACa,OAAD,CAAjB;AACD;AACF,eAvBD,MAuBO;AACL,oBAAIhD,IAAI,CAAC6D,MAAL,GAAc,CAAlB,EAAqB;AACnB7D,kBAAAA,IAAI,CAACD,YAAL,GAAoB+B,OAApB,CACEC,UADF,EAEEC,UAFF,EAGEC,IAHF,EAIEC,EAJF,EAKEC,iBALF,EAMEC,eANF,EAOEC,gBAPF;AASArC,kBAAAA,IAAI,CAAC6D,MAAL,IAAe,CAAf;AACA;AACD;;AACD,oBAAI,CAAC7D,IAAI,CAACtF,KAAV,EAAiB;AACfb,kBAAAA,MAAM,CAAC;AACLyJ,oBAAAA,IAAI,EAAE7H,MAAM,CAAC8H,QAAP,CAAgBD,IADjB;AAELjC,oBAAAA,IAAI,EAAE,aAFD;AAGLmC,oBAAAA,IAAI,EAAE/H,MAAM,CAAC8H,QAAP,CAAgBE,IAHjB;AAILC,oBAAAA,EAAE,EAAE,gCAJC;AAKLzJ,oBAAAA,IAAI,EAAJA,IALK;AAMLiD,oBAAAA,CAAC,EAAE,IAAIyG,IAAJ,GAAWC,OAAX;AANE,mBAAD,CAAN;AAQD;;AACDzB,gBAAAA,iBAAiB,CAAC,EAAD,EAAK;AAAEkB,kBAAAA,MAAM,EAAE;AAAV,iBAAL,CAAjB;AACD;AACF;AACF,WA5DD;;AA6DA,cAAI,CAACrD,IAAI,CAACpF,cAAV,EAA0B;AACxBoF,YAAAA,IAAI,CAAC8D,mBAAL;AACA9D,YAAAA,IAAI,CAAC9B,MAAL,CAAYC,KAAZ,GAAoB4F,YAApB,CAAiC,CAAjC;AACD;AACF,SAjII;AAkIL;AACAC,QAAAA,aAnIK,yBAmISjC,UAnIT,EAmIqBC,UAnIrB,EAmIiCiC,kBAnIjC,EAmIqD;AACxDjE,UAAAA,IAAI,CAACnF,aAAL,GAAqB,KAArB;AACAmF,UAAAA,IAAI,CAAClF,MAAL,GAAc,KAAd;AACA,cAAMR,SAAS,GAAG0F,IAAI,CAAC1F,SAAL,KAAmB,MAAnB,GAA4B,MAA5B,GAAqC0F,IAAI,CAAC1F,SAA5D;;AACA,cAAI0F,IAAI,CAAC3F,WAAT,EAAsB;AACpB2F,YAAAA,IAAI,CAACjB,IAAL,CAAUuD,KAAV,CAAgB,sBAAhB,EAAwC;AACtCjB,cAAAA,IAAI,EAAE,KADgC;AAEtCkB,cAAAA,MAAM,EAAEvC,IAAI,CAACpE,aAFyB;AAGtCtB,cAAAA,SAAS,EAATA;AAHsC,aAAxC;AAKD;;AACD0F,UAAAA,IAAI,CAACjB,IAAL,CAAU0D,IAAV,CAAe,gBAAf;AACAzC,UAAAA,IAAI,CAACjB,IAAL,CAAUC,GAAV,CAAc,gBAAd,EAAgC,UAAC/E,IAAD,EAAU;AACxC,gBAAMyI,MAAM,GAAGzD,IAAI,CAACC,KAAL,CAAWjF,IAAX,CAAf,CADwC,CAExC;;AACA,gBAAM0I,UAAU,GAAGD,MAAM,CAACE,OAAP,CAAenI,KAAf,CAAqB,GAArB,CAAnB;AACA,gBAAMoI,KAAK,GAAGF,UAAU,CAACA,UAAU,CAAC5F,MAAX,GAAoB,CAArB,CAAxB;;AACA,yCAAyB2F,MAAM,CAACE,OAAP,CAAenI,KAAf,CAAqB,GAArB,CAAzB;AAAA;AAAA,gBAAS4G,IAAT;AAAA,gBAAekB,MAAf;;AACA,gBAAMO,UAAU,aAAMzB,IAAN,cAAckB,MAAd,CAAhB;;AACA,gBACEG,MAAM,CAACwB,IAAP,IACGrB,KAAK,KAAKvI,SADb,IAEGwI,UAAU,KAAK9C,IAAI,CAACpE,aAHzB,EAIE;AACA,kBAAMuI,QAAQ,GAAGnE,IAAI,CAACkD,OAAL,CAAaR,MAAM,CAACwB,IAApB,CAAjB;;AACA,kBAAIlE,IAAI,CAACrF,KAAL,GAAawJ,QAAQ,CAAChB,IAA1B,EAAgC;AAC9Bc,gBAAAA,kBAAkB,CAACE,QAAD,CAAlB;AACD;AACF;AACF,WAjBD;AAkBD,SAjKI;AAkKL;AACAC,QAAAA,eAnKK,2BAmKWC,aAnKX,EAmK0B;AAC7B,cAAMtG,GAAG,GAAGsG,aAAa,CAAC5J,KAAd,CAAoB,GAApB,CAAZ;AACA,cAAM8H,MAAM,aAAMxE,GAAG,CAAC,CAAD,CAAT,cAAgBA,GAAG,CAAC,CAAD,CAAnB,CAAZ;AACAiC,UAAAA,IAAI,CAACjB,IAAL,CAAUuD,KAAV,CAAgB,sBAAhB,EAAwC;AACtCjB,YAAAA,IAAI,EAAE,OADgC;AAEtCkB,YAAAA,MAAM,EAAEA,MAAM,CAACjF,WAAP,EAF8B;AAGtChD,YAAAA,SAAS,EAAE0F,IAAI,CAAC/B,UAAL,CAAgB,IAAhB,EAAsBZ,UAAU,CAACU,GAAG,CAAC,CAAD,CAAJ,CAAhC;AAH2B,WAAxC;AAKD;AA3KI,OAAP;AA6KD,KA/NM;AAgOP;AACA+B,IAAAA,YAjOO,0BAiOQ;AAAA,UACPwE,CADO;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA,QACG7I,MAAM,CAAC8I,WAAP,CAAmBrG,MADtB;;AAEb,UAAI,KAAKtC,aAAT,EAAwB;AACtB,YAAMA,aAAa,GAAG,KAAKA,aAAL,CAAmBnB,KAAnB,CAAyB,GAAzB,EAA8B,CAA9B,CAAtB;AACAgB,QAAAA,MAAM,CAACqC,QAAP,GAAkB,IAAIwG,CAAJ,CAAM;AACtBE,UAAAA,KAAK,EAAE,KADe;AAEtBC,UAAAA,QAAQ,EAAE,IAFY;AAGtBhD,UAAAA,QAAQ,EAAEhG,MAAM,CAACiG,IAAP,CAAYC,SAAZ,GAAwB3H,IAAxB,EAHY;AAItBuI,UAAAA,MAAM,EAAE3G,aAJc;AAKtB8I,UAAAA,QAAQ,EAAE,KAAKzG,UAAL,CAAgB,IAAhB,EAAsB,KAAK3D,SAA3B,CALY;AAMtBqK,UAAAA,YAAY,EAAE,oBANQ;AAMc;AACpCC,UAAAA,QAAQ,EAAE,KAAK7E,YAAL,EAPY;AAOS;AAC/B8E,UAAAA,YAAY,EAAE,2BARQ;AAQqB;AAC3CC,UAAAA,MAAM,EAAE,KAAKtK,QATS;AASC;AACvBuK,UAAAA,iBAAiB,EAAE,KAAKrJ,qBAVF;AAWtBsJ,UAAAA,gBAAgB,EAAE,CAClB;AACE,wCAFgB,CAXI;AAetBC,UAAAA,kBAAkB,YAAKxJ,MAAM,CAAC8H,QAAP,CAAgB2B,QAArB,+BAfI;AAgBtBC,UAAAA,0BAA0B,EAAE,KAhBN;AAiBtBC,UAAAA,SAAS,EAAE,iBAjBW;AAkBtBC,UAAAA,OAAO,EAAE,aAlBa;AAmBtBC,UAAAA,UAAU,EAAE3L,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAnBI;AAmBkB;AACxCS,UAAAA,KAAK,EAAE,KAAKqD,OApBU;AAqBtB+H,UAAAA,iBAAiB,EAAE;AACjB,qCAAyB5L,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CADd;AAEjB,qCAAyBC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAFd;AAGjB,0CAA8B;AAHb,WArBG;AA0BtB8L,UAAAA,SAAS,EAAE;AACX;AACEC,YAAAA,cAAc,EAAE,OAFP;AAEgB;AACzB,yCAA6B,EAHpB;AAGwB;AACjC,0CAA8B9L,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAJ3B;AAIiD;AAC1D,0CAA8BC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAL3B;AAKiD;AAC1D,yCAA6BC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAN1B;AAMgD;AACzD,uDAA2CC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAPxC;AAO8D;AACvE,uDAA2CC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CARxC;AAQ8D;AACvE,wDAA4CC,MAAM,CAChDD,QAAQ,CAAC,QAAD,CADwC,CATzC;AAWN;AACH,0DAA8C,IAZrC;AAY2C;AACpD;AACA,wDAA4CC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAdzC;AAeT,0DAA8CC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAf3C;AAgBT,yDAA6C,IAhBpC;AAiBT,2DAA+C,IAjBtC;AAkBT,4DAAgD,EAlBvC;AAmBT,8DAAkDC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAnB/C;AAoBT,gEAAoDC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CApBjD;AAqBT,4DAAgDC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CArB7C;AAsBT,8DAAkDC,MAAM,CAACD,QAAQ,CAAC,QAAD,CAAT,CAtB/C;AAuBT,qEAAyD,CAAC,CAvBjD;AAwBT;AACA;AACA,qDAAyCA,QAAQ,CAAC,SAAD,CA1BxC;AA2BT;AACA,qDAAyCA,QAAQ,CAAC,SAAD,CA5BxC;AA6BT,wDAA4CC,MAAM,CAChDD,QAAQ,CAAC,SAAD,CADwC,CA7BzC;AAgCT,wDAA4C,CAhCnC;AAiCT,wDAA4C,CAjCnC;AAkCT,0DAA8C;AAlCrC;AA1BW,SAAN,CAAlB;AA+DA,aAAKwE,MAAL,GAAczC,MAAM,CAACqC,QAArB;AACD;AACF,KAtSM;AAuSP;AACAG,IAAAA,UAxSO,sBAwSIyH,IAxSJ,EAwSUrE,IAxSV,EAwSgB;AACrB,UAAIqE,IAAJ,EAAU;AACR,YAAIxI,EAAC,GAAG,IAAR;;AACA,YAAI,KAAKL,QAAL,CAAcE,MAAlB,EAA0B;AACxB,eAAKF,QAAL,CAAcG,OAAd,CAAsB,UAACiG,IAAD,EAAU;AAC9B,gBAAM0C,CAAC,GAAG1C,IAAI,CAAC9F,OAAL,CAAakE,IAAb,CAAV;;AACA,gBAAIsE,CAAC,GAAG,CAAC,CAAT,EAAY;AACVzI,cAAAA,EAAC,GAAGyI,CAAC,KAAK,CAAN,GAAU1C,IAAI,CAAC,CAAD,CAAd,GAAoBA,IAAI,CAAC,CAAD,CAA5B;AACD;AACF,WALD;AAMD;;AACD,eAAO/F,EAAP;AACD;;AACD,UAAMA,CAAC,GAAG,EAAV;AACA,WAAKL,QAAL,CAAcG,OAAd,CAAsB,UAACiG,IAAD,EAAU;AAC9B/F,QAAAA,CAAC,CAACE,IAAF,CAAO6F,IAAI,CAAC5B,IAAD,CAAX;AACD,OAFD;AAGA,aAAOnE,CAAP;AACD,KA1TM;AA2TP;AACAqE,IAAAA,cA5TO,4BA4TU;AACf,UAAMqE,CAAC,YAAG,EAAH,EAAS,KAAKxJ,QAAd,CAAP;AACA,aAAOiB,UAAU,CAACuI,CAAC,CAAClI,QAAF,EAAD,CAAjB;AACD,KA/TM;AAgUPoG,IAAAA,mBAhUO,iCAgUe;AAAA;;AACpB,WAAKlJ,cAAL,GAAsB,IAAtB;AACA,WAAK2D,OAAL,GAFoB,CAGpB;;AACA,UAAMsH,KAAK,GAAGnH,QAAQ,CAACoH,aAAT,CAAuB,OAAvB,CAAd;AACA;;AACA,UAAMC,IAAI,GAAGrH,QAAQ,CAACsH,cAAT,CACX,oDACEtM,QAAQ,CAAC,QAAD,CADV,GAEE,mBAFF,GAGEA,QAAQ,CAAC,QAAD,CAHV,GAIE,uQAJF,GAKEA,QAAQ,CAAC,QAAD,CALV,GAME,mBANF,GAOEA,QAAQ,CAAC,QAAD,CAPV,GAQE,+DARF,GASEA,QAAQ,CAAC,QAAD,CATV,GAUE,YAVF,GAWEA,QAAQ,CAAC,QAAD,CAXV,GAYE,yGAZF,GAaEA,QAAQ,CAAC,QAAD,CAbV,GAcE,6EAdF,GAeEA,QAAQ,CAAC,QAAD,CAfV,GAgBE,WAhBF,GAiBEA,QAAQ,CAAC,QAAD,CAjBV,GAkBE,IAnBS,CAAb;AAqBF;;AACEmM,MAAAA,KAAK,CAACI,MAAN,CAAaF,IAAb;AACA,WAAK7H,MAAL,CAAYgI,WAAZ,GAA0BC,IAA1B,CAA+B,YAAM;AACnC,QAAA,MAAI,CAACjI,MAAL,CAAYkI,YAAZ,GAA2BH,MAA3B,CAAkCJ,KAAlC;AACD,OAFD;AAGD,KAhWM;AAiWPtH,IAAAA,OAjWO,qBAiWG;AACR;AACA,WAAKL,MAAL,CACGC,KADH,GAEGkI,WAFH,CAEe,gBAFf,EAEiC,KAFjC,EAEwC,KAFxC,EAE+C,CAAC,CAAD,CAF/C,EAEoD,IAFpD,EAE0D;AACtD,sBAAc;AADwC,OAF1D;AAKA,WAAKnI,MAAL,CACGC,KADH,GAEGkI,WAFH,CAEe,gBAFf,EAEiC,KAFjC,EAEwC,KAFxC,EAE+C,CAAC,EAAD,CAF/C,EAEqD,IAFrD,EAE2D;AACvD,sBAAc;AADyC,OAF3D;AAKA,WAAKnI,MAAL,CACGC,KADH,GAEGkI,WAFH,CAEe,gBAFf,EAEiC,KAFjC,EAEwC,KAFxC,EAE+C,CAAC,EAAD,CAF/C,EAEqD,IAFrD,EAE2D;AACvD,sBAAc;AADyC,OAF3D;AAKD,KAlXM;AAmXPC,IAAAA,SAnXO,uBAmXK;AACV;AACA,UAAMC,CAAC,GAAG,KAAKrI,MAAL,CAAYC,KAAZ,GAAoBqI,aAApB,EAAV;AACA,WAAKtI,MAAL,CAAYC,KAAZ,GAAoBsI,mBAApB,CAAwCF,CAAC,CAAC,CAAD,CAAD,CAAKnD,EAA7C,EAAiD,IAAjD;AACA,WAAKlF,MAAL,CAAYC,KAAZ,GAAoBsI,mBAApB,CAAwCF,CAAC,CAAC,CAAD,CAAD,CAAKnD,EAA7C,EAAiD,IAAjD;AACA,WAAKlF,MAAL,CAAYC,KAAZ,GAAoBsI,mBAApB,CAAwCF,CAAC,CAAC,CAAD,CAAD,CAAKnD,EAA7C,EAAiD,IAAjD;AACD,KAzXM;AA0XPsD,IAAAA,SA1XO,uBA0XK;AACV;AACA,UAAMH,CAAC,GAAG,KAAKrI,MAAL,CAAYC,KAAZ,GAAoBqI,aAApB,EAAV;AACA,WAAKtI,MAAL,CAAYC,KAAZ,GAAoBsI,mBAApB,CAAwCF,CAAC,CAAC,CAAD,CAAD,CAAKnD,EAA7C,EAAiD,KAAjD;AACA,WAAKlF,MAAL,CAAYC,KAAZ,GAAoBsI,mBAApB,CAAwCF,CAAC,CAAC,CAAD,CAAD,CAAKnD,EAA7C,EAAiD,KAAjD;AACA,WAAKlF,MAAL,CAAYC,KAAZ,GAAoBsI,mBAApB,CAAwCF,CAAC,CAAC,CAAD,CAAD,CAAKnD,EAA7C,EAAiD,KAAjD;AACD,KAhYM;AAiYPuD,IAAAA,SAjYO,qBAiYGC,CAjYH,EAiYM;AAAA;;AACX,UAAIA,CAAC,KAAK,MAAN,IAAgBA,CAAC,KAAK,MAAtB,IAAgCA,CAAC,KAAK,KAAKtM,SAA/C,EAA0D;AACxD,aAAKO,aAAL,GAAqB,IAArB;AACD;;AACD,UAAI+L,CAAC,KAAK,KAAKtM,SAAf,EAA0B;AACxB,aAAKA,SAAL,GAAiBsM,CAAjB;;AACA,YAAIA,CAAC,KAAK,MAAV,EAAkB;AAChBpN,UAAAA,SAAS,CAACsF,GAAV,CAAc,WAAd,EAA2B,MAA3B;AACD,SAFD,MAEO;AACLtF,UAAAA,SAAS,CAACsF,GAAV,CAAc,WAAd,EAA2B8H,CAA3B;AACD;;AACD,aAAK7H,IAAL,CAAUuD,KAAV,CAAgB,YAAhB,EAA8BsE,CAA9B;;AACA,YAAI,KAAKhM,cAAT,EAAyB;AACvB,cAAMoH,UAAU,GAAG,KAAK9D,MAAL,CAAYC,KAAZ,GAAoB6D,UAApB,EAAnB;;AACA,cAAI4E,CAAC,KAAK,MAAV,EAAkB;AAChB,gBAAI5E,UAAU,KAAK,GAAnB,EAAwB;AACtB,mBAAK9D,MAAL,CAAYC,KAAZ,GAAoB0I,aAApB,CAAkC,GAAlC,EAAuC,YAAM;AAC3C,gBAAA,MAAI,CAAC3I,MAAL,CAAYC,KAAZ,GAAoB4F,YAApB,CAAiC,CAAjC,EAD2C,CACN;;AACtC,eAFD;AAGD,aAJD,MAIO,IAAI/B,UAAU,KAAK,GAAnB,EAAwB;AAC7B,mBAAK9D,MAAL,CAAYC,KAAZ,GAAoB4F,YAApB,CAAiC,CAAjC;AACD;;AACD,iBAAK2C,SAAL;AACD,WATD,MASO;AACL,gBAAI1E,UAAU,KAAK,GAAf,IAAsB4E,CAAC,KAAK,MAAhC,EAAwC;AACtC,mBAAK1I,MAAL,CAAYC,KAAZ,GAAoB4F,YAApB,CAAiC,CAAjC,EADsC,CACD;AACtC,aAFD,MAEO;AACL,kBAAM+C,KAAK,GAAG,KAAK7I,UAAL,CAAgB,IAAhB,EAAsB2I,CAAtB,CAAd;AACA,mBAAK1I,MAAL,CAAYC,KAAZ,GAAoB0I,aAApB,CAAkCC,KAAK,CAACpJ,QAAN,EAAlC,EAAoD,YAAM;AACxD,gBAAA,MAAI,CAACQ,MAAL,CAAYC,KAAZ,GAAoB4F,YAApB,CAAiC,CAAjC;;AACA,gBAAA,MAAI,CAAC7F,MAAL,CAAYC,KAAZ,GAAoBC,iBAApB,CAAsC,YAAtC;AACD,eAHD;AAID;;AACD,iBAAKkI,SAAL;AACD;AACF;AACF;AACF,KAtaM;AAuaP;AACApD,IAAAA,OAxaO,mBAwaC6D,GAxaD,EAwaM;AACX,UAAIC,MAAM,GAAGD,GAAG,CAACE,GAAjB;;AACA,UAAI,KAAKhL,UAAL,KAAoB,CAAxB,EAA2B;AACzB+K,QAAAA,MAAM,GAAGjN,GAAG,CAACgN,GAAG,CAACE,GAAL,EAAU,KAAK/K,UAAf,CAAZ;AACD;;AAED,aAAO;AACLiH,QAAAA,IAAI,EAAE4D,GAAG,CAAC3D,EAAJ,GAAS,IADV;AAEL8D,QAAAA,KAAK,EAAEH,GAAG,CAACG,KAFN;AAGLC,QAAAA,IAAI,EAAEJ,GAAG,CAACI,IAHL;AAILC,QAAAA,IAAI,EAAEL,GAAG,CAACK,IAJL;AAKLC,QAAAA,GAAG,EAAEN,GAAG,CAACM,GALJ;AAMLL,QAAAA,MAAM,EAANA;AANK,OAAP;AAQD,KAtbM;AAubPjD,IAAAA,YAvbO,wBAubM1C,IAvbN,EAubY;AAAA;;AACjB,WAAKjH,SAAL,GAAiBiH,IAAjB;AACA/C,MAAAA,UAAU,CAAC,YAAM;AACf,2BAAiD,MAAI,CAACe,KAAtD;AAAA,iDAAQC,UAAR;AAAA,YAAQA,UAAR,sCAAqB,IAArB;AAAA,kDAA2BE,UAA3B;AAAA,YAA2BA,UAA3B,uCAAwC,IAAxC;AACA,QAAA,MAAI,CAACnE,WAAL,GAAmBiE,UAAU,CAACC,WAAX,GAAyBC,UAAU,CAACD,WAAvD;AACD,OAHS,EAGP,GAHO,CAAV;AAID,KA7bM;AA8bP+H,IAAAA,eA9bO,2BA8bSjG,IA9bT,EA8be;AAAA;;AACpB,UAAIA,IAAI,KAAK,CAAb,EAAgB;AACd,YAAI,CAAC5F,MAAM,CAAC8L,OAAR,IAAmB,CAAC,KAAKvM,aAA7B,EAA4C;AAC1C,eAAKA,aAAL,GAAqB,IAArB;AACAlB,UAAAA,SAAS,WAAI0N,OAAO,CAACC,GAAR,CAAYC,QAAhB,8BAAT,CAA6DvB,IAA7D,CAAkE,YAAM;AACtE,YAAA,MAAI,CAACnL,aAAL,GAAqB,KAArB;AACA,YAAA,MAAI,CAACH,aAAL,GAAqB,KAArB;AACA,YAAA,MAAI,CAACM,YAAL,GAAoB,IAApB;;AACA,YAAA,MAAI,CAAC4I,YAAL,CAAkB1C,IAAlB;AACD,WALD;AAMD,SARD,MAQO;AACL,eAAK0C,YAAL,CAAkB1C,IAAlB;AACD;AACF,OAZD,MAYO;AACL,aAAK0C,YAAL,CAAkB1C,IAAlB;AACD;AACF,KA9cM;AA+cPsG,IAAAA,IA/cO,gBA+cFC,CA/cE,EA+cC;AACN,WAAK3M,QAAL,GAAgB,KAAhB;;AACA,UAAI,KAAKA,QAAT,EAAmB;AACjB,YAAM4M,GAAG,GAAGD,CAAC,CAACE,OAAd;;AACA,YAAID,GAAG,KAAK,EAAZ,EAAgB;AACd,eAAK5M,QAAL,GAAgB,KAAhB;AACD;AACF;AACF,KAvdM;AAwdP8M,IAAAA,MAxdO,oBAwdE;AACP,UAAI,CAAC,KAAK9M,QAAV,EAAoB;AAClB,aAAKA,QAAL,GAAgB,IAAhB;AACA,YAAM+M,OAAO,GAAG,KAAK3I,KAAL,CAAW4I,kBAA3B;;AACA,YAAID,OAAO,CAACE,iBAAZ,EAA+B;AAC7BF,UAAAA,OAAO,CAACE,iBAAR;AACD,SAFD,MAEO,IAAIF,OAAO,CAACG,oBAAZ,EAAkC;AACvCH,UAAAA,OAAO,CAACG,oBAAR;AACD,SAFM,MAEA,IAAIH,OAAO,CAACI,uBAAZ,EAAqC;AAC1CJ,UAAAA,OAAO,CAACI,uBAAR;AACD,SAFM,MAEA,IAAIJ,OAAO,CAACK,mBAAZ,EAAiC;AACtCL,UAAAA,OAAO,CAACK,mBAAR;AACD;AACF,OAZD,MAYO;AACL,aAAKpN,QAAL,GAAgB,KAAhB;;AACA,YAAIyD,QAAQ,CAAC4J,cAAb,EAA6B;AAC3B5J,UAAAA,QAAQ,CAAC4J,cAAT;AACD,SAFD,MAEO,IAAI5J,QAAQ,CAAC6J,mBAAb,EAAkC;AACvC7J,UAAAA,QAAQ,CAAC6J,mBAAT;AACD,SAFM,MAEA,IAAI7J,QAAQ,CAAC8J,oBAAb,EAAmC;AACxC9J,UAAAA,QAAQ,CAAC8J,oBAAT;AACD;AACF;AACF,KA/eM;AAgfP5J,IAAAA,UAhfO,wBAgfM;AACX;AACA,UAAI,KAAK3D,QAAT,EAAmB;AACjB,aAAKA,QAAL,GAAgBQ,MAAM,CAACgN,UAAP,IACX/J,QAAQ,CAACgK,kBADE,IAEXhK,QAAQ,CAACiK,mBAFd;AAGD;AACF,KAvfM;AAwfP;AACAC,IAAAA,WAzfO,uBAyfKvH,IAzfL,EAyfW;AAChB,UAAIwH,QAAQ,GAAGxL,UAAU,CAAC,KAAKjC,aAAN,CAAzB;;AACA,UAAI,KAAKiE,KAAL,CAAWG,UAAf,EAA2B;AACzB,YAAI6B,IAAI,KAAK,MAAb,EAAqB;AACnBwH,UAAAA,QAAQ,IAAI,KAAKxJ,KAAL,CAAWG,UAAX,CAAsBD,WAAtB,GAAoC,CAAhD;;AACA,cAAIsJ,QAAQ,GAAG,CAAf,EAAkB;AAChBA,YAAAA,QAAQ,GAAG,CAAX;AACD;AACF,SALD,MAKO;AACL,4BAAiD,KAAKxJ,KAAtD;AAAA,kDAAQC,UAAR;AAAA,cAAQA,UAAR,sCAAqB,IAArB;AAAA,kDAA2BE,UAA3B;AAAA,cAA2BA,UAA3B,sCAAwC,IAAxC;AACA,eAAKnE,WAAL,GAAmBiE,UAAU,CAACC,WAAX,GAAyBC,UAAU,CAACD,WAAvD;AACAsJ,UAAAA,QAAQ,IAAI,KAAKxJ,KAAL,CAAWG,UAAX,CAAsBD,WAAtB,GAAoC,CAAhD;;AACA,cAAIsJ,QAAQ,GAAG,CAAC,KAAKxN,WAArB,EAAkC;AAChCwN,YAAAA,QAAQ,GAAG,CAAC,KAAKxN,WAAjB;AACD;AACF;;AACD,aAAKD,aAAL,aAAwByN,QAAxB;AACD;AACF;AA3gBM;AAhNI,CAAf","sourcesContent":["import {\n  myStorage,\n  getCookie,\n  colorMap,\n  getHex,\n  imgMap,\n  logImg,\n  getScript,\n  nul,\n} from '@/utils';\n\nexport default {\n  name: 'tradingView',\n  data() {\n    return {\n      TvBoxHeight: '472px',\n      // 颜色主题\n      theme: 'theme_default',\n      // 图标类型 TV：1 Echart: 2\n      chartType: 1,\n      MywebSocket: null,\n      lastTimeS: myStorage.get('lastTimeS'),\n      language: getCookie('lan') ? getCookie('lan').split('_')[0] : '',\n      lTime: null,\n      fTime: 0,\n      isCreateWidget: false,\n      isshowLoading: true,\n      maskBg: true,\n      chartTypeHove: null,\n      loadingEchart: false,\n      isfullTv: false,\n      isfullTvsd: null,\n      echartLoaded: false,\n      // 市场横向滚动参数\n      slidePosition: 0,\n      maxPosition: 0,\n      lanArry: [\n        'ar',\n        'zh_TW',\n        'zh',\n        'cs',\n        'da_DK',\n        'nl_NL',\n        'en',\n        'et_EE',\n        'fr',\n        'de',\n        'el',\n        'he_IL',\n        'hu_HU',\n        'id_ID',\n        'it',\n        'ja',\n        'ko',\n        'ms_MY',\n        'no',\n        'fa',\n        'pl',\n        'pt',\n        'ro',\n        'ru',\n        'sk_SK',\n        'es',\n        'sv',\n        'th',\n        'tr',\n        'vi',\n      ],\n      // 合约全部币对\n      coSymbolAll: null,\n      // 是否是移动端\n      isMobile: window.isMobile,\n      // 隐藏K线工具选项\n      disabled_features_arr: [\n        'header_symbol_search',\n        'timeframes_toolbar',\n        'volume_force_overlay',\n        'header_saveload',\n        'header_resolutions',\n        'header_compare',\n        'header_screenshot',\n        'header_undo_redo',\n        'adaptive_logo',\n        'header_fullscreen_button',\n        'timezone_menu',\n        'scales_context_menu',\n        'legend_context_menu',\n        'symbol_search_hot_key',\n        // 'header_settings',\n        // 'header_widget',\n        // 'use_localstorage_for_settings',\n        // 'show_chart_property_page',\n        // 'timeframes_toolbar',\n        // 'symbol_info',\n        // 'header_widget_dom_node',\n        // 'header_indicators',\n        // 'header_widget',\n        // 'pane_context_menu',\n        // 'header_fullscreen_button',\n        // 'display_market_status',\n        // 'header_chart_type',\n      ],\n    };\n  },\n  computed: {\n    // 当前合约币对\n    symbolCurrent() {\n      return this.$store.state.future.coTypeSymbol;\n    },\n    // 数量单位类型Number（1标的货币 2张）\n    coUnitType() {\n      return this.$store.state.future.coUnitType;\n    },\n    // 当前合约面值\n    multiplier() {\n      return Number(this.$store.state.future.multiplier);\n    },\n    // 当前币对价格精度\n    pricefix() {\n      return this.$store.state.future.pricefix;\n    },\n    klineLogo() {\n      return imgMap.tradingViewLogo || '';\n    },\n    templateLayoutType() {\n      return this.$store.state.baseData.templateLayoutType;\n    },\n    baseTimeArry() {\n      try {\n        return this.$store.state.baseData.market.klineScale;\n      } catch (w) {\n        return [\n          '1min',\n          '5min',\n          '15min',\n          '30min',\n          '60min',\n          '4h',\n          '1day',\n          '1week',\n          '1month',\n        ];\n      }\n    },\n    timeArry() {\n      const a = [];\n      if (this.baseTimeArry.length) {\n        this.baseTimeArry.forEach((it) => {\n          const t = [];\n          if (it.indexOf('min') > -1) {\n            t.push(it, parseFloat(it));\n          } else if (\n            it.toLowerCase().indexOf('h') > -1\n            && it.indexOf('month') < 0\n          ) {\n            t.push(it, parseFloat(it) * 60);\n          } else if (it.indexOf('day') > -1) {\n            t.push(it, parseFloat(it) * 24 * 60);\n          } else if (it.indexOf('week') > -1) {\n            t.push(it, parseFloat(it) * 7 * 24 * 60);\n          } else if (it.indexOf('month') > -1) {\n            t.push(it, parseFloat(it) * 30 * 24 * 60);\n          }\n          a.push(t);\n        });\n      }\n      return a;\n    },\n    // 币币and杠杆 全部货币对\n    symbolAll() {\n      return this.$store.state.baseData.symbolAll;\n    },\n    themeTV() {\n      const theme = getCookie('cusSkin') || getCookie('defSkin') || '1';\n      const stheme = theme.toString() === '1' ? 'Dark' : 'Light';\n      return stheme;\n    },\n  },\n  watch: {\n    symbolCurrent(val, old) {\n      if (val && old) {\n        if (this.chartType === 1) {\n          this.isshowLoading = true;\n        }\n        if (window.tvWidget) {\n          const arr = this.symbolCurrent.split('_');\n          let symbolCurrent = arr[1];\n          if (arr && arr.length) {\n            if (arr[0] !== 'e' && arr[0] !== 's') {\n              symbolCurrent = `${arr[1]}-${arr[0]}`;\n            }\n          }\n          window.tvWidget.setSymbol(\n            symbolCurrent,\n            this.getTimeMin(true, this.lastTimeS),\n            () => {\n              this.widget.chart().executeActionById('chartReset');\n            },\n          );\n        }\n      }\n    },\n    coUnitType(val, old) {\n      if (val && old) {\n        if (this.chartType === 1) {\n          this.isshowLoading = true;\n        }\n        if (this.lastTimeS === 'Line') {\n          this.lastTimeS = '1min';\n        }\n        if (window.tvWidget) {\n          this.widget.setLanguage(this.language);\n          setTimeout(() => {\n            this.creatMA();\n          }, 1000);\n        }\n      }\n    },\n  },\n  methods: {\n    init() {\n      // 监听TV 是否是全屏状态\n      document.removeEventListener('fullscreenchange', this.quitfullTv);\n      document.addEventListener('fullscreenchange', this.quitfullTv);\n\n      if (this.lanArry.indexOf(this.language) <= -1) {\n        this.language = 'en';\n      }\n      if (getCookie('lan') === 'el_GR') {\n        this.language = 'zh_TW';\n      }\n      if (!myStorage.get('lastTimeS')) {\n        myStorage.set('lastTimeS', '1day');\n        this.lastTimeS = '1day';\n      }\n      // 监听 WebSocket 链接成功\n      this.$bus.$on('WEBSOCKET_ON_OPEN', (val) => {\n        this.MywebSocket = JSON.parse(JSON.stringify(val));\n        if (this.MywebSocket) {\n          this.isCreateWidget = false;\n          this.initTradingView();\n        }\n      });\n\n      // 隐藏loading\n      this.$bus.$on('HIDE_LOADING', () => {\n        this.isshowLoading = false;\n      });\n      // 市场 个数的超出宽度\n      this.maxPosition = this.$refs.topMenuBox.offsetWidth - this.$refs.topMenuBar.offsetWidth;\n    },\n    enter(index) {\n      this.chartTypeHove = index;\n    },\n    leave() {\n      this.chartTypeHove = null;\n    },\n    chartTypeShow(num) {\n      if (this.chartType === num || this.chartTypeHove === num) {\n        return true;\n      }\n      return false;\n    },\n    initTradingView() {\n      this.createWidget();\n    },\n    // tadingView 生命周期函数\n    udf_datafeed() {\n      const self = this;\n      return {\n        onReady(callback) {\n          const cnf = {\n            supported_resolutions: self.getTimeMin(false, 1), // 数组\n            supports_group_request: false,\n            supports_marks: true,\n            supports_search: false,\n            supports_timescale_marks: false,\n          };\n          setTimeout(() => {\n            callback(cnf);\n          }, 0);\n        },\n        // 切换币对后\n        resolveSymbol(symbolName, onSymbolResolvedCallback) {\n          setTimeout(() => {\n            onSymbolResolvedCallback({\n              name: symbolName,\n              'exchange-traded': '',\n              'exchange-listed': '',\n              minmov: 1,\n              minmov2: 0,\n              pointvalue: 1,\n              session: '0000-2400:1234567',\n              has_intraday: true,\n              has_no_volume: false,\n              volume_precision: 1,\n              description: symbolName.toUpperCase(),\n              type: 'bitcoin',\n              supported_resolutions: self.getTimeMin(false, 1),\n              pricescale: self.fixDepthNumber(),\n              ticker: symbolName.toUpperCase(),\n              timezone: window.jstz.determine().name(),\n            });\n          }, 0);\n        },\n        // 获取深度数据（k线无需请求深度）\n        calculateHistoryDepth() {\n          return undefined;\n        },\n        // tradingview 获取历史数据\n        getBars(\n          symbolInfo,\n          resolution,\n          from,\n          to,\n          onHistoryCallback,\n          onErrorCallback,\n          firstDataRequest,\n        ) {\n          if (firstDataRequest) {\n            self.lTime = false;\n          }\n          const lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'req',\n              symbol: self.symbolCurrent,\n              lastTimeS,\n              lTime: self.lTime,\n              number: 50,\n            });\n          }\n          self.$bus.$off('KLINE_DATA_REQ');\n          self.$bus.$on('KLINE_DATA_REQ', (data) => {\n            const wsData = JSON.parse(data);\n            self.fTime = 0;\n            const channelArr = wsData.channel.split('_');\n            const Ntime = channelArr[channelArr.length - 1];\n            const [, type, symbol] = wsData.channel.split('_');\n            const symbolType = `${type}_${symbol}`;\n            if (symbolType === self.symbolCurrent && lastTimeS === Ntime) {\n              const klData = wsData.data;\n              const arrData = [];\n              if (klData && klData.length) {\n                klData.forEach((item) => {\n                  arrData.push(self.setData(item));\n                });\n                if (firstDataRequest) {\n                  self.fTime = arrData[arrData.length - 1].time;\n                }\n                if (self.lTime === klData[0].id) {\n                  onHistoryCallback([], { noData: true });\n                  logImg({\n                    host: window.location.host,\n                    type: 'onHistoryCallback',\n                    path: window.location.href,\n                    ds: 'onHistoryCallback noDate',\n                    data: {\n                      symbol: self.symbolCurrent,\n                    },\n                    t: new Date().getTime(),\n                  });\n                } else {\n                  self.lTime = klData[0].id;\n                  onHistoryCallback(arrData);\n                }\n              } else {\n                if (self.secend < 3) {\n                  self.udf_datafeed().getBars(\n                    symbolInfo,\n                    resolution,\n                    from,\n                    to,\n                    onHistoryCallback,\n                    onErrorCallback,\n                    firstDataRequest,\n                  );\n                  self.secend += 1;\n                  return;\n                }\n                if (!self.lTime) {\n                  logImg({\n                    host: window.location.host,\n                    type: 'tradingView',\n                    path: window.location.href,\n                    ds: 'first onHistoryCallback noData',\n                    data,\n                    t: new Date().getTime(),\n                  });\n                }\n                onHistoryCallback([], { noData: true });\n              }\n            }\n          });\n          if (!self.isCreateWidget) {\n            self.widget_onChartReady();\n            self.widget.chart().setChartType(1);\n          }\n        },\n        // tradingview 获取实时数据\n        subscribeBars(symbolInfo, resolution, onRealtimeCallback) {\n          self.isshowLoading = false;\n          self.maskBg = false;\n          const lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'sub',\n              symbol: self.symbolCurrent,\n              lastTimeS,\n            });\n          }\n          self.$bus.$off('KLINE_DATA_SUB');\n          self.$bus.$on('KLINE_DATA_SUB', (data) => {\n            const wsData = JSON.parse(data);\n            // console.log('实时数据', wsData);\n            const channelArr = wsData.channel.split('_');\n            const Ntime = channelArr[channelArr.length - 1];\n            const [, type, symbol] = wsData.channel.split('_');\n            const symbolType = `${type}_${symbol}`;\n            if (\n              wsData.tick\n              && Ntime === lastTimeS\n              && symbolType === self.symbolCurrent\n            ) {\n              const tickData = self.setData(wsData.tick);\n              if (self.fTime < tickData.time) {\n                onRealtimeCallback(tickData);\n              }\n            }\n          });\n        },\n        // tradingview 取消订阅上一 币对 / 刻度\n        unsubscribeBars(subscriberUID) {\n          const arr = subscriberUID.split('_');\n          const symbol = `${arr[0]}_${arr[1]}`;\n          self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n            type: 'unsub',\n            symbol: symbol.toLowerCase(),\n            lastTimeS: self.getTimeMin(true, parseFloat(arr[2])),\n          });\n        },\n      };\n    },\n    // 创建 TradingView\n    createWidget() {\n      class F extends window.TradingView.widget {}\n      if (this.symbolCurrent) {\n        const symbolCurrent = this.symbolCurrent.split('_')[1];\n        window.tvWidget = new F({\n          debug: false,\n          autosize: true,\n          timezone: window.jstz.determine().name(),\n          symbol: symbolCurrent,\n          interval: this.getTimeMin(true, this.lastTimeS),\n          container_id: 'tv_chart_container', // DOM id\n          datafeed: this.udf_datafeed(), // 配置 生命周期\n          library_path: '/static/charting_library/', // 静态文件路径\n          locale: this.language, // 语言\n          disabled_features: this.disabled_features_arr,\n          enabled_features: [\n          // 'study_templates',\n            'hide_left_toolbar_by_default',\n          ],\n          charts_storage_url: `${window.location.protocol}//saveload.tradingview.com`,\n          charts_storage_api_version: '1.1',\n          client_id: 'tradingview.com',\n          user_id: 'public_user',\n          toolbar_bg: getHex(colorMap['a-6-bg']), // 工具栏底色\n          theme: this.themeTV,\n          studies_overrides: {\n            'volume.volume.color.0': getHex(colorMap['u-4-bg']),\n            'volume.volume.color.1': getHex(colorMap['u-1-bg']),\n            'volume.volume.transparency': 50,\n          },\n          overrides: {\n          // k线的颜色\n            volumePaneSize: 'small', // 成交量大小\n            'scalesProperties.fontSize': 12, // 图标区域xy轴 字体大小\n            'scalesProperties.textColor': getHex(colorMap['b-3-cl']), // 图标区域xy轴 文字颜色\n            'scalesProperties.lineColor': getHex(colorMap['a-3-bd']), // 图标区域xy轴颜色\n            'paneProperties.background': getHex(colorMap['a-6-bg']), // 图标区域 背景色\n            'paneProperties.vertGridProperties.color': getHex(colorMap['a-7-bg']), // 图标区域 表格纵轴颜色\n            'paneProperties.horzGridProperties.color': getHex(colorMap['a-7-bg']), // 图标区域 表格橫轴颜色\n            'paneProperties.crossHairProperties.color': getHex(\n              colorMap['b-2-bg'],\n            ), // 图标区域 鼠标十字线颜色\n            'paneProperties.legendProperties.showLegend': true, // 折叠信息\n            // 柱状图颜色设置\n            'mainSeriesProperties.candleStyle.upColor': getHex(colorMap['u-1-cl']),\n            'mainSeriesProperties.candleStyle.downColor': getHex(colorMap['u-4-cl']),\n            'mainSeriesProperties.candleStyle.drawWick': true,\n            'mainSeriesProperties.candleStyle.drawBorder': true,\n            'mainSeriesProperties.candleStyle.borderColor': '',\n            'mainSeriesProperties.candleStyle.borderUpColor': getHex(colorMap['u-1-cl']),\n            'mainSeriesProperties.candleStyle.borderDownColor': getHex(colorMap['u-4-cl']),\n            'mainSeriesProperties.candleStyle.wickUpColor': getHex(colorMap['u-1-cl']),\n            'mainSeriesProperties.candleStyle.wickDownColor': getHex(colorMap['u-4-cl']),\n            'mainSeriesProperties.candleStyle.barColorsOnPrevClose': !1,\n            // 分时图颜色设置\n            // 分时背景色渐变 上半部分\n            'mainSeriesProperties.areaStyle.color1': colorMap['a-15-bg'],\n            // 分时背景色渐变 下半部分\n            'mainSeriesProperties.areaStyle.color2': colorMap['a-17-bg'],\n            'mainSeriesProperties.areaStyle.linecolor': getHex(\n              colorMap['a-12-bd'],\n            ),\n            'mainSeriesProperties.areaStyle.linestyle': 0,\n            'mainSeriesProperties.areaStyle.linewidth': 2,\n            'mainSeriesProperties.areaStyle.priceSource': 'close',\n          },\n        });\n        this.widget = window.tvWidget;\n      }\n    },\n    // 格式化时间刻度\n    getTimeMin(only, type) {\n      if (only) {\n        let t = null;\n        if (this.timeArry.length) {\n          this.timeArry.forEach((item) => {\n            const s = item.indexOf(type);\n            if (s > -1) {\n              t = s === 0 ? item[1] : item[0];\n            }\n          });\n        }\n        return t;\n      }\n      const t = [];\n      this.timeArry.forEach((item) => {\n        t.push(item[type]);\n      });\n      return t;\n    },\n    // 精度计算\n    fixDepthNumber() {\n      const b = 10 ** this.pricefix;\n      return parseFloat(b.toString());\n    },\n    widget_onChartReady() {\n      this.isCreateWidget = true;\n      this.creatMA();\n      // ===== 默认样式皮肤修改 =====\n      const style = document.createElement('style');\n      /* eslint-disable */\n      const clas = document.createTextNode(\n        \".apply-common-tooltip,.wrap-1GG7GnNO- svg{fill:\" +\n          colorMap[\"b-3-cl\"] +\n          \"!important;color:\" +\n          colorMap[\"b-3-cl\"] +\n          \"!important;cursor: pointer;}.textColor .wrap-18oKCBRc- div,.wrap-18oKCBRc- .apply-common-tooltip:hover,.wrap-1GG7GnNO- svg:hover,.button-263WXsg--.isActive-2mI1-NUL- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-:hover{fill:\" +\n          colorMap[\"a-1-cl\"] +\n          \"!important;color:\" +\n          colorMap[\"a-1-cl\"] +\n          \"!important;}.container-3_8ayT2Q- .background-Q1Fcmxly-{fill: \" +\n          colorMap[\"b-2-cl\"] +\n          \"; stroke: \" +\n          colorMap[\"b-2-cl\"] +\n          \";}.container-3_8ayT2Q- .arrow-WcYWFXUn-, html.theme-dark .container-3_8ayT2Q- .arrow-WcYWFXUn-{stroke: \" +\n          colorMap[\"b-1-cl\"] +\n          \";}.feature-no-touch .container-3_8ayT2Q-:hover .background-Q1Fcmxly-{fill: \" +\n          colorMap[\"a-1-cl\"] +\n          \";stroke: \" +\n          colorMap[\"a-1-cl\"] +\n          \";}\"\n      );\n    /* eslint-enable */\n      style.append(clas);\n      this.widget.headerReady().then(() => {\n        this.widget.createButton().append(style);\n      });\n    },\n    creatMA() {\n      // ===== 创建移动均线 =====\n      this.widget\n        .chart()\n        .createStudy('Moving Average', false, false, [5], null, {\n          'plot.color': '#F5CB89',\n        });\n      this.widget\n        .chart()\n        .createStudy('Moving Average', false, false, [10], null, {\n          'plot.color': '#5FCFBF',\n        });\n      this.widget\n        .chart()\n        .createStudy('Moving Average', false, false, [30], null, {\n          'plot.color': '#DD89F5',\n        });\n    },\n    setMAShow() {\n      // ===== 显示移动均线 =====\n      const c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, true);\n      this.widget.chart().setEntityVisibility(c[1].id, true);\n      this.widget.chart().setEntityVisibility(c[2].id, true);\n    },\n    setMAHide() {\n      // ===== 隐藏移动均线 =====\n      const c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, false);\n      this.widget.chart().setEntityVisibility(c[1].id, false);\n      this.widget.chart().setEntityVisibility(c[2].id, false);\n    },\n    timeClike(v) {\n      if (v !== 'Line' && v !== '1min' && v !== this.lastTimeS) {\n        this.isshowLoading = true;\n      }\n      if (v !== this.lastTimeS) {\n        this.lastTimeS = v;\n        if (v === 'Line') {\n          myStorage.set('lastTimeS', '1min');\n        } else {\n          myStorage.set('lastTimeS', v);\n        }\n        this.$bus.$emit('LAST-TIMES', v);\n        if (this.isCreateWidget) {\n          const resolution = this.widget.chart().resolution();\n          if (v === 'Line') {\n            if (resolution !== '1') {\n              this.widget.chart().setResolution('1', () => {\n                this.widget.chart().setChartType(3); // 折线图\n              });\n            } else if (resolution === '1') {\n              this.widget.chart().setChartType(3);\n            }\n            this.setMAHide();\n          } else {\n            if (resolution === '1' && v === '1min') {\n              this.widget.chart().setChartType(1); // 蜡烛图\n            } else {\n              const timeS = this.getTimeMin(true, v);\n              this.widget.chart().setResolution(timeS.toString(), () => {\n                this.widget.chart().setChartType(1);\n                this.widget.chart().executeActionById('chartReset');\n              });\n            }\n            this.setMAShow();\n          }\n        }\n      }\n    },\n    // 格式化数据\n    setData(obj) {\n      let volume = obj.vol;\n      if (this.coUnitType === 1) {\n        volume = nul(obj.vol, this.multiplier);\n      }\n\n      return {\n        time: obj.id * 1000,\n        close: obj.close,\n        open: obj.open,\n        high: obj.high,\n        low: obj.low,\n        volume,\n      };\n    },\n    setChartType(type) {\n      this.chartType = type;\n      setTimeout(() => {\n        const { topMenuBox = null, topMenuBar = null } = this.$refs;\n        this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n      }, 500);\n    },\n    switchChartType(type) {\n      if (type === 2) {\n        if (!window.echarts && !this.loadingEchart) {\n          this.loadingEchart = true;\n          getScript(`${process.env.BASE_URL}static/js/echarts.min.js`).then(() => {\n            this.loadingEchart = false;\n            this.isshowLoading = false;\n            this.echartLoaded = true;\n            this.setChartType(type);\n          });\n        } else {\n          this.setChartType(type);\n        }\n      } else {\n        this.setChartType(type);\n      }\n    },\n    quit(e) {\n      this.isfullTv = false;\n      if (this.isfullTv) {\n        const key = e.keyCode;\n        if (key === 27) {\n          this.isfullTv = false;\n        }\n      }\n    },\n    fullTv() {\n      if (!this.isfullTv) {\n        this.isfullTv = true;\n        const element = this.$refs.tv_chart_container;\n        if (element.requestFullscreen) {\n          element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n          element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n          element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n          element.msRequestFullscreen();\n        }\n      } else {\n        this.isfullTv = false;\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    },\n    quitfullTv() {\n      // 监听TV 是否是全屏状态\n      if (this.isfullTv) {\n        this.isfullTv = window.fullScreen\n          || document.webkitIsFullScreen\n          || document.msFullscreenElement;\n      }\n    },\n    // 设置时间刻度的滚动\n    slideMarket(type) {\n      let position = parseFloat(this.slidePosition);\n      if (this.$refs.topMenuBar) {\n        if (type === 'left') {\n          position += this.$refs.topMenuBar.offsetWidth / 2;\n          if (position > 0) {\n            position = 0;\n          }\n        } else {\n          const { topMenuBox = null, topMenuBar = null } = this.$refs;\n          this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n          position -= this.$refs.topMenuBar.offsetWidth / 2;\n          if (position < -this.maxPosition) {\n            position = -this.maxPosition;\n          }\n        }\n        this.slidePosition = `${position}px`;\n      }\n    },\n  },\n\n};\n"]}]}