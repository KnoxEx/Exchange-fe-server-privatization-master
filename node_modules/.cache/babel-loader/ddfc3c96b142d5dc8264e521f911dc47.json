{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/krwManagement/krwManagement.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/krwManagement/krwManagement.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\n// @ is an alias to /src\nimport { imgMap, colorMap } from '@/utils';\nexport default {\n  name: 'krwManagement',\n  data: function data() {\n    return {\n      id: '',\n      // uid\n      mobileNumber: '',\n      // 手机号或者邮箱显示\n      authLevel: '',\n      // 身份/实名认证状态，0、未审核，1、通过，2、未通过  3未认证\n      nickName: '',\n      // 昵称\n      userName: '',\n      imgMap: imgMap,\n      colorMap: colorMap,\n      email: '',\n      // 邮箱\n      dialogType: 1,\n      is_krw_phone_auth: '',\n      // NICE认证 1：已完成手机认证   0：未完成手机认证\n      dialogFlag: false,\n      dialogConfirmLoading: false,\n      dialogConfirmDisabled: false,\n      checkErrorFlag: false,\n      checkValue: '',\n      promptText: this.$t('personal.dialog.name'),\n      errorText: this.$t('personal.dialog.text'),\n      oldName: '',\n      // 用户最初昵称\n      smsCode: false,\n      // false对应0 关闭 true对应1 开启(手机短信认证)\n      googleCode: false,\n      // false对应0 关闭 true对应1 开启(google认证)\n      switchValue: false,\n      // 手续费设置\n      clickType: true,\n      // 可点击状态\n      alertFlag: false,\n      feeCoinOpen: '0',\n      photo: imgMap.photo1,\n      krwAuthFlag: false,\n      // 身份认证对话框开关 -- krw定制\n      krwAuthType: '1',\n      // 身份认证对话框 select 选择值 -- krw定制\n      krwAlertFlag: false,\n      // krw 绑定银行卡前置条件校验\n      krwConfrimFlag: false,\n      // krw nice认证确认是否通过验证\n      // 邀请码信息\n      inviteCodeShow: true,\n      inviteUrlShow: true,\n      inviteCode: '',\n      inviteQECode: '',\n      inviteUrl: '',\n      titleText: this.$t('personal.dialog.title')\n    };\n  },\n  watch: {\n    userInfo: function userInfo(userinfo) {\n      // 监听userinfo接口\n      if (userinfo) {\n        this.getUserInfo(); // 获取用户信息\n      }\n\n      this.googleCode = !!Number(userinfo.googleStatus);\n      this.smsCode = !!Number(userinfo.isOpenMobileCheck);\n      this.id = userinfo.id;\n    },\n    modifyNickName: function modifyNickName(_modifyNickName) {\n      // 修改昵称逻辑操作\n      if (_modifyNickName !== null) {\n        if (_modifyNickName.text === 'success') {\n          // tip框提示\n          this.$bus.$emit('tip', {\n            text: _modifyNickName.msg,\n            type: 'success'\n          }); // 重新获取 userinfo\n\n          this.$store.dispatch('getUserInfo');\n          this.dialogConfirmFlag = false;\n          this.dialogFlag = false;\n          this.checkValue = this.oldName;\n          this.checkErrorFlag = false;\n          this.dialogConfirmLoading = false;\n          this.$store.dispatch('resetType');\n        } else {\n          // tip框提示错误\n          this.$bus.$emit('tip', {\n            text: _modifyNickName.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n          this.dialogConfirmLoading = false;\n        }\n      }\n    },\n    openMobileVerify: function openMobileVerify(_openMobileVerify) {\n      if (_openMobileVerify !== null) {\n        if (_openMobileVerify.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _openMobileVerify.msg,\n            type: 'success'\n          });\n          this.$store.dispatch('resetType');\n          this.$store.dispatch('getUserInfo');\n        } else {\n          this.$bus.$emit('tip', {\n            text: _openMobileVerify.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    },\n    updateFeeCoinOpen: function updateFeeCoinOpen(_updateFeeCoinOpen) {\n      if (_updateFeeCoinOpen !== null) {\n        var type = this.switchValue;\n\n        if (_updateFeeCoinOpen.text === 'success') {\n          if (type) {\n            this.$bus.$emit('tip', {\n              text: this.$t('personal.state.closeSuccess'),\n              type: 'success'\n            });\n            this.switchValue = !type;\n            this.$store.dispatch('resetType');\n          } else {\n            this.$bus.$emit('tip', {\n              text: this.$t('personal.state.openSuccess'),\n              type: 'success'\n            });\n            this.switchValue = !type;\n            this.$store.dispatch('resetType');\n          }\n        } else {\n          this.$bus.$emit('tip', {\n            text: _updateFeeCoinOpen.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    }\n  },\n  computed: {\n    // 身份认证对话框 select 列表 -- krw定制\n    krwAuthTypeOptions: function krwAuthTypeOptions() {\n      return [// 韩国\n      {\n        value: this.$t('personal.krw.authType'),\n        code: '1'\n      }, // 外国人\n      {\n        value: this.$t('personal.krw.authOther'),\n        code: '2'\n      }];\n    },\n    krwAlertData: function krwAlertData() {\n      var authFlag = false;\n\n      if (this.krwPhoneAuth === '1' || this.authLevel === 1) {\n        authFlag = true;\n      }\n\n      var arr = [// 请您先完成NICE认证或身份认证\n      {\n        text: this.$t('personal.krw.alertk'),\n        flag: authFlag\n      }, // OTP认证\n      {\n        text: this.$t('personal.krw.OTPk'),\n        flag: Boolean(this.googleCode)\n      }];\n      return arr;\n    },\n    krwUserBank: function krwUserBank() {\n      return this.$store.state.personal.krwUserBank;\n    },\n    // 该用户是否完成nice认证\n    krwPhoneAuth: function krwPhoneAuth() {\n      var str = '0';\n\n      if (this.userInfo && this.userInfo.is_krw_phone_auth) {\n        str = this.userInfo.is_krw_phone_auth.toString();\n      }\n\n      return str;\n    },\n    // 开启验证方式\n    coinsKrwOpen: function coinsKrwOpen() {\n      var publicInfo = this.$store.state.baseData.publicInfo;\n      var str = '0';\n\n      if (publicInfo && publicInfo.switch && publicInfo.switch.coins_krw_open) {\n        str = publicInfo.switch.coins_krw_open.toString();\n      }\n\n      return str;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    modifyNickName: function modifyNickName() {\n      return this.$store.state.personal.modifyNickName;\n    },\n    openMobileVerify: function openMobileVerify() {\n      return this.$store.state.personal.openMobileVerify;\n    },\n    updateFeeCoinOpen: function updateFeeCoinOpen() {\n      return this.$store.state.personal.updateFeeCoinOpen;\n    },\n    headImg: function headImg() {\n      return imgMap.head;\n    }\n  },\n  methods: {\n    init: function init() {\n      this.$store.dispatch('getUserInfo');\n    },\n    krwConfirmClick: function krwConfirmClick() {\n      this.krwConfrimFlag = false;\n      this.$store.dispatch('getUserInfo');\n    },\n    krwAlertClose: function krwAlertClose() {\n      this.krwAlertFlag = false;\n    },\n    // krw 绑定银行卡\n    krwBindBank: function krwBindBank() {\n      var authFlag = false;\n\n      if (this.krwPhoneAuth === '1' || this.authLevel === 1) {\n        authFlag = true;\n      }\n\n      if (this.googleCode && authFlag) {\n        this.$router.push('/personal/krwBank');\n      } else {\n        this.krwAlertFlag = true;\n      }\n    },\n    // nice证对话框 clone -- krw定制\n    krwAuthClose: function krwAuthClose() {\n      this.krwAuthFlag = false;\n    },\n    // nice对话框 confirm -- krw定制\n    krwAuthConfirm: function krwAuthConfirm() {\n      if (this.krwAuthType === '1') {\n        // window.open('/ex/personal/krwKyc');\n        if (this.krwPhoneAuth === '1') {\n          this.$router.push('/personal/idAuth');\n        } else {\n          this.krwAuthFlag = false; // 请您先完善手机实名认证\n\n          this.$bus.$emit('tip', {\n            text: this.$t('personal.krw.phonek'),\n            type: 'warning'\n          });\n        }\n      } else {\n        this.$router.push('/personal/idAuth');\n      }\n    },\n    // nice认证 点击认证按钮 -- krw定制\n    krwAuthentication: function krwAuthentication() {\n      this.krwConfrimFlag = true;\n      window.open('/personal/krwKyc', '_blank', 'menubar=0,scrollbars=1, resizable=1,status=1,titlebar=0,toolbar=0,location=1,height=614,width=432'); // window.open('/ex/personal/krwKyc');\n      // this.$router.push('/personal/krwKyc');\n    },\n    // nice认证 选择国籍 -- krw定制\n    krwAuthTypeChange: function krwAuthTypeChange(item) {\n      this.krwAuthType = item.code;\n    },\n    // 身份认证点击\n    krwUserAuthClick: function krwUserAuthClick() {\n      if (this.krwPhoneAuth === '1') {\n        this.$router.push('/personal/idAuth');\n      } else {\n        this.krwAuthFlag = true;\n      }\n    },\n    copyClick: function copyClick(name) {\n      if (name === 'inviteCode') {\n        this.copy(this.inviteCode);\n      } else {\n        this.copy(this.inviteUrl);\n      }\n    },\n    copy: function copy(str) {\n      // this.$bus.$emit('tip', { text: this.$t('personal.prompt.copySucces'), type: 'success' });\n      function save(e) {\n        e.clipboardData.setData('text/plain', str); // 下面会说到clipboardData对象\n\n        e.preventDefault(); // 阻止默认行为\n      }\n\n      document.addEventListener('copy', save);\n      document.execCommand('copy'); // 使文档处于可编辑状态，否则无效\n\n      document.removeEventListener('copy', save);\n    },\n    handMouseenter: function handMouseenter(name) {\n      if (name === 'inviteCode') {\n        this.inviteCodeShow = false;\n      } else {\n        this.inviteUrlShow = false;\n      }\n    },\n    handMouseleave: function handMouseleave(name) {\n      if (name === 'inviteCode') {\n        this.inviteCodeShow = true;\n      } else {\n        this.inviteUrlShow = true;\n      }\n    },\n    btnLink: function btnLink(link) {\n      if (link === 'google') {\n        this.$router.push('/personal/bindGoogle');\n      } else if (link === 'phone') {\n        this.$router.push('/personal/bindPhone');\n      } else if (link === 'email') {\n        this.$router.push('/personal/bindEmail');\n      } else if (link === 'krwBank') {\n        this.$router.push('/personal/krwBank');\n      } else {\n        this.$router.push('/personal/idAuth');\n      }\n    },\n    dialogClose: function dialogClose() {\n      // 关闭或取消时\n      this.dialogConfirmDisabled = false;\n      this.dialogConfirmFlag = false;\n      this.dialogFlag = false;\n      this.checkValue = this.oldName;\n      this.checkErrorFlag = false;\n    },\n    dialogConfirm: function dialogConfirm() {\n      // 点击确认时\n      if (this.dialogType === 2) {\n        this.dialogConfirmFlag = false;\n        this.dialogFlag = false;\n      } else {\n        var val = this.checkValue;\n\n        if (val.length === 0) {\n          // 为空提示\n          this.checkErrorFlag = true; // 昵称不能为空\n\n          this.errorText = this.$t('personal.userManagement.nameError1');\n        } else if (val.length > 10) {\n          this.checkErrorFlag = true; // 昵称长度不可超过十位\n\n          this.errorText = this.$t('personal.userManagement.nameError2');\n        } else {\n          // 非空提交\n          this.dialogConfirmLoading = true;\n          this.$store.dispatch('modifyNickName', {\n            nickname: val\n          });\n        }\n      }\n    },\n    inputChanges: function inputChanges(val) {\n      // 获取输入框内容\n      this.checkValue = val;\n    },\n    checkFocus: function checkFocus() {},\n    modify: function modify(num) {\n      if (num === 1) {\n        this.dialogType = 1;\n        this.titleText = this.$t('personal.dialog.title');\n      } else {\n        this.dialogType = 2;\n        this.titleText = this.$t('personal.userManagement.otherList.myInviteCod.text');\n      }\n\n      this.dialogConfirmFlag = true;\n      this.dialogFlag = true;\n    },\n    getUserInfo: function getUserInfo() {\n      if (this.userInfo !== null) {\n        // 邀请码信息\n        this.inviteCode = this.userInfo.inviteCode;\n        this.inviteQECode = this.userInfo.inviteQECode;\n        this.inviteUrl = this.userInfo.inviteUrl; // 邀请码信息\n\n        this.userName = this.userInfo.mobileNumber !== '' ? this.userInfo.mobileNumber : this.userInfo.email; // 有电话号码显示电话号码,无则显示邮箱\n\n        this.mobileNumber = this.userInfo.mobileNumber; // 电话号码\n\n        this.nickName = this.userInfo.nickName !== '' ? this.userInfo.nickName : this.$t('personal.userManagement.userName');\n        this.email = this.userInfo.email; // 邮箱\n\n        this.checkValue = this.userInfo.nickName;\n        this.oldName = this.userInfo.nickName;\n        this.authLevel = this.userInfo.authLevel; // 身份认证状态\n        // this.authLevel = 2\n\n        this.is_krw_phone_auth = this.userInfo.is_krw_phone_auth; // NICE认证\n\n        if (Number(this.userInfo.useFeeCoinOpen) === 1) {\n          // 是否开启手续费设置 1 开启 0 关闭\n          this.switchValue = true;\n        } else {\n          this.switchValue = false;\n        }\n\n        this.feeCoinOpen = this.userInfo.fee_coin_open;\n      }\n    },\n    openMobile: function openMobile() {\n      this.$store.dispatch('openMobileVerify');\n    },\n    switchChange: function switchChange() {\n      var _this = this;\n\n      if (this.clickType) {\n        this.clickType = false;\n        setTimeout(function () {\n          _this.clickType = true;\n        }, 1000);\n\n        if (this.switchValue) {\n          var info = {\n            useFeeCoinOpen: '0'\n          };\n          this.$store.dispatch('updateFeeCoinOpen', info);\n        } else {\n          var _info = {\n            useFeeCoinOpen: '1'\n          };\n          this.$store.dispatch('updateFeeCoinOpen', _info);\n        }\n      }\n    },\n    changePassword: function changePassword() {\n      if (this.smsCode === true || this.googleCode === true) {\n        this.$router.push('/personal/changePassword');\n      } else {\n        this.alertFlag = true;\n      }\n    },\n    changeEmail: function changeEmail() {\n      if (this.smsCode === true || this.googleCode === true) {\n        this.$router.push('/personal/changeEmail');\n      } else {\n        this.alertFlag = true;\n      }\n    },\n    alertClose: function alertClose() {\n      this.alertFlag = false;\n    },\n    alertGo: function alertGo() {\n      this.alertFlag = false;\n    }\n  }\n};",null]}