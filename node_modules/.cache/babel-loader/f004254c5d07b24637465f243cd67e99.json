{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/exccAuthorization/exccAuthorization.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/personal/exccAuthorization/exccAuthorization.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\nimport { fixInput } from '@/utils';\nimport countryMinix from \"../../countryList/countryList\";\nexport default {\n  name: 'exccAuthorization',\n  mixins: [countryMinix],\n  components: {},\n  data: function data() {\n    return {\n      isLoading: true,\n      aliasname: '',\n      sex: '',\n      uinfin: '',\n      name: '',\n      nationality: '',\n      residentialstatus: '',\n      dob: '',\n      birthcountry: '',\n      regadd: '',\n      mobileno: '',\n      mailadd: '',\n      income: '0',\n      // 收入来源\n      code: '',\n      active: '',\n      qtTExt: '' // 收入来源选择其他的文案\n\n    };\n  },\n  watch: {\n    mobileno: function mobileno(val) {\n      this.mobileno = fixInput(val, 0);\n    },\n    authRealname: function authRealname(_authRealname) {\n      if (_authRealname !== null) {\n        if (_authRealname.text === 'success') {\n          this.$bus.$emit('tip', {\n            text: _authRealname.msg,\n            type: 'success'\n          });\n          this.active = '1';\n        } else {\n          this.$bus.$emit('tip', {\n            text: _authRealname.msg,\n            type: 'error'\n          });\n          this.$store.dispatch('resetType');\n        }\n      }\n    },\n    dob: function dob(val) {\n      if (val && this.ageLimit && !this.validateAge()) {\n        this.$bus.$emit('tip', {\n          text: \"\\u60A8\\u9700\\u8981\\u5E74\\u6EE1\".concat(this.ageLimit, \"\\u5C81\\u624D\\u80FD\\u5728\\u5E73\\u53F0\\u8BA4\\u8BC1\"),\n          type: 'error'\n        });\n      }\n    }\n  },\n  computed: {\n    exccKycConfig: function exccKycConfig() {\n      return this.$store.state.personal.exccKycConfig;\n    },\n    ageLimit: function ageLimit() {\n      return this.exccKycConfig ? Number(this.exccKycConfig.data.ageLimit) : 0;\n    },\n    authRealname: function authRealname() {\n      return this.$store.state.personal.authRealname;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    authLevel: function authLevel() {\n      return this.userInfo ? this.userInfo.authLevel : '';\n    },\n    disabled: function disabled() {\n      if (this.dob && !this.validateAge()) {\n        return true;\n      }\n\n      if (this.income === '6' && !this.qtTExt) {\n        return true;\n      }\n\n      return !(this.mobileno && this.mailadd);\n    },\n    // 收入来源列表\n    incomeList: function incomeList() {\n      return [{\n        code: '0',\n        value: this.$t('personal.exccAuthorization.income1')\n      }, {\n        code: '1',\n        value: this.$t('personal.exccAuthorization.income2')\n      }, {\n        code: '2',\n        value: this.$t('personal.exccAuthorization.income3')\n      }, {\n        code: '3',\n        value: this.$t('personal.exccAuthorization.income4')\n      }, {\n        code: '4',\n        value: this.$t('personal.exccAuthorization.income5')\n      }, {\n        code: '5',\n        value: this.$t('personal.exccAuthorization.income6')\n      }, {\n        code: '6',\n        value: this.$t('personal.exccAuthorization.income7')\n      }];\n    }\n  },\n  methods: {\n    init: function init() {\n      this.code = this.$route.query.code;\n\n      if (this.code) {\n        this.getData();\n      }\n\n      if (!this.exccKycConfig) {\n        this.$store.dispatch('exccKycConfig');\n      }\n    },\n    getData: function getData() {\n      var _this = this;\n\n      this.axios({\n        url: '/kyc/singPass/getInfo',\n        method: 'post',\n        header: {},\n        params: {\n          code: this.code\n        }\n      }).then(function (info) {\n        _this.isLoading = false;\n\n        if (info.code === '0') {\n          if (info.data) {\n            _this.aliasname = info.data.aliasname;\n            _this.sex = info.data.sex;\n            _this.uinfin = info.data.uinfin;\n            _this.name = info.data.name;\n            _this.nationality = info.data.nationality;\n            _this.residentialstatus = info.data.residentialstatus;\n            _this.dob = info.data.dob;\n            _this.birthcountry = info.data.birthcountry;\n            _this.regadd = info.data.regadd;\n            _this.mobileno = info.data.mobileno;\n            _this.mailadd = info.data.mailadd;\n            _this.qtTExt = info.data.otherIncomeDesc;\n            _this.income = '0';\n          }\n        } else {\n          _this.$bus.$emit('tip', {\n            text: info.msg,\n            type: 'error'\n          });\n        }\n      }).catch(function () {});\n    },\n    inputChanges: function inputChanges(value, name) {\n      this[name] = value.trim();\n    },\n    incomeChange: function incomeChange(item) {\n      this.income = item.code;\n    },\n    submitData: function submitData() {\n      var info = {\n        mobileno: this.mobileno,\n        mailadd: this.mailadd,\n        income: this.income,\n        otherIncomeDesc: this.qtTExt\n      };\n      this.$store.dispatch('singPassVerifyAuth', info);\n    },\n    validateAge: function validateAge() {\n      if (!this.ageLimit) {\n        return true;\n      }\n\n      var birthday1 = this.dob.split('-');\n      var convert2Date = new Date(birthday1[0], birthday1[1], birthday1[2]);\n      var nowDate = new Date(); // 获取当前时间\n\n      var year = nowDate.getFullYear();\n      var month = nowDate.getMonth() + 1;\n      var date = nowDate.getDate();\n      nowDate = new Date(year, month, date);\n      var age = nowDate.getTime() - convert2Date.getTime(); // 毫秒\n\n      var leapYear = 0; // 有多少个闰年\n\n      for (var i = 0; i <= this.ageLimit; i += 1) {\n        if (i % 4 === 0 && i % 100 !== 0 || i % 400 === 0) {\n          leapYear += 1;\n        }\n      }\n\n      var YearNumber = this.ageLimit - leapYear;\n      var betweenNumer = 86400000 * 365 * YearNumber + 86400000 * 366 * leapYear;\n      return age >= betweenNumer;\n    }\n  }\n};",null]}