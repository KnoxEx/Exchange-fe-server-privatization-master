{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/personal/krwBank/krwBank.js","dependencies":[{"path":"/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/personal/krwBank/krwBank.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.to-string\";\nexport default {\n  name: 'changePassword',\n  data: function data() {\n    return {\n      userName: '',\n      // 户名\n      backType: '',\n      // 开户行\n      bankAccount: '',\n      // 银行账号\n      // 开户行列表\n      backTypeOptions: [],\n      smsCode: '',\n      googleCode: '',\n      submitLoading: false // 提交按钮loading\n\n    };\n  },\n  watch: {\n    userInfo: function userInfo(v) {\n      if (v) {\n        if (v.realName.length) {\n          this.userName = v.realName;\n        } else {\n          this.userName = v.phone_auth_name;\n        }\n\n        this.initStatus();\n      }\n    }\n  },\n  computed: {\n    // 用户是否开启谷歌\n    OpenGoogle: function OpenGoogle() {\n      var flag = false;\n      var userInfo = this.$store.state.baseData.userInfo;\n\n      if (userInfo && userInfo.googleStatus.toString() === '1') {\n        flag = true;\n      }\n\n      return flag;\n    },\n    // 该用户是否完成nice认证\n    krwPhoneAuth: function krwPhoneAuth() {\n      var str = '0';\n\n      if (this.userInfo && this.userInfo.is_krw_phone_auth) {\n        str = this.userInfo.is_krw_phone_auth.toString();\n      }\n\n      return str;\n    },\n    authLevel: function authLevel() {\n      var str = '';\n\n      if (this.userInfo) {\n        str = this.userInfo.authLevel.toString();\n      }\n\n      return str;\n    },\n    krwUserBank: function krwUserBank() {\n      return this.$store.state.personal.krwUserBank;\n    },\n    regExps: function regExps() {\n      return this.$store.state.regExp;\n    },\n    userInfo: function userInfo() {\n      return this.$store.state.baseData.userInfo;\n    },\n    // 用户是否开启手机\n    OpenMobile: function OpenMobile() {\n      var flag = false;\n      var userInfo = this.$store.state.baseData.userInfo;\n\n      if (userInfo && userInfo.isOpenMobileCheck.toString() === '1') {\n        flag = true;\n      }\n\n      return flag;\n    },\n    // 银行账号\n    bankAccountFlag: function bankAccountFlag() {\n      return this.regExps.number.test(this.bankAccount);\n    },\n    // 银行账号是否为错误\n    bankAccountErrorFlag: function bankAccountErrorFlag() {\n      if (this.bankAccount.length !== 0 && !this.bankAccountFlag) return true;\n      return false;\n    },\n    // 短信验证码 -- 正则验证\n    smsCodeFlag: function smsCodeFlag() {\n      return this.regExps.verification.test(this.smsCode);\n    },\n    // 银行账号是否为错误\n    smsCodeFlagErrorFlag: function smsCodeFlagErrorFlag() {\n      if (this.smsCode.length !== 0 && !this.smsCodeFlag) return true;\n      return false;\n    },\n    // 谷歌验证码 -- 正则验证\n    googleCodeFlag: function googleCodeFlag() {\n      return this.regExps.verification.test(this.googleCode);\n    },\n    // 银行账号是否为错误\n    googleCodeFlagErrorFlag: function googleCodeFlagErrorFlag() {\n      if (this.googleCode.length !== 0 && !this.googleCodeFlag) return true;\n      return false;\n    },\n    submitDisabled: function submitDisabled() {\n      var phone = true;\n      var google = true;\n\n      if (this.OpenMobile) {\n        phone = this.smsCodeFlag;\n      }\n\n      if (this.OpenGoogle) {\n        google = this.googleCodeFlag;\n      }\n\n      if (this.backType.length && this.bankAccountFlag && phone && google || this.submitLoading) {\n        return false;\n      }\n\n      return true;\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      if (this.userInfo) {\n        if (this.userInfo.realName.length) {\n          this.userName = this.userInfo.realName;\n        } else {\n          this.userName = this.userInfo.phone_auth_name;\n        }\n\n        this.initStatus();\n      }\n\n      this.axios({\n        url: 'bank/all',\n        method: 'post'\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          var arr = [];\n          data.data.forEach(function (item) {\n            arr.push({\n              value: item.name,\n              code: item.id.toString()\n            });\n          });\n\n          if (arr.length) {\n            _this.backType = arr[0].code;\n          }\n\n          _this.backTypeOptions = arr;\n        }\n      });\n    },\n    initStatus: function initStatus() {\n      var authFlag = false;\n\n      if (this.krwPhoneAuth === '1' || this.authLevel === '1') {\n        authFlag = true;\n      }\n\n      if (!this.OpenGoogle || !authFlag) {\n        this.$router.push('/personal/userManagement');\n      }\n    },\n    submit: function submit() {\n      var _this2 = this;\n\n      this.submitLoading = true;\n      var url = 'user/bank/add'; // this.userName = '1'\n\n      var params = {\n        bankNo: this.backType,\n        // 开户行id\n        cardNo: this.bankAccount,\n        // 银行账号\n        name: this.userName,\n        // 姓名\n        smsAuthCode: this.smsCode,\n        googleCode: this.googleCode\n      }; // 修改\n\n      if (this.krwUserBank) {\n        url = 'user/bank/edit';\n        params.id = this.krwUserBank.id;\n      }\n\n      this.axios({\n        url: url,\n        params: params\n      }).then(function (data) {\n        _this2.submitLoading = false;\n\n        if (data.code.toString() !== '0') {\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        } else {\n          _this2.$store.dispatch('krwGetUserBank');\n\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n\n          _this2.$router.push('/personal/userManagement');\n        }\n      });\n    },\n    getCodeClick: function getCodeClick() {\n      var _this3 = this;\n\n      var operationType = '30';\n\n      if (this.krwUserBank) {\n        operationType = '31';\n      }\n\n      this.axios({\n        url: 'v4/common/smsValidCode',\n        params: {\n          operationType: operationType\n        }\n      }).then(function (data) {\n        if (data.code.toString() !== '0') {\n          setTimeout(function () {\n            // 倒计时重置\n            _this3.$bus.$emit('getCode-clear', 'smsCode'); // tip框提示错误\n\n\n            _this3.$bus.$emit('tip', {\n              text: data.msg,\n              type: 'error'\n            });\n          }, 2000);\n        } else {\n          // 短信已发送，请注意查收\n          _this3.$bus.$emit('tip', {\n            text: _this3.$t('assets.addressMent.phoneSendSuccess'),\n            type: 'success'\n          });\n        }\n      });\n    },\n    inputChanges: function inputChanges(value, name) {\n      this[name] = value;\n    },\n    backTypeChange: function backTypeChange(item) {\n      this.backType = item.code;\n    }\n  }\n};",null]}