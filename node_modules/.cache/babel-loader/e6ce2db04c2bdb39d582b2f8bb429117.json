{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/coTrade/tradingView/tradingView.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/coTrade/tradingView/tradingView.js","mtime":1642484933483},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.reflect.construct\";\nimport _classCallCheck from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _inherits from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _slicedToArray from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.regexp.split\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { myStorage, getCookie, colorMap, getHex, imgMap, logImg, getScript, nul } from '@/utils';\nexport default {\n  name: 'tradingView',\n  data: function data() {\n    return {\n      TvBoxHeight: '697px',\n      // 颜色主题\n      theme: 'theme_default',\n      // 图标类型 TV：1 Echart: 2\n      chartType: 1,\n      MywebSocket: null,\n      lastTimeS: myStorage.get('lastTimeS'),\n      timeLable: myStorage.get('lastTimeS'),\n      language: getCookie('lan') ? getCookie('lan').split('_')[0] : '',\n      lTime: null,\n      fTime: 0,\n      isCreateWidget: false,\n      isshowLoading: true,\n      maskBg: true,\n      chartTypeHove: null,\n      loadingEchart: false,\n      isfullTv: false,\n      isfullTvsd: null,\n      echartLoaded: false,\n      // 市场横向滚动参数\n      slidePosition: 0,\n      maxPosition: 0,\n      lanArry: ['ar', 'zh_TW', 'zh', 'cs', 'da_DK', 'nl_NL', 'en', 'et_EE', 'fr', 'de', 'el', 'he_IL', 'hu_HU', 'id_ID', 'it', 'ja', 'ko', 'ms_MY', 'no', 'fa', 'pl', 'pt', 'ro', 'ru', 'sk_SK', 'es', 'sv', 'th', 'tr', 'vi'],\n      // 合约全部币对\n      coSymbolAll: null,\n      // 是否是移动端\n      isMobile: window.isMobile,\n      // 隐藏K线工具选项\n      disabled_features_arr: ['header_symbol_search', 'timeframes_toolbar', 'volume_force_overlay', 'header_saveload', 'header_resolutions', 'header_compare', 'header_screenshot', 'header_undo_redo', 'adaptive_logo', 'header_fullscreen_button', 'timezone_menu', 'scales_context_menu', 'legend_context_menu', 'symbol_search_hot_key' // 'header_settings',\n      // 'header_widget',\n      // 'use_localstorage_for_settings',\n      // 'show_chart_property_page',\n      // 'timeframes_toolbar',\n      // 'symbol_info',\n      // 'header_widget_dom_node',\n      // 'header_indicators',\n      // 'header_widget',\n      // 'pane_context_menu',\n      // 'header_fullscreen_button',\n      // 'display_market_status',\n      // 'header_chart_type',\n      ]\n    };\n  },\n  computed: {\n    // 当前合约币对\n    symbolCurrent: function symbolCurrent() {\n      return this.$store.state.future.coTypeSymbol;\n    },\n    // 数量单位类型Number（1标的货币 2张）\n    coUnitType: function coUnitType() {\n      return this.$store.state.future.coUnitType;\n    },\n    // 当前合约面值\n    multiplier: function multiplier() {\n      return Number(this.$store.state.future.multiplier);\n    },\n    // 当前币对价格精度\n    pricefix: function pricefix() {\n      return this.$store.state.future.pricefix;\n    },\n    klineLogo: function klineLogo() {\n      return imgMap.tradingViewLogo || '';\n    },\n    templateLayoutType: function templateLayoutType() {\n      return this.$store.state.baseData.templateLayoutType;\n    },\n    baseTimeArry: function baseTimeArry() {\n      try {\n        return this.$store.state.baseData.market.klineScale;\n      } catch (w) {\n        return ['1min', '5min', '15min', '30min', '60min', '4h', '1day', '1week', '1month'];\n      }\n    },\n    timeArry: function timeArry() {\n      var a = [];\n\n      if (this.baseTimeArry.length) {\n        this.baseTimeArry.forEach(function (it) {\n          var t = [];\n\n          if (it.indexOf('min') > -1) {\n            t.push(it, parseFloat(it));\n          } else if (it.toLowerCase().indexOf('h') > -1 && it.indexOf('month') < 0) {\n            t.push(it, parseFloat(it) * 60);\n          } else if (it.indexOf('day') > -1) {\n            t.push(it, parseFloat(it) * 24 * 60);\n          } else if (it.indexOf('week') > -1) {\n            t.push(it, parseFloat(it) * 7 * 24 * 60);\n          } else if (it.indexOf('month') > -1) {\n            t.push(it, parseFloat(it) * 30 * 24 * 60);\n          }\n\n          a.push(t);\n        });\n      }\n\n      return a;\n    },\n    // 币币and杠杆 全部货币对\n    symbolAll: function symbolAll() {\n      return this.$store.state.baseData.symbolAll;\n    },\n    themeTV: function themeTV() {\n      var theme = getCookie('cusSkin') || getCookie('defSkin') || '1';\n      var stheme = theme.toString() === '1' ? 'Dark' : 'Light';\n      return 'Light';\n    }\n  },\n  watch: {\n    symbolCurrent: function symbolCurrent(val, old) {\n      var _this = this;\n\n      if (val && old) {\n        if (this.chartType === 1) {\n          this.isshowLoading = true;\n        }\n\n        if (window.tvWidget) {\n          var arr = this.symbolCurrent.split('_');\n          var symbolCurrent = arr[1];\n\n          if (arr && arr.length) {\n            if (arr[0] !== 'e' && arr[0] !== 's') {\n              symbolCurrent = \"\".concat(arr[1], \"-\").concat(arr[0]);\n            }\n          }\n\n          window.tvWidget.setSymbol(symbolCurrent, this.getTimeMin(true, this.lastTimeS), function () {\n            _this.widget.chart().executeActionById('chartReset');\n          });\n        }\n      }\n    },\n    coUnitType: function coUnitType(val, old) {\n      var _this2 = this;\n\n      if (val && old) {\n        if (this.chartType === 1) {\n          this.isshowLoading = true;\n        }\n\n        if (this.lastTimeS === 'Line') {\n          this.lastTimeS = '1min';\n        }\n\n        if (window.tvWidget) {\n          this.widget.setLanguage(this.language);\n          setTimeout(function () {\n            _this2.creatMA();\n          }, 1000);\n        }\n      }\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this3 = this;\n\n      // 监听TV 是否是全屏状态\n      document.removeEventListener('fullscreenchange', this.quitfullTv);\n      document.addEventListener('fullscreenchange', this.quitfullTv);\n\n      if (this.lanArry.indexOf(this.language) <= -1) {\n        this.language = 'en';\n      }\n\n      if (getCookie('lan') === 'el_GR') {\n        this.language = 'zh_TW';\n      }\n\n      if (!myStorage.get('lastTimeS')) {\n        myStorage.set('lastTimeS', '1day');\n        this.lastTimeS = '1day';\n      } // 监听 WebSocket 链接成功\n\n\n      this.$bus.$on('WEBSOCKET_ON_OPEN', function (val) {\n        _this3.MywebSocket = JSON.parse(JSON.stringify(val));\n\n        if (_this3.MywebSocket) {\n          _this3.isCreateWidget = false;\n\n          _this3.initTradingView();\n        }\n      }); // 隐藏loading\n\n      this.$bus.$on('HIDE_LOADING', function () {\n        _this3.isshowLoading = false;\n      }); // 市场 个数的超出宽度\n      // this.maxPosition = this.$refs.topMenuBox.offsetWidth - this.$refs.topMenuBar.offsetWidth;\n    },\n    enter: function enter(index) {\n      this.chartTypeHove = index;\n    },\n    leave: function leave() {\n      this.chartTypeHove = null;\n    },\n    chartTypeShow: function chartTypeShow(num) {\n      if (this.chartType === num || this.chartTypeHove === num) {\n        return true;\n      }\n\n      return false;\n    },\n    initTradingView: function initTradingView() {\n      this.createWidget();\n    },\n    // tadingView 生命周期函数\n    udf_datafeed: function udf_datafeed() {\n      var self = this;\n      return {\n        onReady: function onReady(callback) {\n          var cnf = {\n            supported_resolutions: self.getTimeMin(false, 1),\n            // 数组\n            supports_group_request: false,\n            supports_marks: true,\n            supports_search: false,\n            supports_timescale_marks: false\n          };\n          setTimeout(function () {\n            callback(cnf);\n          }, 0);\n        },\n        // 切换币对后\n        resolveSymbol: function resolveSymbol(symbolName, onSymbolResolvedCallback) {\n          setTimeout(function () {\n            onSymbolResolvedCallback({\n              name: symbolName,\n              'exchange-traded': '',\n              'exchange-listed': '',\n              minmov: 1,\n              minmov2: 0,\n              pointvalue: 1,\n              session: '0000-2400:1234567',\n              has_intraday: true,\n              has_no_volume: false,\n              volume_precision: 1,\n              description: symbolName.toUpperCase(),\n              type: 'bitcoin',\n              supported_resolutions: self.getTimeMin(false, 1),\n              pricescale: self.fixDepthNumber(),\n              ticker: symbolName.toUpperCase(),\n              timezone: window.jstz.determine().name()\n            });\n          }, 0);\n        },\n        // 获取深度数据（k线无需请求深度）\n        calculateHistoryDepth: function calculateHistoryDepth() {\n          return undefined;\n        },\n        // tradingview 获取历史数据\n        getBars: function getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest) {\n          if (firstDataRequest) {\n            self.lTime = false;\n          }\n\n          var lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'req',\n              symbol: self.symbolCurrent,\n              lastTimeS: lastTimeS,\n              lTime: self.lTime,\n              number: 50\n            });\n          }\n\n          self.$bus.$off('KLINE_DATA_REQ');\n          self.$bus.$on('KLINE_DATA_REQ', function (data) {\n            var wsData = JSON.parse(data);\n            self.fTime = 0;\n            var channelArr = wsData.channel.split('_');\n            var Ntime = channelArr[channelArr.length - 1];\n\n            var _wsData$channel$split = wsData.channel.split('_'),\n                _wsData$channel$split2 = _slicedToArray(_wsData$channel$split, 3),\n                type = _wsData$channel$split2[1],\n                symbol = _wsData$channel$split2[2];\n\n            var symbolType = \"\".concat(type, \"_\").concat(symbol);\n\n            if (symbolType === self.symbolCurrent && lastTimeS === Ntime) {\n              var klData = wsData.data;\n              var arrData = [];\n\n              if (klData && klData.length) {\n                klData.forEach(function (item) {\n                  arrData.push(self.setData(item));\n                });\n\n                if (firstDataRequest) {\n                  self.fTime = arrData[arrData.length - 1].time;\n                }\n\n                if (self.lTime === klData[0].id) {\n                  onHistoryCallback([], {\n                    noData: true\n                  });\n                  logImg({\n                    host: window.location.host,\n                    type: 'onHistoryCallback',\n                    path: window.location.href,\n                    ds: 'onHistoryCallback noDate',\n                    data: {\n                      symbol: self.symbolCurrent\n                    },\n                    t: new Date().getTime()\n                  });\n                } else {\n                  self.lTime = klData[0].id;\n                  onHistoryCallback(arrData);\n                }\n              } else {\n                if (self.secend < 3) {\n                  self.udf_datafeed().getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest);\n                  self.secend += 1;\n                  return;\n                }\n\n                if (!self.lTime) {\n                  logImg({\n                    host: window.location.host,\n                    type: 'tradingView',\n                    path: window.location.href,\n                    ds: 'first onHistoryCallback noData',\n                    data: data,\n                    t: new Date().getTime()\n                  });\n                }\n\n                onHistoryCallback([], {\n                  noData: true\n                });\n              }\n            }\n          });\n\n          if (!self.isCreateWidget) {\n            self.widget_onChartReady();\n            self.widget.chart().setChartType(1);\n          }\n        },\n        // tradingview 获取实时数据\n        subscribeBars: function subscribeBars(symbolInfo, resolution, onRealtimeCallback) {\n          self.isshowLoading = false;\n          self.maskBg = false;\n          var lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\n\n          if (self.MywebSocket) {\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n              type: 'sub',\n              symbol: self.symbolCurrent,\n              lastTimeS: lastTimeS\n            });\n          }\n\n          self.$bus.$off('KLINE_DATA_SUB');\n          self.$bus.$on('KLINE_DATA_SUB', function (data) {\n            var wsData = JSON.parse(data); // console.log('实时数据', wsData);\n\n            var channelArr = wsData.channel.split('_');\n            var Ntime = channelArr[channelArr.length - 1];\n\n            var _wsData$channel$split3 = wsData.channel.split('_'),\n                _wsData$channel$split4 = _slicedToArray(_wsData$channel$split3, 3),\n                type = _wsData$channel$split4[1],\n                symbol = _wsData$channel$split4[2];\n\n            var symbolType = \"\".concat(type, \"_\").concat(symbol);\n\n            if (wsData.tick && Ntime === lastTimeS && symbolType === self.symbolCurrent) {\n              var tickData = self.setData(wsData.tick);\n\n              if (self.fTime < tickData.time) {\n                onRealtimeCallback(tickData);\n              }\n            }\n          });\n        },\n        // tradingview 取消订阅上一 币对 / 刻度\n        unsubscribeBars: function unsubscribeBars(subscriberUID) {\n          var arr = subscriberUID.split('_');\n          var symbol = \"\".concat(arr[0], \"_\").concat(arr[1]);\n          self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\n            type: 'unsub',\n            symbol: symbol.toLowerCase(),\n            lastTimeS: self.getTimeMin(true, parseFloat(arr[2]))\n          });\n        }\n      };\n    },\n    // 创建 TradingView\n    createWidget: function createWidget() {\n      var F = /*#__PURE__*/function (_window$TradingView$w) {\n        _inherits(F, _window$TradingView$w);\n\n        var _super = _createSuper(F);\n\n        function F() {\n          _classCallCheck(this, F);\n\n          return _super.apply(this, arguments);\n        }\n\n        return F;\n      }(window.TradingView.widget);\n\n      if (this.symbolCurrent) {\n        var symbolCurrent = this.symbolCurrent.split('_')[1];\n        window.tvWidget = new F({\n          debug: false,\n          autosize: true,\n          timezone: window.jstz.determine().name(),\n          symbol: symbolCurrent,\n          interval: this.getTimeMin(true, this.lastTimeS),\n          container_id: 'tv_chart_container',\n          // DOM id\n          datafeed: this.udf_datafeed(),\n          // 配置 生命周期\n          library_path: '/static/charting_library/',\n          // 静态文件路径\n          locale: this.language,\n          // 语言\n          disabled_features: this.disabled_features_arr,\n          enabled_features: [// 'study_templates',\n          'hide_left_toolbar_by_default'],\n          charts_storage_url: \"\".concat(window.location.protocol, \"//saveload.tradingview.com\"),\n          charts_storage_api_version: '1.1',\n          client_id: 'tradingview.com',\n          user_id: 'public_user',\n          toolbar_bg: '#fff',\n          // 工具栏底色\n          theme: this.themeTV,\n          studies_overrides: {\n            'volume.volume.color.0': getHex(colorMap['u-4-bg']),\n            'volume.volume.color.1': getHex(colorMap['u-1-bg']),\n            'volume.volume.transparency': 50\n          },\n          overrides: {\n            // k线的颜色\n            volumePaneSize: 'small',\n            // 成交量大小\n            'scalesProperties.fontSize': 12,\n            // 图标区域xy轴 字体大小\n            'scalesProperties.textColor': '#A7B4CB',\n            // 图标区域xy轴 文字颜色\n            'scalesProperties.lineColor': '#A7B4CB',\n            // 图标区域xy轴颜色\n            'paneProperties.background': '#fff',\n            // 图标区域 背景色\n            'paneProperties.vertGridProperties.color': '#fff',\n            // 图标区域 表格纵轴颜色\n            'paneProperties.horzGridProperties.color': '#fff',\n            // 图标区域 表格橫轴颜色\n            'paneProperties.crossHairProperties.color': getHex(colorMap['b-2-bg']),\n            // 图标区域 鼠标十字线颜色\n            'paneProperties.legendProperties.showLegend': true,\n            // 折叠信息\n            // 柱状图颜色设置\n            'mainSeriesProperties.candleStyle.upColor': '#52CC8A',\n            'mainSeriesProperties.candleStyle.downColor': '#FF4E4E',\n            'mainSeriesProperties.candleStyle.drawWick': true,\n            'mainSeriesProperties.candleStyle.drawBorder': true,\n            'mainSeriesProperties.candleStyle.borderColor': '',\n            'mainSeriesProperties.candleStyle.borderUpColor': '#52CC8A',\n            'mainSeriesProperties.candleStyle.borderDownColor': '#FF4E4E',\n            'mainSeriesProperties.candleStyle.wickUpColor': '#52CC8A',\n            'mainSeriesProperties.candleStyle.wickDownColor': '#FF4E4E',\n            'mainSeriesProperties.candleStyle.barColorsOnPrevClose': !1,\n            // 分时图颜色设置\n            // 分时背景色渐变 上半部分\n            'mainSeriesProperties.areaStyle.color1': colorMap['a-15-bg'],\n            // 分时背景色渐变 下半部分\n            'mainSeriesProperties.areaStyle.color2': colorMap['a-17-bg'],\n            'mainSeriesProperties.areaStyle.linecolor': getHex(colorMap['a-12-bd']),\n            'mainSeriesProperties.areaStyle.linestyle': 0,\n            'mainSeriesProperties.areaStyle.linewidth': 2,\n            'mainSeriesProperties.areaStyle.priceSource': 'close'\n          }\n        });\n        this.widget = window.tvWidget;\n      }\n    },\n    // 格式化时间刻度\n    getTimeMin: function getTimeMin(only, type) {\n      if (only) {\n        var _t = null;\n\n        if (this.timeArry.length) {\n          this.timeArry.forEach(function (item) {\n            var s = item.indexOf(type);\n\n            if (s > -1) {\n              _t = s === 0 ? item[1] : item[0];\n            }\n          });\n        }\n\n        return _t;\n      }\n\n      var t = [];\n      this.timeArry.forEach(function (item) {\n        t.push(item[type]);\n      });\n      return t;\n    },\n    // 精度计算\n    fixDepthNumber: function fixDepthNumber() {\n      var b = Math.pow(10, this.pricefix);\n      return parseFloat(b.toString());\n    },\n    widget_onChartReady: function widget_onChartReady() {\n      var _this4 = this;\n\n      this.isCreateWidget = true;\n      this.creatMA(); // ===== 默认样式皮肤修改 =====\n\n      var style = document.createElement('style');\n      /* eslint-disable */\n\n      var clas = document.createTextNode(\".apply-common-tooltip,.wrap-1GG7GnNO- svg{fill:\" + colorMap[\"b-3-cl\"] + \"!important;color:\" + colorMap[\"b-3-cl\"] + \"!important;cursor: pointer;}.textColor .wrap-18oKCBRc- div,.wrap-18oKCBRc- .apply-common-tooltip:hover,.wrap-1GG7GnNO- svg:hover,.button-263WXsg--.isActive-2mI1-NUL- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-:hover{fill:\" + colorMap[\"a-1-cl\"] + \"!important;color:\" + colorMap[\"a-1-cl\"] + \"!important;}.container-3_8ayT2Q- .background-Q1Fcmxly-{fill: \" + colorMap[\"b-2-cl\"] + \"; stroke: \" + colorMap[\"b-2-cl\"] + \";}.container-3_8ayT2Q- .arrow-WcYWFXUn-, html.theme-dark .container-3_8ayT2Q- .arrow-WcYWFXUn-{stroke: \" + colorMap[\"b-1-cl\"] + \";}.feature-no-touch .container-3_8ayT2Q-:hover .background-Q1Fcmxly-{fill: \" + colorMap[\"a-1-cl\"] + \";stroke: \" + colorMap[\"a-1-cl\"] + \";}\" + \".wrap-3tiHesTk- {position: absolute; right: 0;height: 66px !important;background: none !important;}\" + \".layout__area--top, .overflowWrap-PWdgT-U_-{height: 66px!important;}\");\n      /* eslint-enable */\n\n      style.append(clas);\n      this.widget.headerReady().then(function () {\n        _this4.widget.createButton().append(style);\n      });\n    },\n    creatMA: function creatMA() {\n      // ===== 创建移动均线 =====\n      this.widget.chart().createStudy('Moving Average', false, false, [5], null, {\n        'plot.color': '#F5CB89'\n      });\n      this.widget.chart().createStudy('Moving Average', false, false, [10], null, {\n        'plot.color': '#5FCFBF'\n      });\n      this.widget.chart().createStudy('Moving Average', false, false, [30], null, {\n        'plot.color': '#DD89F5'\n      });\n    },\n    setMAShow: function setMAShow() {\n      // ===== 显示移动均线 =====\n      var c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, true);\n      this.widget.chart().setEntityVisibility(c[1].id, true);\n      this.widget.chart().setEntityVisibility(c[2].id, true);\n    },\n    setMAHide: function setMAHide() {\n      // ===== 隐藏移动均线 =====\n      var c = this.widget.chart().getAllStudies();\n      this.widget.chart().setEntityVisibility(c[0].id, false);\n      this.widget.chart().setEntityVisibility(c[1].id, false);\n      this.widget.chart().setEntityVisibility(c[2].id, false);\n    },\n    timeClike: function timeClike(v) {\n      var _this5 = this;\n\n      if (v !== 'Line' && v !== '1min' && v !== this.lastTimeS) {\n        this.isshowLoading = true;\n      }\n\n      if (v !== this.lastTimeS) {\n        this.lastTimeS = v;\n\n        if (v === 'Line') {\n          myStorage.set('lastTimeS', '1min');\n        } else {\n          myStorage.set('lastTimeS', v);\n        }\n\n        this.$bus.$emit('LAST-TIMES', v);\n\n        if (this.isCreateWidget) {\n          var resolution = this.widget.chart().resolution();\n\n          if (v === 'Line') {\n            if (resolution !== '1') {\n              this.widget.chart().setResolution('1', function () {\n                _this5.widget.chart().setChartType(3); // 折线图\n\n              });\n            } else if (resolution === '1') {\n              this.widget.chart().setChartType(3);\n            }\n\n            this.setMAHide();\n          } else {\n            if (resolution === '1' && v === '1min') {\n              this.widget.chart().setChartType(1); // 蜡烛图\n            } else {\n              var timeS = this.getTimeMin(true, v);\n              this.widget.chart().setResolution(timeS.toString(), function () {\n                _this5.widget.chart().setChartType(1);\n\n                _this5.widget.chart().executeActionById('chartReset');\n              });\n            }\n\n            this.setMAShow();\n          }\n        }\n      }\n    },\n    // 格式化数据\n    setData: function setData(obj) {\n      var volume = obj.vol;\n\n      if (this.coUnitType === 1) {\n        volume = nul(obj.vol, this.multiplier);\n      }\n\n      return {\n        time: obj.id * 1000,\n        close: obj.close,\n        open: obj.open,\n        high: obj.high,\n        low: obj.low,\n        volume: volume\n      };\n    },\n    setChartType: function setChartType(type) {\n      var _this6 = this;\n\n      this.chartType = type;\n      setTimeout(function () {\n        var _this6$$refs = _this6.$refs,\n            _this6$$refs$topMenuB = _this6$$refs.topMenuBox,\n            topMenuBox = _this6$$refs$topMenuB === void 0 ? null : _this6$$refs$topMenuB,\n            _this6$$refs$topMenuB2 = _this6$$refs.topMenuBar,\n            topMenuBar = _this6$$refs$topMenuB2 === void 0 ? null : _this6$$refs$topMenuB2;\n        _this6.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n      }, 500);\n    },\n    switchChartType: function switchChartType(type) {\n      var _this7 = this;\n\n      if (type === 2) {\n        if (!window.echarts && !this.loadingEchart) {\n          this.loadingEchart = true;\n          getScript(\"\".concat(process.env.BASE_URL, \"static/js/echarts.min.js\")).then(function () {\n            _this7.loadingEchart = false;\n            _this7.isshowLoading = false;\n            _this7.echartLoaded = true;\n\n            _this7.setChartType(type);\n          });\n        } else {\n          this.setChartType(type);\n        }\n      } else {\n        this.setChartType(type);\n      }\n    },\n    quit: function quit(e) {\n      this.isfullTv = false;\n\n      if (this.isfullTv) {\n        var key = e.keyCode;\n\n        if (key === 27) {\n          this.isfullTv = false;\n        }\n      }\n    },\n    fullTv: function fullTv() {\n      if (!this.isfullTv) {\n        this.isfullTv = true;\n        var element = this.$refs.tv_chart_container;\n\n        if (element.requestFullscreen) {\n          element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n          element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n          element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n          element.msRequestFullscreen();\n        }\n      } else {\n        this.isfullTv = false;\n\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    },\n    quitfullTv: function quitfullTv() {\n      // 监听TV 是否是全屏状态\n      if (this.isfullTv) {\n        this.isfullTv = window.fullScreen || document.webkitIsFullScreen || document.msFullscreenElement;\n      }\n    },\n    // 设置时间刻度的滚动\n    slideMarket: function slideMarket(type) {\n      var position = parseFloat(this.slidePosition);\n\n      if (this.$refs.topMenuBar) {\n        if (type === 'left') {\n          position += this.$refs.topMenuBar.offsetWidth / 2;\n\n          if (position > 0) {\n            position = 0;\n          }\n        } else {\n          var _this$$refs = this.$refs,\n              _this$$refs$topMenuBo = _this$$refs.topMenuBox,\n              topMenuBox = _this$$refs$topMenuBo === void 0 ? null : _this$$refs$topMenuBo,\n              _this$$refs$topMenuBa = _this$$refs.topMenuBar,\n              topMenuBar = _this$$refs$topMenuBa === void 0 ? null : _this$$refs$topMenuBa;\n          this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\n          position -= this.$refs.topMenuBar.offsetWidth / 2;\n\n          if (position < -this.maxPosition) {\n            position = -this.maxPosition;\n          }\n        }\n\n        this.slidePosition = \"\".concat(position, \"px\");\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/modules/coTrade/tradingView/tradingView.js"],"names":["myStorage","getCookie","colorMap","getHex","imgMap","logImg","getScript","nul","name","data","TvBoxHeight","theme","chartType","MywebSocket","lastTimeS","get","timeLable","language","split","lTime","fTime","isCreateWidget","isshowLoading","maskBg","chartTypeHove","loadingEchart","isfullTv","isfullTvsd","echartLoaded","slidePosition","maxPosition","lanArry","coSymbolAll","isMobile","window","disabled_features_arr","computed","symbolCurrent","$store","state","future","coTypeSymbol","coUnitType","multiplier","Number","pricefix","klineLogo","tradingViewLogo","templateLayoutType","baseData","baseTimeArry","market","klineScale","w","timeArry","a","length","forEach","it","t","indexOf","push","parseFloat","toLowerCase","symbolAll","themeTV","stheme","toString","watch","val","old","tvWidget","arr","setSymbol","getTimeMin","widget","chart","executeActionById","setLanguage","setTimeout","creatMA","methods","init","document","removeEventListener","quitfullTv","addEventListener","set","$bus","$on","JSON","parse","stringify","initTradingView","enter","index","leave","chartTypeShow","num","createWidget","udf_datafeed","self","onReady","callback","cnf","supported_resolutions","supports_group_request","supports_marks","supports_search","supports_timescale_marks","resolveSymbol","symbolName","onSymbolResolvedCallback","minmov","minmov2","pointvalue","session","has_intraday","has_no_volume","volume_precision","description","toUpperCase","type","pricescale","fixDepthNumber","ticker","timezone","jstz","determine","calculateHistoryDepth","undefined","getBars","symbolInfo","resolution","from","to","onHistoryCallback","onErrorCallback","firstDataRequest","$emit","symbol","number","$off","wsData","channelArr","channel","Ntime","symbolType","klData","arrData","item","setData","time","id","noData","host","location","path","href","ds","Date","getTime","secend","widget_onChartReady","setChartType","subscribeBars","onRealtimeCallback","tick","tickData","unsubscribeBars","subscriberUID","F","TradingView","debug","autosize","interval","container_id","datafeed","library_path","locale","disabled_features","enabled_features","charts_storage_url","protocol","charts_storage_api_version","client_id","user_id","toolbar_bg","studies_overrides","overrides","volumePaneSize","only","s","b","style","createElement","clas","createTextNode","append","headerReady","then","createButton","createStudy","setMAShow","c","getAllStudies","setEntityVisibility","setMAHide","timeClike","v","setResolution","timeS","obj","volume","vol","close","open","high","low","$refs","topMenuBox","topMenuBar","offsetWidth","switchChartType","echarts","process","env","BASE_URL","quit","e","key","keyCode","fullTv","element","tv_chart_container","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","fullScreen","webkitIsFullScreen","msFullscreenElement","slideMarket","position"],"mappings":"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","sourcesContent":["import {\r\n  myStorage,\r\n  getCookie,\r\n  colorMap,\r\n  getHex,\r\n  imgMap,\r\n  logImg,\r\n  getScript,\r\n  nul,\r\n} from '@/utils';\r\n\r\nexport default {\r\n  name: 'tradingView',\r\n  data() {\r\n    return {\r\n      TvBoxHeight: '697px',\r\n      // 颜色主题\r\n      theme: 'theme_default',\r\n      // 图标类型 TV：1 Echart: 2\r\n      chartType: 1,\r\n      MywebSocket: null,\r\n      lastTimeS: myStorage.get('lastTimeS'),\r\n      timeLable: myStorage.get('lastTimeS'),\r\n      language: getCookie('lan') ? getCookie('lan').split('_')[0] : '',\r\n      lTime: null,\r\n      fTime: 0,\r\n      isCreateWidget: false,\r\n      isshowLoading: true,\r\n      maskBg: true,\r\n      chartTypeHove: null,\r\n      loadingEchart: false,\r\n      isfullTv: false,\r\n      isfullTvsd: null,\r\n      echartLoaded: false,\r\n      // 市场横向滚动参数\r\n      slidePosition: 0,\r\n      maxPosition: 0,\r\n      lanArry: [\r\n        'ar',\r\n        'zh_TW',\r\n        'zh',\r\n        'cs',\r\n        'da_DK',\r\n        'nl_NL',\r\n        'en',\r\n        'et_EE',\r\n        'fr',\r\n        'de',\r\n        'el',\r\n        'he_IL',\r\n        'hu_HU',\r\n        'id_ID',\r\n        'it',\r\n        'ja',\r\n        'ko',\r\n        'ms_MY',\r\n        'no',\r\n        'fa',\r\n        'pl',\r\n        'pt',\r\n        'ro',\r\n        'ru',\r\n        'sk_SK',\r\n        'es',\r\n        'sv',\r\n        'th',\r\n        'tr',\r\n        'vi',\r\n      ],\r\n      // 合约全部币对\r\n      coSymbolAll: null,\r\n      // 是否是移动端\r\n      isMobile: window.isMobile,\r\n      // 隐藏K线工具选项\r\n      disabled_features_arr: [\r\n        'header_symbol_search',\r\n        'timeframes_toolbar',\r\n        'volume_force_overlay',\r\n        'header_saveload',\r\n        'header_resolutions',\r\n        'header_compare',\r\n        'header_screenshot',\r\n        'header_undo_redo',\r\n        'adaptive_logo',\r\n        'header_fullscreen_button',\r\n        'timezone_menu',\r\n        'scales_context_menu',\r\n        'legend_context_menu',\r\n        'symbol_search_hot_key',\r\n        // 'header_settings',\r\n        // 'header_widget',\r\n        // 'use_localstorage_for_settings',\r\n        // 'show_chart_property_page',\r\n        // 'timeframes_toolbar',\r\n        // 'symbol_info',\r\n        // 'header_widget_dom_node',\r\n        // 'header_indicators',\r\n        // 'header_widget',\r\n        // 'pane_context_menu',\r\n        // 'header_fullscreen_button',\r\n        // 'display_market_status',\r\n        // 'header_chart_type',\r\n      ],\r\n    };\r\n  },\r\n  computed: {\r\n    // 当前合约币对\r\n    symbolCurrent() {\r\n      return this.$store.state.future.coTypeSymbol;\r\n    },\r\n    // 数量单位类型Number（1标的货币 2张）\r\n    coUnitType() {\r\n      return this.$store.state.future.coUnitType;\r\n    },\r\n    // 当前合约面值\r\n    multiplier() {\r\n      return Number(this.$store.state.future.multiplier);\r\n    },\r\n    // 当前币对价格精度\r\n    pricefix() {\r\n      return this.$store.state.future.pricefix;\r\n    },\r\n    klineLogo() {\r\n      return imgMap.tradingViewLogo || '';\r\n    },\r\n    templateLayoutType() {\r\n      return this.$store.state.baseData.templateLayoutType;\r\n    },\r\n    baseTimeArry() {\r\n      try {\r\n        return this.$store.state.baseData.market.klineScale;\r\n      } catch (w) {\r\n        return [\r\n          '1min',\r\n          '5min',\r\n          '15min',\r\n          '30min',\r\n          '60min',\r\n          '4h',\r\n          '1day',\r\n          '1week',\r\n          '1month',\r\n        ];\r\n      }\r\n    },\r\n    timeArry() {\r\n      const a = [];\r\n      if (this.baseTimeArry.length) {\r\n        this.baseTimeArry.forEach((it) => {\r\n          const t = [];\r\n          if (it.indexOf('min') > -1) {\r\n            t.push(it, parseFloat(it));\r\n          } else if (\r\n            it.toLowerCase().indexOf('h') > -1\r\n            && it.indexOf('month') < 0\r\n          ) {\r\n            t.push(it, parseFloat(it) * 60);\r\n          } else if (it.indexOf('day') > -1) {\r\n            t.push(it, parseFloat(it) * 24 * 60);\r\n          } else if (it.indexOf('week') > -1) {\r\n            t.push(it, parseFloat(it) * 7 * 24 * 60);\r\n          } else if (it.indexOf('month') > -1) {\r\n            t.push(it, parseFloat(it) * 30 * 24 * 60);\r\n          }\r\n          a.push(t);\r\n        });\r\n      }\r\n      return a;\r\n    },\r\n    // 币币and杠杆 全部货币对\r\n    symbolAll() {\r\n      return this.$store.state.baseData.symbolAll;\r\n    },\r\n    themeTV() {\r\n      const theme = getCookie('cusSkin') || getCookie('defSkin') || '1';\r\n      const stheme = theme.toString() === '1' ? 'Dark' : 'Light';\r\n      return 'Light';\r\n    },\r\n  },\r\n  watch: {\r\n    symbolCurrent(val, old) {\r\n      if (val && old) {\r\n        if (this.chartType === 1) {\r\n          this.isshowLoading = true;\r\n        }\r\n        if (window.tvWidget) {\r\n          const arr = this.symbolCurrent.split('_');\r\n          let symbolCurrent = arr[1];\r\n          if (arr && arr.length) {\r\n            if (arr[0] !== 'e' && arr[0] !== 's') {\r\n              symbolCurrent = `${arr[1]}-${arr[0]}`;\r\n            }\r\n          }\r\n          window.tvWidget.setSymbol(\r\n            symbolCurrent,\r\n            this.getTimeMin(true, this.lastTimeS),\r\n            () => {\r\n              this.widget.chart().executeActionById('chartReset');\r\n            },\r\n          );\r\n        }\r\n      }\r\n    },\r\n    coUnitType(val, old) {\r\n      if (val && old) {\r\n        if (this.chartType === 1) {\r\n          this.isshowLoading = true;\r\n        }\r\n        if (this.lastTimeS === 'Line') {\r\n          this.lastTimeS = '1min';\r\n        }\r\n        if (window.tvWidget) {\r\n          this.widget.setLanguage(this.language);\r\n          setTimeout(() => {\r\n            this.creatMA();\r\n          }, 1000);\r\n        }\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      // 监听TV 是否是全屏状态\r\n      document.removeEventListener('fullscreenchange', this.quitfullTv);\r\n      document.addEventListener('fullscreenchange', this.quitfullTv);\r\n\r\n      if (this.lanArry.indexOf(this.language) <= -1) {\r\n        this.language = 'en';\r\n      }\r\n      if (getCookie('lan') === 'el_GR') {\r\n        this.language = 'zh_TW';\r\n      }\r\n      if (!myStorage.get('lastTimeS')) {\r\n        myStorage.set('lastTimeS', '1day');\r\n        this.lastTimeS = '1day';\r\n      }\r\n      // 监听 WebSocket 链接成功\r\n      this.$bus.$on('WEBSOCKET_ON_OPEN', (val) => {\r\n        this.MywebSocket = JSON.parse(JSON.stringify(val));\r\n        if (this.MywebSocket) {\r\n          this.isCreateWidget = false;\r\n          this.initTradingView();\r\n        }\r\n      });\r\n\r\n      // 隐藏loading\r\n      this.$bus.$on('HIDE_LOADING', () => {\r\n        this.isshowLoading = false;\r\n      });\r\n      // 市场 个数的超出宽度\r\n      // this.maxPosition = this.$refs.topMenuBox.offsetWidth - this.$refs.topMenuBar.offsetWidth;\r\n    },\r\n    enter(index) {\r\n      this.chartTypeHove = index;\r\n    },\r\n    leave() {\r\n      this.chartTypeHove = null;\r\n    },\r\n    chartTypeShow(num) {\r\n      if (this.chartType === num || this.chartTypeHove === num) {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    initTradingView() {\r\n      this.createWidget();\r\n    },\r\n    // tadingView 生命周期函数\r\n    udf_datafeed() {\r\n      const self = this;\r\n      return {\r\n        onReady(callback) {\r\n          const cnf = {\r\n            supported_resolutions: self.getTimeMin(false, 1), // 数组\r\n            supports_group_request: false,\r\n            supports_marks: true,\r\n            supports_search: false,\r\n            supports_timescale_marks: false,\r\n          };\r\n          setTimeout(() => {\r\n            callback(cnf);\r\n          }, 0);\r\n        },\r\n        // 切换币对后\r\n        resolveSymbol(symbolName, onSymbolResolvedCallback) {\r\n          setTimeout(() => {\r\n            onSymbolResolvedCallback({\r\n              name: symbolName,\r\n              'exchange-traded': '',\r\n              'exchange-listed': '',\r\n              minmov: 1,\r\n              minmov2: 0,\r\n              pointvalue: 1,\r\n              session: '0000-2400:1234567',\r\n              has_intraday: true,\r\n              has_no_volume: false,\r\n              volume_precision: 1,\r\n              description: symbolName.toUpperCase(),\r\n              type: 'bitcoin',\r\n              supported_resolutions: self.getTimeMin(false, 1),\r\n              pricescale: self.fixDepthNumber(),\r\n              ticker: symbolName.toUpperCase(),\r\n              timezone: window.jstz.determine().name(),\r\n            });\r\n          }, 0);\r\n        },\r\n        // 获取深度数据（k线无需请求深度）\r\n        calculateHistoryDepth() {\r\n          return undefined;\r\n        },\r\n        // tradingview 获取历史数据\r\n        getBars(\r\n          symbolInfo,\r\n          resolution,\r\n          from,\r\n          to,\r\n          onHistoryCallback,\r\n          onErrorCallback,\r\n          firstDataRequest,\r\n        ) {\r\n          if (firstDataRequest) {\r\n            self.lTime = false;\r\n          }\r\n          const lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\r\n          if (self.MywebSocket) {\r\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\r\n              type: 'req',\r\n              symbol: self.symbolCurrent,\r\n              lastTimeS,\r\n              lTime: self.lTime,\r\n              number: 50,\r\n            });\r\n          }\r\n          self.$bus.$off('KLINE_DATA_REQ');\r\n          self.$bus.$on('KLINE_DATA_REQ', (data) => {\r\n            const wsData = JSON.parse(data);\r\n            self.fTime = 0;\r\n            const channelArr = wsData.channel.split('_');\r\n            const Ntime = channelArr[channelArr.length - 1];\r\n            const [, type, symbol] = wsData.channel.split('_');\r\n            const symbolType = `${type}_${symbol}`;\r\n            if (symbolType === self.symbolCurrent && lastTimeS === Ntime) {\r\n              const klData = wsData.data;\r\n              const arrData = [];\r\n              if (klData && klData.length) {\r\n                klData.forEach((item) => {\r\n                  arrData.push(self.setData(item));\r\n                });\r\n                if (firstDataRequest) {\r\n                  self.fTime = arrData[arrData.length - 1].time;\r\n                }\r\n                if (self.lTime === klData[0].id) {\r\n                  onHistoryCallback([], { noData: true });\r\n                  logImg({\r\n                    host: window.location.host,\r\n                    type: 'onHistoryCallback',\r\n                    path: window.location.href,\r\n                    ds: 'onHistoryCallback noDate',\r\n                    data: {\r\n                      symbol: self.symbolCurrent,\r\n                    },\r\n                    t: new Date().getTime(),\r\n                  });\r\n                } else {\r\n                  self.lTime = klData[0].id;\r\n                  onHistoryCallback(arrData);\r\n                }\r\n              } else {\r\n                if (self.secend < 3) {\r\n                  self.udf_datafeed().getBars(\r\n                    symbolInfo,\r\n                    resolution,\r\n                    from,\r\n                    to,\r\n                    onHistoryCallback,\r\n                    onErrorCallback,\r\n                    firstDataRequest,\r\n                  );\r\n                  self.secend += 1;\r\n                  return;\r\n                }\r\n                if (!self.lTime) {\r\n                  logImg({\r\n                    host: window.location.host,\r\n                    type: 'tradingView',\r\n                    path: window.location.href,\r\n                    ds: 'first onHistoryCallback noData',\r\n                    data,\r\n                    t: new Date().getTime(),\r\n                  });\r\n                }\r\n                onHistoryCallback([], { noData: true });\r\n              }\r\n            }\r\n          });\r\n          if (!self.isCreateWidget) {\r\n            self.widget_onChartReady();\r\n            self.widget.chart().setChartType(1);\r\n          }\r\n        },\r\n        // tradingview 获取实时数据\r\n        subscribeBars(symbolInfo, resolution, onRealtimeCallback) {\r\n          self.isshowLoading = false;\r\n          self.maskBg = false;\r\n          const lastTimeS = self.lastTimeS === 'Line' ? '1min' : self.lastTimeS;\r\n          if (self.MywebSocket) {\r\n            self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\r\n              type: 'sub',\r\n              symbol: self.symbolCurrent,\r\n              lastTimeS,\r\n            });\r\n          }\r\n          self.$bus.$off('KLINE_DATA_SUB');\r\n          self.$bus.$on('KLINE_DATA_SUB', (data) => {\r\n            const wsData = JSON.parse(data);\r\n            // console.log('实时数据', wsData);\r\n            const channelArr = wsData.channel.split('_');\r\n            const Ntime = channelArr[channelArr.length - 1];\r\n            const [, type, symbol] = wsData.channel.split('_');\r\n            const symbolType = `${type}_${symbol}`;\r\n            if (\r\n              wsData.tick\r\n              && Ntime === lastTimeS\r\n              && symbolType === self.symbolCurrent\r\n            ) {\r\n              const tickData = self.setData(wsData.tick);\r\n              if (self.fTime < tickData.time) {\r\n                onRealtimeCallback(tickData);\r\n              }\r\n            }\r\n          });\r\n        },\r\n        // tradingview 取消订阅上一 币对 / 刻度\r\n        unsubscribeBars(subscriberUID) {\r\n          const arr = subscriberUID.split('_');\r\n          const symbol = `${arr[0]}_${arr[1]}`;\r\n          self.$bus.$emit('WEBSOCKET_KLINE_SEND', {\r\n            type: 'unsub',\r\n            symbol: symbol.toLowerCase(),\r\n            lastTimeS: self.getTimeMin(true, parseFloat(arr[2])),\r\n          });\r\n        },\r\n      };\r\n    },\r\n    // 创建 TradingView\r\n    createWidget() {\r\n      class F extends window.TradingView.widget {}\r\n      if (this.symbolCurrent) {\r\n        const symbolCurrent = this.symbolCurrent.split('_')[1];\r\n        window.tvWidget = new F({\r\n          debug: false,\r\n          autosize: true,\r\n          timezone: window.jstz.determine().name(),\r\n          symbol: symbolCurrent,\r\n          interval: this.getTimeMin(true, this.lastTimeS),\r\n          container_id: 'tv_chart_container', // DOM id\r\n          datafeed: this.udf_datafeed(), // 配置 生命周期\r\n          library_path: '/static/charting_library/', // 静态文件路径\r\n          locale: this.language, // 语言\r\n          disabled_features: this.disabled_features_arr,\r\n          enabled_features: [\r\n          // 'study_templates',\r\n            'hide_left_toolbar_by_default',\r\n          ],\r\n          charts_storage_url: `${window.location.protocol}//saveload.tradingview.com`,\r\n          charts_storage_api_version: '1.1',\r\n          client_id: 'tradingview.com',\r\n          user_id: 'public_user',\r\n          toolbar_bg: '#fff', // 工具栏底色\r\n          theme: this.themeTV,\r\n          studies_overrides: {\r\n            'volume.volume.color.0': getHex(colorMap['u-4-bg']),\r\n            'volume.volume.color.1': getHex(colorMap['u-1-bg']),\r\n            'volume.volume.transparency': 50,\r\n          },\r\n          overrides: {\r\n          // k线的颜色\r\n            volumePaneSize: 'small', // 成交量大小\r\n            'scalesProperties.fontSize': 12, // 图标区域xy轴 字体大小\r\n            'scalesProperties.textColor': '#A7B4CB', // 图标区域xy轴 文字颜色\r\n            'scalesProperties.lineColor': '#A7B4CB', // 图标区域xy轴颜色\r\n            'paneProperties.background': '#fff', // 图标区域 背景色\r\n            'paneProperties.vertGridProperties.color': '#fff', // 图标区域 表格纵轴颜色\r\n            'paneProperties.horzGridProperties.color': '#fff', // 图标区域 表格橫轴颜色\r\n            'paneProperties.crossHairProperties.color': getHex(\r\n              colorMap['b-2-bg'],\r\n            ), // 图标区域 鼠标十字线颜色\r\n            'paneProperties.legendProperties.showLegend': true, // 折叠信息\r\n            // 柱状图颜色设置\r\n            'mainSeriesProperties.candleStyle.upColor': '#52CC8A',\r\n            'mainSeriesProperties.candleStyle.downColor': '#FF4E4E',\r\n            'mainSeriesProperties.candleStyle.drawWick': true,\r\n            'mainSeriesProperties.candleStyle.drawBorder': true,\r\n            'mainSeriesProperties.candleStyle.borderColor': '',\r\n            'mainSeriesProperties.candleStyle.borderUpColor': '#52CC8A',\r\n            'mainSeriesProperties.candleStyle.borderDownColor': '#FF4E4E',\r\n            'mainSeriesProperties.candleStyle.wickUpColor': '#52CC8A',\r\n            'mainSeriesProperties.candleStyle.wickDownColor': '#FF4E4E',\r\n            'mainSeriesProperties.candleStyle.barColorsOnPrevClose': !1,\r\n            // 分时图颜色设置\r\n            // 分时背景色渐变 上半部分\r\n            'mainSeriesProperties.areaStyle.color1': colorMap['a-15-bg'],\r\n            // 分时背景色渐变 下半部分\r\n            'mainSeriesProperties.areaStyle.color2': colorMap['a-17-bg'],\r\n            'mainSeriesProperties.areaStyle.linecolor': getHex(\r\n              colorMap['a-12-bd'],\r\n            ),\r\n            'mainSeriesProperties.areaStyle.linestyle': 0,\r\n            'mainSeriesProperties.areaStyle.linewidth': 2,\r\n            'mainSeriesProperties.areaStyle.priceSource': 'close',\r\n          },\r\n        });\r\n        this.widget = window.tvWidget;\r\n      }\r\n    },\r\n    // 格式化时间刻度\r\n    getTimeMin(only, type) {\r\n      if (only) {\r\n        let t = null;\r\n        if (this.timeArry.length) {\r\n          this.timeArry.forEach((item) => {\r\n            const s = item.indexOf(type);\r\n            if (s > -1) {\r\n              t = s === 0 ? item[1] : item[0];\r\n            }\r\n          });\r\n        }\r\n        return t;\r\n      }\r\n      const t = [];\r\n      this.timeArry.forEach((item) => {\r\n        t.push(item[type]);\r\n      });\r\n      return t;\r\n    },\r\n    // 精度计算\r\n    fixDepthNumber() {\r\n      const b = 10 ** this.pricefix;\r\n      return parseFloat(b.toString());\r\n    },\r\n    widget_onChartReady() {\r\n      this.isCreateWidget = true;\r\n      this.creatMA();\r\n      // ===== 默认样式皮肤修改 =====\r\n      const style = document.createElement('style');\r\n      /* eslint-disable */\r\n      const clas = document.createTextNode(\r\n        \".apply-common-tooltip,.wrap-1GG7GnNO- svg{fill:\" +\r\n          colorMap[\"b-3-cl\"] +\r\n          \"!important;color:\" +\r\n          colorMap[\"b-3-cl\"] +\r\n          \"!important;cursor: pointer;}.textColor .wrap-18oKCBRc- div,.wrap-18oKCBRc- .apply-common-tooltip:hover,.wrap-1GG7GnNO- svg:hover,.button-263WXsg--.isActive-2mI1-NUL- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-,.button-263WXsg-- .icon-1Y-3MM9F-:hover{fill:\" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \"!important;color:\" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \"!important;}.container-3_8ayT2Q- .background-Q1Fcmxly-{fill: \" +\r\n          colorMap[\"b-2-cl\"] +\r\n          \"; stroke: \" +\r\n          colorMap[\"b-2-cl\"] +\r\n          \";}.container-3_8ayT2Q- .arrow-WcYWFXUn-, html.theme-dark .container-3_8ayT2Q- .arrow-WcYWFXUn-{stroke: \" +\r\n          colorMap[\"b-1-cl\"] +\r\n          \";}.feature-no-touch .container-3_8ayT2Q-:hover .background-Q1Fcmxly-{fill: \" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \";stroke: \" +\r\n          colorMap[\"a-1-cl\"] +\r\n          \";}\" + \".wrap-3tiHesTk- {position: absolute; right: 0;height: 66px !important;background: none !important;}\" + \".layout__area--top, .overflowWrap-PWdgT-U_-{height: 66px!important;}\"\r\n      );\r\n    /* eslint-enable */\r\n      style.append(clas);\r\n      this.widget.headerReady().then(() => {\r\n        this.widget.createButton().append(style);\r\n      });\r\n    },\r\n    creatMA() {\r\n      // ===== 创建移动均线 =====\r\n      this.widget\r\n        .chart()\r\n        .createStudy('Moving Average', false, false, [5], null, {\r\n          'plot.color': '#F5CB89',\r\n        });\r\n      this.widget\r\n        .chart()\r\n        .createStudy('Moving Average', false, false, [10], null, {\r\n          'plot.color': '#5FCFBF',\r\n        });\r\n      this.widget\r\n        .chart()\r\n        .createStudy('Moving Average', false, false, [30], null, {\r\n          'plot.color': '#DD89F5',\r\n        });\r\n    },\r\n    setMAShow() {\r\n      // ===== 显示移动均线 =====\r\n      const c = this.widget.chart().getAllStudies();\r\n      this.widget.chart().setEntityVisibility(c[0].id, true);\r\n      this.widget.chart().setEntityVisibility(c[1].id, true);\r\n      this.widget.chart().setEntityVisibility(c[2].id, true);\r\n    },\r\n    setMAHide() {\r\n      // ===== 隐藏移动均线 =====\r\n      const c = this.widget.chart().getAllStudies();\r\n      this.widget.chart().setEntityVisibility(c[0].id, false);\r\n      this.widget.chart().setEntityVisibility(c[1].id, false);\r\n      this.widget.chart().setEntityVisibility(c[2].id, false);\r\n    },\r\n    timeClike(v) {\r\n      if (v !== 'Line' && v !== '1min' && v !== this.lastTimeS) {\r\n        this.isshowLoading = true;\r\n      }\r\n      if (v !== this.lastTimeS) {\r\n        this.lastTimeS = v;\r\n        if (v === 'Line') {\r\n          myStorage.set('lastTimeS', '1min');\r\n        } else {\r\n          myStorage.set('lastTimeS', v);\r\n        }\r\n        this.$bus.$emit('LAST-TIMES', v);\r\n        if (this.isCreateWidget) {\r\n          const resolution = this.widget.chart().resolution();\r\n          if (v === 'Line') {\r\n            if (resolution !== '1') {\r\n              this.widget.chart().setResolution('1', () => {\r\n                this.widget.chart().setChartType(3); // 折线图\r\n              });\r\n            } else if (resolution === '1') {\r\n              this.widget.chart().setChartType(3);\r\n            }\r\n            this.setMAHide();\r\n          } else {\r\n            if (resolution === '1' && v === '1min') {\r\n              this.widget.chart().setChartType(1); // 蜡烛图\r\n            } else {\r\n              const timeS = this.getTimeMin(true, v);\r\n              this.widget.chart().setResolution(timeS.toString(), () => {\r\n                this.widget.chart().setChartType(1);\r\n                this.widget.chart().executeActionById('chartReset');\r\n              });\r\n            }\r\n            this.setMAShow();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    // 格式化数据\r\n    setData(obj) {\r\n      let volume = obj.vol;\r\n      if (this.coUnitType === 1) {\r\n        volume = nul(obj.vol, this.multiplier);\r\n      }\r\n\r\n      return {\r\n        time: obj.id * 1000,\r\n        close: obj.close,\r\n        open: obj.open,\r\n        high: obj.high,\r\n        low: obj.low,\r\n        volume,\r\n      };\r\n    },\r\n    setChartType(type) {\r\n      this.chartType = type;\r\n      setTimeout(() => {\r\n        const { topMenuBox = null, topMenuBar = null } = this.$refs;\r\n        this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\r\n      }, 500);\r\n    },\r\n    switchChartType(type) {\r\n      if (type === 2) {\r\n        if (!window.echarts && !this.loadingEchart) {\r\n          this.loadingEchart = true;\r\n          getScript(`${process.env.BASE_URL}static/js/echarts.min.js`).then(() => {\r\n            this.loadingEchart = false;\r\n            this.isshowLoading = false;\r\n            this.echartLoaded = true;\r\n            this.setChartType(type);\r\n          });\r\n        } else {\r\n          this.setChartType(type);\r\n        }\r\n      } else {\r\n        this.setChartType(type);\r\n      }\r\n    },\r\n    quit(e) {\r\n      this.isfullTv = false;\r\n      if (this.isfullTv) {\r\n        const key = e.keyCode;\r\n        if (key === 27) {\r\n          this.isfullTv = false;\r\n        }\r\n      }\r\n    },\r\n    fullTv() {\r\n      if (!this.isfullTv) {\r\n        this.isfullTv = true;\r\n        const element = this.$refs.tv_chart_container;\r\n        if (element.requestFullscreen) {\r\n          element.requestFullscreen();\r\n        } else if (element.mozRequestFullScreen) {\r\n          element.mozRequestFullScreen();\r\n        } else if (element.webkitRequestFullscreen) {\r\n          element.webkitRequestFullscreen();\r\n        } else if (element.msRequestFullscreen) {\r\n          element.msRequestFullscreen();\r\n        }\r\n      } else {\r\n        this.isfullTv = false;\r\n        if (document.exitFullscreen) {\r\n          document.exitFullscreen();\r\n        } else if (document.mozCancelFullScreen) {\r\n          document.mozCancelFullScreen();\r\n        } else if (document.webkitExitFullscreen) {\r\n          document.webkitExitFullscreen();\r\n        }\r\n      }\r\n    },\r\n    quitfullTv() {\r\n      // 监听TV 是否是全屏状态\r\n      if (this.isfullTv) {\r\n        this.isfullTv = window.fullScreen\r\n          || document.webkitIsFullScreen\r\n          || document.msFullscreenElement;\r\n      }\r\n    },\r\n    // 设置时间刻度的滚动\r\n    slideMarket(type) {\r\n      let position = parseFloat(this.slidePosition);\r\n      if (this.$refs.topMenuBar) {\r\n        if (type === 'left') {\r\n          position += this.$refs.topMenuBar.offsetWidth / 2;\r\n          if (position > 0) {\r\n            position = 0;\r\n          }\r\n        } else {\r\n          const { topMenuBox = null, topMenuBar = null } = this.$refs;\r\n          this.maxPosition = topMenuBox.offsetWidth - topMenuBar.offsetWidth;\r\n          position -= this.$refs.topMenuBar.offsetWidth / 2;\r\n          if (position < -this.maxPosition) {\r\n            position = -this.maxPosition;\r\n          }\r\n        }\r\n        this.slidePosition = `${position}px`;\r\n      }\r\n    },\r\n  },\r\n\r\n};\r\n"]}]}