{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/leverageTransfer/leverageTransfer.js","dependencies":[{"path":"/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/leverageTransfer/leverageTransfer.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport { fixD, fixInput, getCoinShowName } from '@/utils';\nexport default {\n  data: function data() {\n    return {\n      loading: false,\n      transferConfirmLoading: false,\n      transferFlag: false,\n      // 资金划转弹窗开关变量\n      transferSide: '1',\n      // 划转方向 1 为从现货到杠杆  2 为杠杆到现货\n      transferValue: '',\n      // 划转数量\n      transferCoin: '',\n      // 划转的币种\n      transferObj: {},\n      // 当前划转币种对象\n      axiosFlag: false,\n      symbol: '',\n      defineCoin: ''\n    };\n  },\n  watch: {\n    market: function market(v) {\n      if (v && this.axiosFlag) {\n        this.getData();\n      }\n    },\n    transferObj: function transferObj(v) {\n      if (Object.keys(v).length) {\n        if (this.defineCoin) {\n          this.transferCoin = this.defineCoin;\n        } else {\n          this.transferCoin = v.baseCoin;\n        }\n      }\n    },\n    transferValue: function transferValue(v) {\n      if (this.transferSide === '2') {\n        this.transferValue = fixInput(v, 8);\n      } else {\n        this.transferValue = fixInput(v, this.transferCoinFix);\n      }\n    }\n  },\n  computed: {\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    side: function side() {\n      var ex = this.$t('assets.otcAccount.exchangeAccount');\n      var otc = this.$t('assets.leverageTransfer.leverageAccount');\n      var from = '';\n      var to = '';\n\n      if (this.transferSide === '1') {\n        from = ex;\n        to = otc;\n      } else {\n        from = otc;\n        to = ex;\n      }\n\n      return {\n        from: from,\n        to: to\n      };\n    },\n    transferWarningText: function transferWarningText() {\n      var text = this.$t('assets.otcAccount.can'); // 可转\n\n      var num = fixD(this.transferCanNum, this.transferCoinFix);\n\n      if (this.transferSide === '2') {\n        num = fixD(this.transferCanNum, 8);\n      }\n\n      return \"\".concat(text, \" \").concat(num, \" \").concat(this.getShowCoin(this.transferCoin), \" \");\n    },\n    transferCoinFix: function transferCoinFix() {\n      var fix = 0;\n\n      if (this.market && this.market.coinList && this.market.coinList[this.transferCoin]) {\n        fix = this.market.coinList[this.transferCoin].showPrecision;\n      }\n\n      return Number(fix);\n    },\n    // 弹窗是否可点击\n    transferConfirmDisabled: function transferConfirmDisabled() {\n      if (this.transferConfirmLoading) {\n        return false;\n      }\n\n      var flag = true;\n\n      if (parseFloat(this.transferValue) > 0 && !this.transferError) {\n        flag = false;\n      }\n\n      return flag;\n    },\n    transferError: function transferError() {\n      var flag = false;\n\n      if (parseFloat(this.transferValue) > parseFloat(this.transferCanNum)) {\n        flag = true;\n      }\n\n      return flag;\n    },\n    // 可划转数量\n    transferCanNum: function transferCanNum() {\n      var _this$transferObj = this.transferObj,\n          baseCanTransfer = _this$transferObj.baseCanTransfer,\n          quoteCanTransfer = _this$transferObj.quoteCanTransfer,\n          baseExNormalBalance = _this$transferObj.baseExNormalBalance,\n          quoteEXNormalBalance = _this$transferObj.quoteEXNormalBalance,\n          baseCoin = _this$transferObj.baseCoin,\n          quoteCoin = _this$transferObj.quoteCoin;\n      var coBalance = '';\n      var exBalance = '';\n\n      if (this.transferCoin === baseCoin) {\n        coBalance = baseCanTransfer;\n        exBalance = baseExNormalBalance;\n      } else if (this.transferCoin === quoteCoin) {\n        coBalance = quoteCanTransfer;\n        exBalance = quoteEXNormalBalance;\n      }\n\n      var balance = '';\n\n      if (this.transferSide === '1') {\n        balance = exBalance;\n      } else {\n        balance = coBalance;\n      }\n\n      return Number(balance);\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      this.$bus.$on('coTransfer', function (symbol, coin) {\n        _this.axiosFlag = true;\n        _this.symbol = symbol;\n        _this.transferFlag = true;\n        _this.loading = true;\n\n        if (coin) {\n          _this.defineCoin = coin;\n        }\n\n        if (_this.market) {\n          _this.getData();\n        }\n      });\n    },\n    getShowCoin: function getShowCoin(v) {\n      if (!this.market) return v;\n      var coinList = this.market.coinList;\n      var str = v;\n\n      if (this.market && coinList) {\n        str = getCoinShowName(v, coinList);\n      }\n\n      return str;\n    },\n    // 获取数据\n    getData: function getData() {\n      var _this2 = this;\n\n      this.axiosFlag = false;\n      var params = {\n        symbol: this.symbol\n      };\n      this.axios({\n        url: '/lever/finance/symbol/balance',\n        params: params\n      }).then(function (data) {\n        _this2.loading = false;\n\n        if (data.code.toString() === '0') {\n          _this2.transferObj = data.data;\n        } else {\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 切换币种\n    transferCoinChange: function transferCoinChange(v) {\n      if (this.transferCoin === v) return;\n      this.transferCoin = v;\n      this.transferValue = ''; // 重置划转数量\n    },\n    // 修改划转方向\n    setTransferSide: function setTransferSide() {\n      if (this.transferSide === '1') {\n        this.transferSide = '2';\n      } else if (this.transferSide === '2') {\n        this.transferSide = '1';\n      }\n\n      this.transferValue = ''; // 重置划转数量\n    },\n    // 全部划转\n    allTransfer: function allTransfer() {\n      if (this.transferSide === '2') {\n        this.transferValue = fixD(this.transferCanNum, 8);\n      } else {\n        this.transferValue = fixD(this.transferCanNum, this.transferCoinFix);\n      }\n    },\n    inputLineChange: function inputLineChange(value, name) {\n      this[name] = value;\n    },\n    clearTransfer: function clearTransfer() {\n      this.transferFlag = false; // 资金划转弹窗开关变量\n\n      this.transferSide = '1'; // 划转方向 1 为从现货到杠杆  2 为杠杆到现货\n\n      this.transferValue = ''; // 划转数量\n\n      this.transferCoin = ''; // 划转的币种\n\n      this.transferConfirmLoading = false;\n      this.$set(this, 'transferObj', {}); // // 当前划转币种对象\n    },\n    transferDialogClose: function transferDialogClose() {\n      this.clearTransfer();\n    },\n    transferDialogConfirm: function transferDialogConfirm() {\n      var _this3 = this;\n\n      this.transferConfirmLoading = true;\n      var params = {\n        fromAccount: this.transferSide === '1' ? '1' : '2',\n        toAccount: this.transferSide === '1' ? '2' : '1',\n        amount: this.transferValue,\n        coinSymbol: this.transferCoin,\n        symbol: this.transferObj.symbol\n      };\n      this.axios({\n        url: '/lever/finance/transfer',\n        params: params\n      }).then(function (data) {\n        _this3.transferConfirmLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this3.clearTransfer();\n\n          _this3.$emit('success');\n\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/leverageTransfer/leverageTransfer.js"],"names":["fixD","fixInput","getCoinShowName","data","loading","transferConfirmLoading","transferFlag","transferSide","transferValue","transferCoin","transferObj","axiosFlag","symbol","defineCoin","watch","market","v","getData","Object","keys","length","baseCoin","transferCoinFix","computed","$store","state","baseData","side","ex","$t","otc","from","to","transferWarningText","text","num","transferCanNum","getShowCoin","fix","coinList","showPrecision","Number","transferConfirmDisabled","flag","parseFloat","transferError","baseCanTransfer","quoteCanTransfer","baseExNormalBalance","quoteEXNormalBalance","quoteCoin","coBalance","exBalance","balance","methods","init","$bus","$on","coin","str","params","axios","url","then","code","toString","$emit","msg","type","transferCoinChange","setTransferSide","allTransfer","inputLineChange","value","name","clearTransfer","$set","transferDialogClose","transferDialogConfirm","fromAccount","toAccount","amount","coinSymbol"],"mappings":"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","sourcesContent":["import { fixD, fixInput, getCoinShowName } from '@/utils';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      transferConfirmLoading: false,\r\n      transferFlag: false, // 资金划转弹窗开关变量\r\n      transferSide: '1', // 划转方向 1 为从现货到杠杆  2 为杠杆到现货\r\n      transferValue: '', // 划转数量\r\n      transferCoin: '', // 划转的币种\r\n      transferObj: {}, // 当前划转币种对象\r\n      axiosFlag: false,\r\n      symbol: '',\r\n      defineCoin: '',\r\n    };\r\n  },\r\n  watch: {\r\n    market(v) {\r\n      if (v && this.axiosFlag) {\r\n        this.getData();\r\n      }\r\n    },\r\n    transferObj(v) {\r\n      if (Object.keys(v).length) {\r\n        if (this.defineCoin) {\r\n          this.transferCoin = this.defineCoin;\r\n        } else {\r\n          this.transferCoin = v.baseCoin;\r\n        }\r\n      }\r\n    },\r\n    transferValue(v) {\r\n      if (this.transferSide === '2') {\r\n        this.transferValue = fixInput(v, 8);\r\n      } else {\r\n        this.transferValue = fixInput(v, this.transferCoinFix);\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    market() {\r\n      return this.$store.state.baseData.market;\r\n    },\r\n    side() {\r\n      const ex = this.$t('assets.otcAccount.exchangeAccount');\r\n      const otc = this.$t('assets.leverageTransfer.leverageAccount');\r\n      let from = '';\r\n      let to = '';\r\n      if (this.transferSide === '1') {\r\n        from = ex;\r\n        to = otc;\r\n      } else {\r\n        from = otc;\r\n        to = ex;\r\n      }\r\n      return {\r\n        from,\r\n        to,\r\n      };\r\n    },\r\n    transferWarningText() {\r\n      const text = this.$t('assets.otcAccount.can'); // 可转\r\n      let num = fixD(this.transferCanNum, this.transferCoinFix);\r\n      if (this.transferSide === '2') {\r\n        num = fixD(this.transferCanNum, 8);\r\n      }\r\n      return `${text} ${num} ${this.getShowCoin(this.transferCoin)} `;\r\n    },\r\n    transferCoinFix() {\r\n      let fix = 0;\r\n      if (this.market && this.market.coinList && this.market.coinList[this.transferCoin]) {\r\n        fix = this.market.coinList[this.transferCoin].showPrecision;\r\n      }\r\n      return Number(fix);\r\n    },\r\n    // 弹窗是否可点击\r\n    transferConfirmDisabled() {\r\n      if (this.transferConfirmLoading) {\r\n        return false;\r\n      }\r\n      let flag = true;\r\n      if (parseFloat(this.transferValue) > 0 && !this.transferError) {\r\n        flag = false;\r\n      }\r\n      return flag;\r\n    },\r\n    transferError() {\r\n      let flag = false;\r\n      if (parseFloat(this.transferValue) > parseFloat(this.transferCanNum)) {\r\n        flag = true;\r\n      }\r\n      return flag;\r\n    },\r\n    // 可划转数量\r\n    transferCanNum() {\r\n      const {\r\n        baseCanTransfer,\r\n        quoteCanTransfer,\r\n        baseExNormalBalance,\r\n        quoteEXNormalBalance,\r\n        baseCoin,\r\n        quoteCoin,\r\n      } = this.transferObj;\r\n      let coBalance = '';\r\n      let exBalance = '';\r\n      if (this.transferCoin === baseCoin) {\r\n        coBalance = baseCanTransfer;\r\n        exBalance = baseExNormalBalance;\r\n      } else if (this.transferCoin === quoteCoin) {\r\n        coBalance = quoteCanTransfer;\r\n        exBalance = quoteEXNormalBalance;\r\n      }\r\n      let balance = '';\r\n      if (this.transferSide === '1') {\r\n        balance = exBalance;\r\n      } else {\r\n        balance = coBalance;\r\n      }\r\n      return Number(balance);\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.$bus.$on('coTransfer', (symbol, coin) => {\r\n        this.axiosFlag = true;\r\n        this.symbol = symbol;\r\n        this.transferFlag = true;\r\n        this.loading = true;\r\n        if (coin) {\r\n          this.defineCoin = coin;\r\n        }\r\n        if (this.market) {\r\n          this.getData();\r\n        }\r\n      });\r\n    },\r\n    getShowCoin(v) {\r\n      if (!this.market) return v;\r\n      const { coinList } = this.market;\r\n      let str = v;\r\n      if (this.market && coinList) {\r\n        str = getCoinShowName(v, coinList);\r\n      }\r\n      return str;\r\n    },\r\n    // 获取数据\r\n    getData() {\r\n      this.axiosFlag = false;\r\n      const params = {\r\n        symbol: this.symbol,\r\n      };\r\n      this.axios({\r\n        url: '/lever/finance/symbol/balance',\r\n        params,\r\n      }).then((data) => {\r\n        this.loading = false;\r\n        if (data.code.toString() === '0') {\r\n          this.transferObj = data.data;\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    // 切换币种\r\n    transferCoinChange(v) {\r\n      if (this.transferCoin === v) return;\r\n      this.transferCoin = v;\r\n      this.transferValue = ''; // 重置划转数量\r\n    },\r\n    // 修改划转方向\r\n    setTransferSide() {\r\n      if (this.transferSide === '1') {\r\n        this.transferSide = '2';\r\n      } else if (this.transferSide === '2') {\r\n        this.transferSide = '1';\r\n      }\r\n      this.transferValue = ''; // 重置划转数量\r\n    },\r\n    // 全部划转\r\n    allTransfer() {\r\n      if (this.transferSide === '2') {\r\n        this.transferValue = fixD(this.transferCanNum, 8);\r\n      } else {\r\n        this.transferValue = fixD(this.transferCanNum, this.transferCoinFix);\r\n      }\r\n    },\r\n    inputLineChange(value, name) {\r\n      this[name] = value;\r\n    },\r\n    clearTransfer() {\r\n      this.transferFlag = false; // 资金划转弹窗开关变量\r\n      this.transferSide = '1'; // 划转方向 1 为从现货到杠杆  2 为杠杆到现货\r\n      this.transferValue = ''; // 划转数量\r\n      this.transferCoin = ''; // 划转的币种\r\n      this.transferConfirmLoading = false;\r\n      this.$set(this, 'transferObj', {}); // // 当前划转币种对象\r\n    },\r\n    transferDialogClose() {\r\n      this.clearTransfer();\r\n    },\r\n    transferDialogConfirm() {\r\n      this.transferConfirmLoading = true;\r\n      const params = {\r\n        fromAccount: this.transferSide === '1' ? '1' : '2',\r\n        toAccount: this.transferSide === '1' ? '2' : '1',\r\n        amount: this.transferValue,\r\n        coinSymbol: this.transferCoin,\r\n        symbol: this.transferObj.symbol,\r\n      };\r\n      this.axios({\r\n        url: '/lever/finance/transfer',\r\n        params,\r\n      }).then((data) => {\r\n        this.transferConfirmLoading = false;\r\n        if (data.code.toString() === '0') {\r\n          this.clearTransfer();\r\n          this.$emit('success');\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'success' });\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n"]}]}