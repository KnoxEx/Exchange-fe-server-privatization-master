{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/leverageRepayment/leverageRepayment.js","dependencies":[{"path":"/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/leverageRepayment/leverageRepayment.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\nimport { fixD, fixInput, getCoinShowName } from '@/utils';\nexport default {\n  data: function data() {\n    return {\n      transferConfirmLoading: false,\n      transferFlag: false,\n      // 资金划转弹窗开关变量\n      transferValue: '',\n      // 划转数量\n      transferCoin: '',\n      // 划转的币种\n      transferObj: {},\n      // 当前划转币种对象\n      axiosFlag: false,\n      symbol: '',\n      repaymentData: {} // 借贷信息\n\n    };\n  },\n  filters: {\n    fixDFn: function fixDFn(v) {\n      // return fixD(v, that.transferCoinFix);\n      return fixD(v, 8);\n    },\n    fixDReturnFn: function fixDReturnFn(v) {\n      // return fixD(v, that.returnFix);\n      return fixD(v, 8);\n    }\n  },\n  watch: {\n    market: function market(v) {\n      if (v && this.axiosFlag) {\n        this.getData();\n      }\n    },\n    transferValue: function transferValue(v) {\n      // this.transferValue = fixInput(v, this.returnFix);\n      this.transferValue = fixInput(v, 8);\n    }\n  },\n  computed: {\n    inputMess: function inputMess() {\n      var obj = {\n        flag: false,\n        showError: false,\n        text: ''\n      };\n      var inp = Number(this.transferValue);\n      var have = Number(this.transferCanNum);\n      var max = Number(fixD(this.repaymentMess.Surplus, this.returnFix));\n      var min = Number(this.transferMinNum);\n      var flag = true;\n      if (min > max) flag = false;\n\n      if (inp === 0) {\n        obj.flag = false;\n        obj.text = '';\n        obj.showError = false;\n      } else if (min > inp && flag) {\n        obj.flag = false;\n        obj.showError = true; // 归还数量不得小于\n\n        var str = this.$t('assets.leverageRepayment.error1');\n        obj.text = \"\".concat(str, \" \").concat(fixD(min, this.transferCoinFix), \" \").concat(this.transferCoin);\n      } else if (inp > have) {\n        obj.flag = false;\n        obj.showError = true; // 归还数量不得大于可用数量\n\n        obj.text = this.$t('assets.leverageRepayment.error2');\n      } else if (inp > max) {\n        obj.flag = false;\n        obj.showError = true; // 归还数量不得大于应还数量\n\n        obj.text = this.$t('assets.leverageRepayment.error3');\n      } else {\n        obj.flag = true;\n        obj.text = '';\n        obj.showError = false;\n      }\n\n      return obj;\n    },\n    repaymentMess: function repaymentMess() {\n      var obj = {\n        coin: '',\n        // 借贷币种\n        sum: '',\n        // 借贷总数\n        rete: '',\n        // 借贷产生的利息\n        Surplus: '' // 应还 未还 + 利息\n\n      };\n      var _this$repaymentData = this.repaymentData,\n          coin = _this$repaymentData.coin,\n          borrowMoney = _this$repaymentData.borrowMoney,\n          oweInterest = _this$repaymentData.oweInterest,\n          oweAmount = _this$repaymentData.oweAmount;\n      obj.coin = coin;\n      obj.sum = borrowMoney || 0;\n      obj.rate = oweInterest || 0;\n      obj.Surplus = (oweInterest || 0) + (oweAmount || 0);\n      return obj;\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    transferWarningText: function transferWarningText() {\n      var text = this.$t('assets.leverageRepayment.can'); // 可用\n\n      var num = fixD(this.transferCanNum, 8);\n      return \"\".concat(text, \" \").concat(num, \" \").concat(this.getShowCoin(this.transferCoin), \" \");\n    },\n    transferCoinFix: function transferCoinFix() {\n      var fix = 0;\n\n      if (this.market && this.market.coinList && this.market.coinList[this.transferCoin]) {\n        fix = this.market.coinList[this.transferCoin].showPrecision;\n      }\n\n      return Number(fix);\n    },\n    returnFix: function returnFix() {\n      var returnFix = this.transferObj.baseReturnPrecision || 0;\n\n      if (this.repaymentMess.coin === this.transferObj.quoteCoin) {\n        returnFix = this.transferObj.quoteReturnPrecision;\n      }\n\n      return returnFix;\n    },\n    // 弹窗是否可点击\n    transferConfirmDisabled: function transferConfirmDisabled() {\n      if (this.transferConfirmLoading) {\n        return false;\n      }\n\n      var flag = true;\n\n      if (this.inputMess.flag) {\n        flag = false;\n      }\n\n      return flag;\n    },\n    // 可用数量\n    transferCanNum: function transferCanNum() {\n      var _this$transferObj = this.transferObj,\n          baseNormalBalance = _this$transferObj.baseNormalBalance,\n          quoteNormalBalance = _this$transferObj.quoteNormalBalance,\n          baseCoin = _this$transferObj.baseCoin,\n          quoteCoin = _this$transferObj.quoteCoin;\n      var balance = '';\n\n      if (this.transferCoin === baseCoin) {\n        balance = baseNormalBalance;\n      } else if (this.transferCoin === quoteCoin) {\n        balance = quoteNormalBalance;\n      }\n\n      return Number(balance);\n    },\n    // 最小还款额度\n    transferMinNum: function transferMinNum() {\n      var _this$transferObj2 = this.transferObj,\n          baseMinPayment = _this$transferObj2.baseMinPayment,\n          quoteMinPayment = _this$transferObj2.quoteMinPayment,\n          baseCoin = _this$transferObj2.baseCoin,\n          quoteCoin = _this$transferObj2.quoteCoin;\n      var balance = '';\n\n      if (this.transferCoin === baseCoin) {\n        balance = baseMinPayment;\n      } else if (this.transferCoin === quoteCoin) {\n        balance = quoteMinPayment;\n      }\n\n      return Number(balance);\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      this.$bus.$on('coRepayment', function (data) {\n        var symbol = data.symbol,\n            coin = data.coin;\n        _this.repaymentData = data;\n        _this.axiosFlag = true;\n        _this.symbol = symbol;\n        _this.transferFlag = true;\n        _this.transferCoin = coin;\n\n        if (_this.market) {\n          _this.getData();\n        }\n      });\n    },\n    getShowSymbol: function getShowSymbol(v) {\n      if (!this.market) return v;\n      var market = this.market.market;\n      var showSymbol = v;\n\n      if (this.market && market && this.transferObj.quoteCoin) {\n        var obj = market[this.transferObj.quoteCoin][this.transferObj.name];\n        showSymbol = obj.showName || obj.name;\n      }\n\n      return showSymbol;\n    },\n    getShowCoin: function getShowCoin(v) {\n      if (!this.market) return v;\n      var coinList = this.market.coinList;\n      var str = v;\n\n      if (this.market && coinList) {\n        str = getCoinShowName(v, coinList);\n      }\n\n      return str;\n    },\n    // 获取数据\n    getData: function getData() {\n      var _this2 = this;\n\n      this.axiosFlag = false;\n      var params = {\n        symbol: this.symbol\n      };\n      this.axios({\n        url: '/lever/finance/symbol/balance',\n        params: params\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          _this2.transferObj = data.data;\n        }\n      });\n    },\n    // 全部划转\n    allTransfer: function allTransfer() {\n      var Surplus = this.repaymentMess.Surplus;\n      var sum = '';\n\n      if (Number(Surplus) > Number(this.transferCanNum)) {\n        sum = Number(this.transferCanNum);\n      } else {\n        sum = Number(Surplus);\n      }\n\n      this.transferValue = fixD(sum, this.returnFix);\n    },\n    inputLineChange: function inputLineChange(value, name) {\n      this[name] = value;\n    },\n    clearTransfer: function clearTransfer() {\n      this.transferFlag = false; // 资金划转弹窗开关变量\n\n      this.transferValue = ''; // 划转数量\n\n      this.transferCoin = ''; // 划转的币种\n\n      this.transferConfirmLoading = false;\n      this.$set(this, 'transferObj', {}); // // 当前划转币种对象\n    },\n    transferDialogClose: function transferDialogClose() {\n      this.clearTransfer();\n    },\n    transferDialogConfirm: function transferDialogConfirm() {\n      var _this3 = this;\n\n      this.transferConfirmLoading = true;\n      var params = {\n        id: this.repaymentData.id,\n        amount: this.transferValue\n      };\n      this.axios({\n        url: '/lever/finance/return',\n        params: params\n      }).then(function (data) {\n        _this3.transferConfirmLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this3.clearTransfer();\n\n          _this3.$emit('success');\n\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/assets/leverageRepayment/leverageRepayment.js"],"names":["fixD","fixInput","getCoinShowName","data","transferConfirmLoading","transferFlag","transferValue","transferCoin","transferObj","axiosFlag","symbol","repaymentData","filters","fixDFn","v","fixDReturnFn","watch","market","getData","computed","inputMess","obj","flag","showError","text","inp","Number","have","transferCanNum","max","repaymentMess","Surplus","returnFix","min","transferMinNum","str","$t","transferCoinFix","coin","sum","rete","borrowMoney","oweInterest","oweAmount","rate","$store","state","baseData","transferWarningText","num","getShowCoin","fix","coinList","showPrecision","baseReturnPrecision","quoteCoin","quoteReturnPrecision","transferConfirmDisabled","baseNormalBalance","quoteNormalBalance","baseCoin","balance","baseMinPayment","quoteMinPayment","methods","init","$bus","$on","getShowSymbol","showSymbol","name","showName","params","axios","url","then","code","toString","allTransfer","inputLineChange","value","clearTransfer","$set","transferDialogClose","transferDialogConfirm","id","amount","$emit","msg","type"],"mappings":"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","sourcesContent":["import {\r\n  fixD,\r\n  fixInput,\r\n  getCoinShowName,\r\n} from '@/utils';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      transferConfirmLoading: false,\r\n      transferFlag: false, // 资金划转弹窗开关变量\r\n      transferValue: '', // 划转数量\r\n      transferCoin: '', // 划转的币种\r\n      transferObj: {}, // 当前划转币种对象\r\n      axiosFlag: false,\r\n      symbol: '',\r\n      repaymentData: {}, // 借贷信息\r\n    };\r\n  },\r\n  filters: {\r\n    fixDFn(v) {\r\n      // return fixD(v, that.transferCoinFix);\r\n      return fixD(v, 8);\r\n    },\r\n    fixDReturnFn(v) {\r\n      // return fixD(v, that.returnFix);\r\n      return fixD(v, 8);\r\n    },\r\n  },\r\n  watch: {\r\n    market(v) { if (v && this.axiosFlag) { this.getData(); } },\r\n    transferValue(v) {\r\n      // this.transferValue = fixInput(v, this.returnFix);\r\n      this.transferValue = fixInput(v, 8);\r\n    },\r\n  },\r\n  computed: {\r\n    inputMess() {\r\n      const obj = {\r\n        flag: false,\r\n        showError: false,\r\n        text: '',\r\n      };\r\n      const inp = Number(this.transferValue);\r\n      const have = Number(this.transferCanNum);\r\n      const max = Number(fixD(this.repaymentMess.Surplus, this.returnFix));\r\n      const min = Number(this.transferMinNum);\r\n      let flag = true;\r\n      if (min > max) flag = false;\r\n      if (inp === 0) {\r\n        obj.flag = false;\r\n        obj.text = '';\r\n        obj.showError = false;\r\n      } else if (min > inp && flag) {\r\n        obj.flag = false;\r\n        obj.showError = true;\r\n        // 归还数量不得小于\r\n        const str = this.$t('assets.leverageRepayment.error1');\r\n        obj.text = `${str} ${fixD(min, this.transferCoinFix)} ${this.transferCoin}`;\r\n      } else if (inp > have) {\r\n        obj.flag = false;\r\n        obj.showError = true;\r\n        // 归还数量不得大于可用数量\r\n        obj.text = this.$t('assets.leverageRepayment.error2');\r\n      } else if (inp > max) {\r\n        obj.flag = false;\r\n        obj.showError = true;\r\n        // 归还数量不得大于应还数量\r\n        obj.text = this.$t('assets.leverageRepayment.error3');\r\n      } else {\r\n        obj.flag = true;\r\n        obj.text = '';\r\n        obj.showError = false;\r\n      }\r\n      return obj;\r\n    },\r\n    repaymentMess() {\r\n      const obj = {\r\n        coin: '', // 借贷币种\r\n        sum: '', // 借贷总数\r\n        rete: '', // 借贷产生的利息\r\n        Surplus: '', // 应还 未还 + 利息\r\n      };\r\n      const {\r\n        coin, borrowMoney, oweInterest, oweAmount,\r\n      } = this.repaymentData;\r\n      obj.coin = coin;\r\n      obj.sum = borrowMoney || 0;\r\n      obj.rate = oweInterest || 0;\r\n      obj.Surplus = (oweInterest || 0) + (oweAmount || 0);\r\n      return obj;\r\n    },\r\n    market() { return this.$store.state.baseData.market; },\r\n    transferWarningText() {\r\n      const text = this.$t('assets.leverageRepayment.can'); // 可用\r\n      const num = fixD(this.transferCanNum, 8);\r\n      return `${text} ${num} ${this.getShowCoin(this.transferCoin)} `;\r\n    },\r\n    transferCoinFix() {\r\n      let fix = 0;\r\n      if (this.market\r\n        && this.market.coinList\r\n        && this.market.coinList[this.transferCoin]) {\r\n        fix = this.market.coinList[this.transferCoin].showPrecision;\r\n      }\r\n      return Number(fix);\r\n    },\r\n    returnFix() {\r\n      let returnFix = this.transferObj.baseReturnPrecision || 0;\r\n      if (this.repaymentMess.coin === this.transferObj.quoteCoin) {\r\n        returnFix = this.transferObj.quoteReturnPrecision;\r\n      }\r\n      return returnFix;\r\n    },\r\n    // 弹窗是否可点击\r\n    transferConfirmDisabled() {\r\n      if (this.transferConfirmLoading) { return false; }\r\n      let flag = true;\r\n      if (this.inputMess.flag) {\r\n        flag = false;\r\n      }\r\n      return flag;\r\n    },\r\n    // 可用数量\r\n    transferCanNum() {\r\n      const {\r\n        baseNormalBalance,\r\n        quoteNormalBalance,\r\n        baseCoin,\r\n        quoteCoin,\r\n      } = this.transferObj;\r\n      let balance = '';\r\n      if (this.transferCoin === baseCoin) {\r\n        balance = baseNormalBalance;\r\n      } else if (this.transferCoin === quoteCoin) {\r\n        balance = quoteNormalBalance;\r\n      }\r\n      return Number(balance);\r\n    },\r\n    // 最小还款额度\r\n    transferMinNum() {\r\n      const {\r\n        baseMinPayment,\r\n        quoteMinPayment,\r\n        baseCoin,\r\n        quoteCoin,\r\n      } = this.transferObj;\r\n      let balance = '';\r\n      if (this.transferCoin === baseCoin) {\r\n        balance = baseMinPayment;\r\n      } else if (this.transferCoin === quoteCoin) {\r\n        balance = quoteMinPayment;\r\n      }\r\n      return Number(balance);\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.$bus.$on('coRepayment', (data) => {\r\n        const { symbol, coin } = data;\r\n        this.repaymentData = data;\r\n        this.axiosFlag = true;\r\n        this.symbol = symbol;\r\n        this.transferFlag = true;\r\n        this.transferCoin = coin;\r\n        if (this.market) {\r\n          this.getData();\r\n        }\r\n      });\r\n    },\r\n    getShowSymbol(v) {\r\n      if (!this.market) return v;\r\n      const { market } = this.market;\r\n      let showSymbol = v;\r\n      if (this.market && market && this.transferObj.quoteCoin) {\r\n        const obj = market[this.transferObj.quoteCoin][this.transferObj.name];\r\n        showSymbol = obj.showName || obj.name;\r\n      }\r\n      return showSymbol;\r\n    },\r\n    getShowCoin(v) {\r\n      if (!this.market) return v;\r\n      const { coinList } = this.market;\r\n      let str = v;\r\n      if (this.market && coinList) {\r\n        str = getCoinShowName(v, coinList);\r\n      }\r\n      return str;\r\n    },\r\n    // 获取数据\r\n    getData() {\r\n      this.axiosFlag = false;\r\n      const params = {\r\n        symbol: this.symbol,\r\n      };\r\n      this.axios({\r\n        url: '/lever/finance/symbol/balance',\r\n        params,\r\n      }).then((data) => {\r\n        if (data.code.toString() === '0') {\r\n          this.transferObj = data.data;\r\n        }\r\n      });\r\n    },\r\n    // 全部划转\r\n    allTransfer() {\r\n      const { Surplus } = this.repaymentMess;\r\n      let sum = '';\r\n      if (Number(Surplus) > Number(this.transferCanNum)) {\r\n        sum = Number(this.transferCanNum);\r\n      } else {\r\n        sum = Number(Surplus);\r\n      }\r\n      this.transferValue = fixD(sum, this.returnFix);\r\n    },\r\n    inputLineChange(value, name) {\r\n      this[name] = value;\r\n    },\r\n    clearTransfer() {\r\n      this.transferFlag = false; // 资金划转弹窗开关变量\r\n      this.transferValue = ''; // 划转数量\r\n      this.transferCoin = ''; // 划转的币种\r\n      this.transferConfirmLoading = false;\r\n      this.$set(this, 'transferObj', {}); // // 当前划转币种对象\r\n    },\r\n    transferDialogClose() {\r\n      this.clearTransfer();\r\n    },\r\n    transferDialogConfirm() {\r\n      this.transferConfirmLoading = true;\r\n      const params = {\r\n        id: this.repaymentData.id,\r\n        amount: this.transferValue,\r\n      };\r\n      this.axios({\r\n        url: '/lever/finance/return',\r\n        params,\r\n      }).then((data) => {\r\n        this.transferConfirmLoading = false;\r\n        if (data.code.toString() === '0') {\r\n          this.clearTransfer();\r\n          this.$emit('success');\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'success' });\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n"]}]}