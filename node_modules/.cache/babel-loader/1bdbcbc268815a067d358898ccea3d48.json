{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/assets/leverageTransfer/leverageTransfer.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/assets/leverageTransfer/leverageTransfer.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport { fixD, fixInput, getCoinShowName } from '@/utils';\nexport default {\n  data: function data() {\n    return {\n      loading: false,\n      transferConfirmLoading: false,\n      transferFlag: false,\n      // 资金划转弹窗开关变量\n      transferSide: '1',\n      // 划转方向 1 为从现货到杠杆  2 为杠杆到现货\n      transferValue: '',\n      // 划转数量\n      transferCoin: '',\n      // 划转的币种\n      transferObj: {},\n      // 当前划转币种对象\n      axiosFlag: false,\n      symbol: '',\n      defineCoin: ''\n    };\n  },\n  watch: {\n    market: function market(v) {\n      if (v && this.axiosFlag) {\n        this.getData();\n      }\n    },\n    transferObj: function transferObj(v) {\n      if (Object.keys(v).length) {\n        if (this.defineCoin) {\n          this.transferCoin = this.defineCoin;\n        } else {\n          this.transferCoin = v.baseCoin;\n        }\n      }\n    },\n    transferValue: function transferValue(v) {\n      if (this.transferSide === '2') {\n        this.transferValue = fixInput(v, 8);\n      } else {\n        this.transferValue = fixInput(v, this.transferCoinFix);\n      }\n    }\n  },\n  computed: {\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    side: function side() {\n      var ex = this.$t('assets.otcAccount.exchangeAccount');\n      var otc = this.$t('assets.leverageTransfer.leverageAccount');\n      var from = '';\n      var to = '';\n\n      if (this.transferSide === '1') {\n        from = ex;\n        to = otc;\n      } else {\n        from = otc;\n        to = ex;\n      }\n\n      return {\n        from: from,\n        to: to\n      };\n    },\n    transferWarningText: function transferWarningText() {\n      var text = this.$t('assets.otcAccount.can'); // 可转\n\n      var num = fixD(this.transferCanNum, this.transferCoinFix);\n\n      if (this.transferSide === '2') {\n        num = fixD(this.transferCanNum, 8);\n      }\n\n      return \"\".concat(text, \" \").concat(num, \" \").concat(this.getShowCoin(this.transferCoin), \" \");\n    },\n    transferCoinFix: function transferCoinFix() {\n      var fix = 0;\n\n      if (this.market && this.market.coinList && this.market.coinList[this.transferCoin]) {\n        fix = this.market.coinList[this.transferCoin].showPrecision;\n      }\n\n      return Number(fix);\n    },\n    // 弹窗是否可点击\n    transferConfirmDisabled: function transferConfirmDisabled() {\n      if (this.transferConfirmLoading) {\n        return false;\n      }\n\n      var flag = true;\n\n      if (parseFloat(this.transferValue) > 0 && !this.transferError) {\n        flag = false;\n      }\n\n      return flag;\n    },\n    transferError: function transferError() {\n      var flag = false;\n\n      if (parseFloat(this.transferValue) > parseFloat(this.transferCanNum)) {\n        flag = true;\n      }\n\n      return flag;\n    },\n    // 可划转数量\n    transferCanNum: function transferCanNum() {\n      var _this$transferObj = this.transferObj,\n          baseCanTransfer = _this$transferObj.baseCanTransfer,\n          quoteCanTransfer = _this$transferObj.quoteCanTransfer,\n          baseExNormalBalance = _this$transferObj.baseExNormalBalance,\n          quoteEXNormalBalance = _this$transferObj.quoteEXNormalBalance,\n          baseCoin = _this$transferObj.baseCoin,\n          quoteCoin = _this$transferObj.quoteCoin;\n      var coBalance = '';\n      var exBalance = '';\n\n      if (this.transferCoin === baseCoin) {\n        coBalance = baseCanTransfer;\n        exBalance = baseExNormalBalance;\n      } else if (this.transferCoin === quoteCoin) {\n        coBalance = quoteCanTransfer;\n        exBalance = quoteEXNormalBalance;\n      }\n\n      var balance = '';\n\n      if (this.transferSide === '1') {\n        balance = exBalance;\n      } else {\n        balance = coBalance;\n      }\n\n      return Number(balance);\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      this.$bus.$on('coTransfer', function (symbol, coin) {\n        _this.axiosFlag = true;\n        _this.symbol = symbol;\n        _this.transferFlag = true;\n        _this.loading = true;\n\n        if (coin) {\n          _this.defineCoin = coin;\n        }\n\n        if (_this.market) {\n          _this.getData();\n        }\n      });\n    },\n    getShowCoin: function getShowCoin(v) {\n      if (!this.market) return v;\n      var coinList = this.market.coinList;\n      var str = v;\n\n      if (this.market && coinList) {\n        str = getCoinShowName(v, coinList);\n      }\n\n      return str;\n    },\n    // 获取数据\n    getData: function getData() {\n      var _this2 = this;\n\n      this.axiosFlag = false;\n      var params = {\n        symbol: this.symbol\n      };\n      this.axios({\n        url: '/lever/finance/symbol/balance',\n        params: params\n      }).then(function (data) {\n        _this2.loading = false;\n\n        if (data.code.toString() === '0') {\n          _this2.transferObj = data.data;\n        } else {\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 切换币种\n    transferCoinChange: function transferCoinChange(v) {\n      if (this.transferCoin === v) return;\n      this.transferCoin = v;\n      this.transferValue = ''; // 重置划转数量\n    },\n    // 修改划转方向\n    setTransferSide: function setTransferSide() {\n      if (this.transferSide === '1') {\n        this.transferSide = '2';\n      } else if (this.transferSide === '2') {\n        this.transferSide = '1';\n      }\n\n      this.transferValue = ''; // 重置划转数量\n    },\n    // 全部划转\n    allTransfer: function allTransfer() {\n      if (this.transferSide === '2') {\n        this.transferValue = fixD(this.transferCanNum, 8);\n      } else {\n        this.transferValue = fixD(this.transferCanNum, this.transferCoinFix);\n      }\n    },\n    inputLineChange: function inputLineChange(value, name) {\n      this[name] = value;\n    },\n    clearTransfer: function clearTransfer() {\n      this.transferFlag = false; // 资金划转弹窗开关变量\n\n      this.transferSide = '1'; // 划转方向 1 为从现货到杠杆  2 为杠杆到现货\n\n      this.transferValue = ''; // 划转数量\n\n      this.transferCoin = ''; // 划转的币种\n\n      this.transferConfirmLoading = false;\n      this.$set(this, 'transferObj', {}); // // 当前划转币种对象\n    },\n    transferDialogClose: function transferDialogClose() {\n      this.clearTransfer();\n    },\n    transferDialogConfirm: function transferDialogConfirm() {\n      var _this3 = this;\n\n      this.transferConfirmLoading = true;\n      var params = {\n        fromAccount: this.transferSide === '1' ? '1' : '2',\n        toAccount: this.transferSide === '1' ? '2' : '1',\n        amount: this.transferValue,\n        coinSymbol: this.transferCoin,\n        symbol: this.transferObj.symbol\n      };\n      this.axios({\n        url: '/lever/finance/transfer',\n        params: params\n      }).then(function (data) {\n        _this3.transferConfirmLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this3.clearTransfer();\n\n          _this3.$emit('success');\n\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'success'\n          });\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};",null]}