{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/modules/coTrade/market/market.js","dependencies":[{"path":"/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/modules/coTrade/market/market.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\n// myStorage\nimport { fixD, myStorage } from '@/utils'; // mapState\\\n\nexport default {\n  name: 'market',\n  components: {},\n  props: {\n    close: {\n      default: function _default() {},\n      type: Function\n    },\n    isShow: {\n      default: false,\n      type: Boolean\n    }\n  },\n  data: function data() {\n    return {\n      // 币对列表\n      // marketData: null,\n      // 当前市场\n      marketCurrent: null,\n      // 行情数据\n      WsData: {},\n      // 当前合约市场\n      currentTypeTab: 1,\n      // 合约方向类型\n      contractSide: 1,\n      // 筛选\n      listfilterVal: null,\n      // 排序类别\n      sortName: null,\n      // 排序方向\n      sortType: '',\n      showTypeTabList0: false,\n      showTypeTabList1: false,\n      showTypeTabList2: false,\n      showTypeTabList3: false\n    };\n  },\n  computed: {\n    // 是否登录\n    isLogin: function isLogin() {\n      return this.$store.state.baseData.isLogin;\n    },\n    // 类型列表 USDT合约/币本位合约\n    typeTabList: function typeTabList() {\n      return [{\n        id: 1,\n        text: this.$t('futures.market.text4'),\n        // 'USDT合约',\n        isShow: this.showTypeTabList1,\n        classes: this.contractSide === 1 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }, {\n        id: 0,\n        text: this.$t('futures.market.text5'),\n        // '币本位合约',\n        isShow: this.showTypeTabList0,\n        classes: this.contractSide === 0 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }, {\n        id: 2,\n        text: this.$t('futures.market.text6'),\n        // '混合合约',\n        isShow: this.showTypeTabList2,\n        classes: this.contractSide === 2 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }, {\n        id: 3,\n        text: this.$t('futures.market.text7'),\n        // '模拟合约',\n        isShow: this.showTypeTabList3,\n        classes: this.contractSide === 3 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl'\n      }];\n    },\n    // 合约列表\n    contractList: function contractList() {\n      return this.$store.state.future.contractList;\n    },\n    // 当前合约名称\n    contractName: function contractName() {\n      return this.$store.state.future.contractName;\n    },\n    // 当前合约信息\n    contractInfo: function contractInfo() {\n      return this.$store.state.future.contractInfo;\n    },\n    // 合约币对价格精度\n    pricefix: function pricefix() {\n      return this.$store.state.future.pricefix;\n    },\n    // 合约类型列表\n    contractTypeText: function contractTypeText() {\n      return this.$store.state.future.contractTypeText;\n    },\n    // 币对列表\n    marketList: function marketList() {\n      var _this = this;\n\n      var data = [];\n      var text = '';\n\n      if (this.contractList && this.contractList.length) {\n        this.contractList.forEach(function (item) {\n          // 混合合约 || 模拟合约\n          if (item.contractType !== 'E') {\n            text = \"-\".concat(item.marginCoin);\n          } else {\n            text = '';\n          }\n\n          var symbolName = item.symbol.replace('-', '');\n          data.push({\n            type: _this.filterType(item),\n            key: item.wsDatakey,\n            symbol: \"\".concat(symbolName).concat(text),\n            contractName: item.contractName,\n            sort: item.sort,\n            close: _this.WsData[item.wsDatakey] ? _this.WsData[item.wsDatakey].close : '--',\n            rose: _this.WsData[item.wsDatakey] ? _this.WsData[item.wsDatakey].rose : '--',\n            priceFix: item.priceFix\n          });\n        });\n      } // 搜索\n\n\n      if (this.listfilterVal) {\n        var reg = new RegExp(this.listfilterVal, 'gim');\n        data = data.filter(function (item) {\n          return item.symbol.match(reg);\n        });\n      } // 排序\n\n\n      if (this.sortType === 'down') {\n        data.sort(function (a, b) {\n          return parseFloat(b[_this.sortName]) - parseFloat(a[_this.sortName]);\n        });\n      }\n\n      if (this.sortType === 'up') {\n        data.sort(function (a, b) {\n          return parseFloat(a[_this.sortName]) - parseFloat(b[_this.sortName]);\n        });\n      }\n\n      if (!this.sortType) {\n        data.sort(function (a, b) {\n          return parseFloat(a.sort) - parseFloat(b.sort);\n        });\n      }\n\n      return data;\n    },\n    // 用户配置信息\n    userConfig: function userConfig() {\n      return this.$store.state.future.futureUserConfig;\n    }\n  },\n  watch: {\n    isShow: function isShow() {\n      this.listfilterVal = null;\n    },\n    contractInfo: function contractInfo(val, old) {\n      if (val && !old) {\n        this.contractSide = this.filterType(val);\n      }\n    }\n  },\n  filters: {\n    // 涨跌幅处理\n    fixdRose: function fixdRose(value) {\n      if (value && value !== '--') {\n        var slie = '';\n        var val = parseFloat(value, 0);\n\n        if (val > 0) {\n          slie = '+';\n        }\n\n        if (val < 0) {\n          slie = '-';\n        }\n\n        var num = Math.abs(value * 10000 / 100);\n        return \"\".concat(slie).concat(Number(num.toString().match(/^\\d+(?:\\.\\d{0,2})?/)));\n      }\n\n      return value;\n    }\n  },\n  methods: {\n    // 筛选币对列表\n    filterType: function filterType(data) {\n      // USDT 合约\n      if (data.contractType === 'E' && data.contractSide === 1) {\n        this.showTypeTabList1 = true;\n        return 1;\n      } // 币本位合约\n\n\n      if (data.contractType === 'E' && data.contractSide === 0) {\n        this.showTypeTabList0 = true;\n        return 0;\n      } // 模拟合约\n\n\n      if (data.contractType === 'S') {\n        this.showTypeTabList3 = true;\n        return 3;\n      } // 混合合约\n\n\n      this.showTypeTabList2 = true;\n      return 2;\n    },\n    // 最新价 精度处理\n    fixPrice: function fixPrice(value, fix) {\n      return fixD(value, fix);\n    },\n    // 切换合约类型\n    changeTypeTab: function changeTypeTab(type) {\n      this.contractSide = type;\n      this.getReceiveCoupon();\n    },\n    // 搜索事件\n    inputchanges: function inputchanges(v) {\n      this.listfilterVal = v;\n    },\n    // 币对排序\n    sorteEvent: function sorteEvent(key) {\n      var _this2 = this;\n\n      this.$nextTick(function () {\n        if (!_this2.sortName) {\n          _this2.sortName = key;\n          _this2.sortType = 'down';\n        } else if (_this2.sortType === 'down') {\n          _this2.sortName = key;\n          _this2.sortType = 'up';\n        } else if (_this2.sortType === 'up') {\n          _this2.sortName = null;\n          _this2.sortType = null;\n        }\n      });\n    },\n    // 切换币对\n    switchSymbol: function switchSymbol(data) {\n      var contractId;\n\n      if (this.contractList && this.contractList.length) {\n        this.contractList.forEach(function (item) {\n          if (data === item.contractName) {\n            contractId = item.id;\n          }\n        });\n      }\n\n      myStorage.set('contractId', contractId);\n      myStorage.set('contractName', data);\n      myStorage.set('futuresMarketCurrent', this.contractSide);\n      this.$bus.$emit('futuresMarketCurrent', this.contractSide);\n      this.$store.dispatch('setActivePublicInfo');\n\n      if (this.isLogin) {\n        this.$store.dispatch('getUserConfig');\n      }\n\n      this.close();\n    },\n    // 涨跌幅 颜色 class\n    roseClasses: function roseClasses(data) {\n      if (data && data !== '--') {\n        var val = parseFloat(data, 0);\n\n        if (val === 0) {\n          return '';\n        }\n\n        return val > 0 ? 'u-1-cl' : 'u-4-cl';\n      }\n\n      return '';\n    },\n    init: function init() {\n      var _this3 = this;\n\n      // 接收24小时行情数据\n      this.$bus.$on('FUTURE_MARKET_DATA', function (data) {\n        _this3.WsData = JSON.parse(data);\n      });\n\n      if (this.contractInfo) {\n        this.contractSide = this.filterType(this.contractInfo);\n      }\n\n      this.getReceiveCoupon();\n    },\n    // 获去赠金\n    getReceiveCoupon: function getReceiveCoupon() {\n      if (this.isLogin && this.userConfig && this.contractSide === 3 && this.userConfig.openContract === 1 && this.userConfig.couponTag === 0) {\n        this.$store.dispatch('getReceiveCoupon');\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/h/Downloads/blockchain-ui-privatization/PC/common-mixin/modules/coTrade/market/market.js"],"names":["fixD","myStorage","name","components","props","close","default","type","Function","isShow","Boolean","data","marketCurrent","WsData","currentTypeTab","contractSide","listfilterVal","sortName","sortType","showTypeTabList0","showTypeTabList1","showTypeTabList2","showTypeTabList3","computed","isLogin","$store","state","baseData","typeTabList","id","text","$t","classes","contractList","future","contractName","contractInfo","pricefix","contractTypeText","marketList","length","forEach","item","contractType","marginCoin","symbolName","symbol","replace","push","filterType","key","wsDatakey","sort","rose","priceFix","reg","RegExp","filter","match","a","b","parseFloat","userConfig","futureUserConfig","watch","val","old","filters","fixdRose","value","slie","num","Math","abs","Number","toString","methods","fixPrice","fix","changeTypeTab","getReceiveCoupon","inputchanges","v","sorteEvent","$nextTick","switchSymbol","contractId","set","$bus","$emit","dispatch","roseClasses","init","$on","JSON","parse","openContract","couponTag"],"mappings":"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","sourcesContent":["// myStorage\r\nimport { fixD, myStorage } from '@/utils';\r\n\r\n// mapState\\\r\n\r\nexport default {\r\n  name: 'market',\r\n  components: {},\r\n  props: {\r\n    close: {\r\n      default() {},\r\n      type: Function,\r\n    },\r\n    isShow: {\r\n      default: false,\r\n      type: Boolean,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // 币对列表\r\n      // marketData: null,\r\n      // 当前市场\r\n      marketCurrent: null,\r\n\r\n      // 行情数据\r\n      WsData: {},\r\n      // 当前合约市场\r\n      currentTypeTab: 1,\r\n      // 合约方向类型\r\n      contractSide: 1,\r\n      // 筛选\r\n      listfilterVal: null,\r\n      // 排序类别\r\n      sortName: null,\r\n      // 排序方向\r\n      sortType: '',\r\n      showTypeTabList0: false,\r\n      showTypeTabList1: false,\r\n      showTypeTabList2: false,\r\n      showTypeTabList3: false,\r\n\r\n    };\r\n  },\r\n  computed: {\r\n    // 是否登录\r\n    isLogin() {\r\n      return this.$store.state.baseData.isLogin;\r\n    },\r\n    // 类型列表 USDT合约/币本位合约\r\n    typeTabList() {\r\n      return [\r\n        {\r\n          id: 1,\r\n          text: this.$t('futures.market.text4'), // 'USDT合约',\r\n          isShow: this.showTypeTabList1,\r\n          classes: this.contractSide === 1 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl',\r\n        },\r\n        {\r\n          id: 0,\r\n          text: this.$t('futures.market.text5'), // '币本位合约',\r\n          isShow: this.showTypeTabList0,\r\n          classes: this.contractSide === 0 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl',\r\n        },\r\n        {\r\n          id: 2,\r\n          text: this.$t('futures.market.text6'), // '混合合约',\r\n          isShow: this.showTypeTabList2,\r\n          classes: this.contractSide === 2 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl',\r\n        },\r\n        {\r\n          id: 3,\r\n          text: this.$t('futures.market.text7'), // '模拟合约',\r\n          isShow: this.showTypeTabList3,\r\n          classes: this.contractSide === 3 ? 'u-8-bg b-1-cl' : 'a-3-bg b-2-cl',\r\n        },\r\n      ];\r\n    },\r\n    // 合约列表\r\n    contractList() {\r\n      return this.$store.state.future.contractList;\r\n    },\r\n    // 当前合约名称\r\n    contractName() {\r\n      return this.$store.state.future.contractName;\r\n    },\r\n    // 当前合约信息\r\n    contractInfo() {\r\n      return this.$store.state.future.contractInfo;\r\n    },\r\n    // 合约币对价格精度\r\n    pricefix() {\r\n      return this.$store.state.future.pricefix;\r\n    },\r\n    // 合约类型列表\r\n    contractTypeText() {\r\n      return this.$store.state.future.contractTypeText;\r\n    },\r\n    // 币对列表\r\n    marketList() {\r\n      let data = [];\r\n      let text = '';\r\n      if (this.contractList && this.contractList.length) {\r\n        this.contractList.forEach((item) => {\r\n          // 混合合约 || 模拟合约\r\n          if (item.contractType !== 'E') {\r\n            text = `-${item.marginCoin}`;\r\n          } else {\r\n            text = '';\r\n          }\r\n          const symbolName = item.symbol.replace('-', '');\r\n          data.push({\r\n            type: this.filterType(item),\r\n            key: item.wsDatakey,\r\n            symbol: `${symbolName}${text}`,\r\n            contractName: item.contractName,\r\n            sort: item.sort,\r\n            close: this.WsData[item.wsDatakey] ? this.WsData[item.wsDatakey].close : '--',\r\n            rose: this.WsData[item.wsDatakey] ? this.WsData[item.wsDatakey].rose : '--',\r\n            priceFix: item.priceFix,\r\n          });\r\n        });\r\n      }\r\n      // 搜索\r\n      if (this.listfilterVal) {\r\n        const reg = new RegExp(this.listfilterVal, 'gim');\r\n        data = data.filter((item) => item.symbol.match(reg));\r\n      }\r\n      // 排序\r\n      if (this.sortType === 'down') {\r\n        data.sort((a, b) => parseFloat(b[this.sortName]) - parseFloat(a[this.sortName]));\r\n      }\r\n      if (this.sortType === 'up') {\r\n        data.sort((a, b) => parseFloat(a[this.sortName]) - parseFloat(b[this.sortName]));\r\n      }\r\n      if (!this.sortType) {\r\n        data.sort((a, b) => parseFloat(a.sort) - parseFloat(b.sort));\r\n      }\r\n      return data;\r\n    },\r\n    // 用户配置信息\r\n    userConfig() {\r\n      return this.$store.state.future.futureUserConfig;\r\n    },\r\n\r\n  },\r\n  watch: {\r\n    isShow() {\r\n      this.listfilterVal = null;\r\n    },\r\n    contractInfo(val, old) {\r\n      if (val && !old) {\r\n        this.contractSide = this.filterType(val);\r\n      }\r\n    },\r\n  },\r\n  filters: {\r\n    // 涨跌幅处理\r\n    fixdRose(value) {\r\n      if (value && value !== '--') {\r\n        let slie = '';\r\n        const val = parseFloat(value, 0);\r\n        if (val > 0) { slie = '+'; }\r\n        if (val < 0) { slie = '-'; }\r\n        const num = Math.abs((value * 10000) / 100);\r\n        return `${slie}${Number(num.toString().match(/^\\d+(?:\\.\\d{0,2})?/))}`;\r\n      }\r\n      return value;\r\n    },\r\n  },\r\n  methods: {\r\n    // 筛选币对列表\r\n    filterType(data) {\r\n      // USDT 合约\r\n      if (data.contractType === 'E' && data.contractSide === 1) {\r\n        this.showTypeTabList1 = true;\r\n        return 1;\r\n      }\r\n      // 币本位合约\r\n      if (data.contractType === 'E' && data.contractSide === 0) {\r\n        this.showTypeTabList0 = true;\r\n        return 0;\r\n      }\r\n      // 模拟合约\r\n      if (data.contractType === 'S') {\r\n        this.showTypeTabList3 = true;\r\n        return 3;\r\n      }\r\n      // 混合合约\r\n      this.showTypeTabList2 = true;\r\n      return 2;\r\n    },\r\n    // 最新价 精度处理\r\n    fixPrice(value, fix) {\r\n      return fixD(value, fix);\r\n    },\r\n    // 切换合约类型\r\n    changeTypeTab(type) {\r\n      this.contractSide = type;\r\n      this.getReceiveCoupon();\r\n    },\r\n    // 搜索事件\r\n    inputchanges(v) {\r\n      this.listfilterVal = v;\r\n    },\r\n    // 币对排序\r\n    sorteEvent(key) {\r\n      this.$nextTick(() => {\r\n        if (!this.sortName) {\r\n          this.sortName = key;\r\n          this.sortType = 'down';\r\n        } else if (this.sortType === 'down') {\r\n          this.sortName = key;\r\n          this.sortType = 'up';\r\n        } else if (this.sortType === 'up') {\r\n          this.sortName = null;\r\n          this.sortType = null;\r\n        }\r\n      });\r\n    },\r\n    // 切换币对\r\n    switchSymbol(data) {\r\n      let contractId;\r\n      if (this.contractList && this.contractList.length) {\r\n        this.contractList.forEach((item) => {\r\n          if (data === item.contractName) {\r\n            contractId = item.id;\r\n          }\r\n        });\r\n      }\r\n      myStorage.set('contractId', contractId);\r\n      myStorage.set('contractName', data);\r\n      myStorage.set('futuresMarketCurrent', this.contractSide);\r\n      this.$bus.$emit('futuresMarketCurrent', this.contractSide);\r\n      this.$store.dispatch('setActivePublicInfo');\r\n      if (this.isLogin) {\r\n        this.$store.dispatch('getUserConfig');\r\n      }\r\n      this.close();\r\n    },\r\n    // 涨跌幅 颜色 class\r\n    roseClasses(data) {\r\n      if (data && data !== '--') {\r\n        const val = parseFloat(data, 0);\r\n        if (val === 0) {\r\n          return '';\r\n        }\r\n        return val > 0 ? 'u-1-cl' : 'u-4-cl';\r\n      }\r\n      return '';\r\n    },\r\n\r\n    init() {\r\n      // 接收24小时行情数据\r\n      this.$bus.$on('FUTURE_MARKET_DATA', (data) => {\r\n        this.WsData = JSON.parse(data);\r\n      });\r\n      if (this.contractInfo) {\r\n        this.contractSide = this.filterType(this.contractInfo);\r\n      }\r\n      this.getReceiveCoupon();\r\n    },\r\n    // 获去赠金\r\n    getReceiveCoupon() {\r\n      if (this.isLogin\r\n        && this.userConfig\r\n        && this.contractSide === 3\r\n        && this.userConfig.openContract === 1\r\n        && this.userConfig.couponTag === 0) {\r\n        this.$store.dispatch('getReceiveCoupon');\r\n      }\r\n    },\r\n  },\r\n};\r\n"]}]}