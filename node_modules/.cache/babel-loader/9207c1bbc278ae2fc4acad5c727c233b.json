{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/mobility/mobility.js","dependencies":[{"path":"/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/mobility/mobility.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport { fixD, fixInput } from '@/utils';\nexport default {\n  name: 'page-mobility',\n  data: function data() {\n    return {\n      buyPayments: [],\n      buyPayActive: '',\n      buyPayLoading: true,\n      sellPayments: [],\n      sellPayActive: '',\n      sellPayLoading: true,\n      side: '',\n      // 购买方向 买BUY 卖SELL\n      legal: '',\n      // 法币币种\n      coin: '',\n      // 数字货币\n      tradeType: '',\n      // 购买类型 1按金额交易 2按数量交易\n      tradeValue: '',\n      // 购买量\n      activePay: '',\n      // 当前选中的交易方式\n      consultPrice: '',\n      // 参考价格\n      balanceList: {},\n      // 所以币种余额\n      amountMax: '',\n      // 最大交易数量\n      amountMin: '',\n      // 最小交易数量\n      priceMax: '',\n      // 最小交易价格\n      priceMin: '',\n      // 最大交易价格\n      getBalanceReady: false,\n      // 是否获取完余额\n      firstGetNewPrice: false,\n      // 是否第一次获取报价\n      consultPriceReady: false,\n      // 是否拿到参考单价\n      balanceReady: false,\n      // 是否取得余额\n      dealLoading: false,\n      // 获取报价的loading\n      newPrice: {},\n      axiosTimer: null,\n      axiosTime: null,\n      showNewGet: false,\n      // 按钮展示是否重新获取 - 黄色button\n      btnLoading: false\n    };\n  },\n  watch: {\n    tradeValue: function tradeValue(v, oldV) {\n      if (this.selectCode === 1) {\n        this.tradeValue = fixInput(v, this.priceFix);\n      } else {\n        this.tradeValue = fixInput(v, this.valueFix);\n      }\n\n      if (parseFloat(v) !== parseFloat(oldV)) {\n        this.getNewPrice();\n      }\n    },\n    market: {\n      immediate: true,\n      handler: function handler(v) {\n        if (v) {\n          this.getInfo();\n          this.getBalance();\n        }\n      }\n    }\n  },\n  computed: {\n    btnObj: function btnObj() {\n      var obj = {\n        disbaled: true,\n        text: '',\n        class: '',\n        showTime: false\n      };\n      obj.disbaled = this.dealObj.btnDisabled;\n      obj.text = this.title;\n\n      if (!this.dealObj.btnDisabled && this.axiosTime) {\n        obj.showTime = true;\n      }\n\n      if (!this.dealObj.btnDisabled && this.showNewGet) {\n        obj.class = 'b-7-bg f-1-cl'; // 报价已过期，点击获取最新价格\n\n        obj.text = this.$t('mobilityTrade.btnHis');\n      }\n\n      return obj;\n    },\n    dealText: function dealText() {\n      var str = '';\n\n      if (this.side === 'BUY') {\n        if (this.tradeType === '1') {\n          // 输入购买金额后获取\n          str = this.$t('mobilityTrade.warn1');\n        } else if (this.tradeType === '2') {\n          // 输入购买数量后获取\n          str = this.$t('mobilityTrade.warn2');\n        }\n      } else if (this.side === 'SELL') {\n        if (this.tradeType === '1') {\n          // 输入出售金额后获取\n          str = this.$t('mobilityTrade.warn3');\n        } else if (this.tradeType === '2') {\n          // 输入出售数量后获取\n          str = this.$t('mobilityTrade.warn4');\n        }\n      }\n\n      return str;\n    },\n    axiosSellPayments: function axiosSellPayments() {\n      var str = '';\n      this.sellPayments.forEach(function (item) {\n        str += \"\".concat(item.payment, \",\");\n      });\n      return str;\n    },\n    axiosBuyPayments: function axiosBuyPayments() {\n      var str = '';\n      this.buyPayments.forEach(function (item) {\n        str += \"\".concat(item.key, \",\");\n      });\n      return str;\n    },\n    getNewPriceFlag: function getNewPriceFlag() {\n      var flag = false;\n\n      if (this.side === 'BUY') {\n        if (this.coin && this.legal && this.tradeType && this.errorObj.flag && this.buyPayments.length && this.consultPriceReady) {\n          flag = true;\n        }\n      } else if (this.side === 'SELL') {\n        if (this.coin && this.legal && this.tradeType && this.errorObj.flag && this.sellPayments.length && this.consultPriceReady) {\n          flag = true;\n        }\n      }\n\n      return flag;\n    },\n    errorObj: function errorObj() {\n      var obj = {\n        flag: true,\n        text: '',\n        showError: false\n      };\n      var tradeValue = parseFloat(this.tradeValue);\n      var amountMax = parseFloat(this.amountMax);\n      var amountMin = parseFloat(this.amountMin);\n      var priceMax = parseFloat(this.priceMax);\n      var priceMin = parseFloat(this.priceMin);\n      var valueBalance = parseFloat(this.nowBalance.value);\n      var priceBalance = parseFloat(this.nowBalance.price);\n\n      if (!tradeValue) {\n        obj.flag = false;\n        obj.text = '';\n        obj.showError = false;\n        return obj;\n      }\n\n      if (!this.getBalanceReady && this.side === 'SELL') {\n        obj.flag = false;\n        obj.text = '';\n        obj.showError = false;\n        return obj;\n      }\n\n      if (this.tradeType === '1') {\n        // 最大下单金额为 1 CNY\n        if (tradeValue > priceBalance && this.side === 'SELL') {\n          obj.flag = false;\n          obj.text = \"\".concat(this.$t('mobilityTrade.error1'), \" \").concat(this.nowBalance.price, \" \").concat(this.legal);\n          obj.showError = true;\n          return obj;\n        } // 下单数量需在1-2 CNY 之间”\n\n\n        if (priceMin > tradeValue || tradeValue > priceMax) {\n          obj.flag = false;\n          obj.text = \"\".concat(this.$t('mobilityTrade.error2'), \" \").concat(this.priceMin, \"-\").concat(this.priceMax, \" \").concat(this.legal);\n          obj.showError = true;\n          return obj;\n        }\n      } else if (this.tradeType === '2') {\n        // 最大下单金额为 1 BTC\n        if (tradeValue > valueBalance && this.side === 'SELL') {\n          obj.flag = false;\n          obj.text = \"\".concat(this.$t('mobilityTrade.error3'), \" \").concat(this.nowBalance.value, \" \").concat(this.coin);\n          obj.showError = true;\n          return obj;\n        } // 下单数量需在 1-2 BTC 之间”\n\n\n        if (amountMin > tradeValue || tradeValue > amountMax) {\n          obj.flag = false;\n          obj.text = \"\".concat(this.$t('mobilityTrade.error4'), \" \").concat(this.amountMin, \"-\").concat(this.amountMax, \" \").concat(this.coin);\n          obj.showError = true;\n          return obj;\n        }\n      }\n\n      return obj;\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    valueFix: function valueFix() {\n      var fix = this.$store.state.baseData.defaultFiatPrecision;\n\n      if (this.market && this.market.coinList[this.coin] && this.market.coinList[this.coin].showPrecision) {\n        fix = this.market.coinList[this.coin].showPrecision;\n      }\n\n      return fix;\n    },\n    priceFix: function priceFix() {\n      var fix = this.$store.state.baseData.defaultFiatPrecision;\n\n      if (this.market && this.market.coinList[this.coin] && this.market.coinList[this.coin].fiatPrecision && this.market.coinList[this.coin].fiatPrecision[this.legal.toLowerCase()]) {\n        fix = this.market.coinList[this.coin].fiatPrecision[this.legal.toLowerCase()];\n      }\n\n      return Number(fix);\n    },\n    nowBalance: function nowBalance() {\n      var price = '';\n      var value = '';\n\n      if (this.balanceList[this.coin] && this.consultPrice) {\n        value = fixD(this.balanceList[this.coin], this.valueFix);\n        price = fixD(this.balanceList[this.coin] * this.consultPrice * 0.9, this.priceFix);\n      }\n\n      return {\n        price: price,\n        value: value\n      };\n    },\n    priceText: function priceText() {\n      if (this.side === 'BUY') {\n        // 按金额购买\n        return this.$t('mobilityTrade.priceBuy');\n      }\n\n      if (this.side === 'SELL') {\n        // 按金额出售\n        return this.$t('mobilityTrade.priceSell');\n      }\n\n      return '';\n    },\n    valueText: function valueText() {\n      if (this.side === 'BUY') {\n        // 按数量购买\n        return this.$t('mobilityTrade.volumeBuy');\n      }\n\n      if (this.side === 'SELL') {\n        // 按数量出售\n        return this.$t('mobilityTrade.volumeSell');\n      }\n\n      return '';\n    },\n    sideTab: function sideTab() {\n      if (this.side === 'BUY') {\n        return 1;\n      }\n\n      if (this.side === 'SELL') {\n        return 2;\n      }\n\n      return 0;\n    },\n    sideList: function sideList() {\n      return [{\n        name: this.$t('mobilityTrade.immediatelyBuy'),\n        index: 1\n      }, {\n        name: this.$t('mobilityTrade.immediatelySell'),\n        index: 2\n      }];\n    },\n    inputCoin: function inputCoin() {\n      if (this.tradeType === '1') {\n        return this.legal;\n      }\n\n      return this.coin;\n    },\n    title: function title() {\n      if (this.side === 'BUY') {\n        return this.$t('mobilityTrade.immediatelyBuy');\n      }\n\n      if (this.side === 'SELL') {\n        return this.$t('mobilityTrade.immediatelySell');\n      }\n\n      return '';\n    },\n    nowObj: function nowObj() {\n      var obj = {};\n\n      if (this.side === 'BUY') {\n        obj = this.newPrice[this.buyPayActive] || {};\n      } else if (this.side === 'SELL') {\n        obj = this.newPrice[this.sellPayActive] || {};\n      }\n\n      return obj;\n    },\n    dealObj: function dealObj() {\n      var obj = this.nowObj;\n      var ret = {\n        price: '--',\n        value: '--',\n        sum: '--',\n        priceClass: '',\n        btnDisabled: true\n      };\n\n      if (this.side === 'SELL' && this.sellPayments.length || this.side === 'BUY') {\n        if (this.getNewPriceFlag) {\n          // 未找到合适报价，请修改下单条件\n          ret.price = obj.hasValue ? obj.price : this.$t('mobilityTrade.error5');\n          ret.value = obj.hasValue ? obj.amount : '--';\n          ret.sum = obj.hasValue ? obj.totalPrice : '--';\n          ret.priceClass = obj.hasValue ? '' : 'b-7-cl';\n          ret.btnDisabled = !obj.hasValue;\n        } else {\n          ret.price = this.dealText;\n          ret.btnDisabled = true;\n        }\n      } else {\n        // 请您先添加收款方式\n        ret.price = this.$t('mobilityTrade.error6');\n        ret.btnDisabled = true;\n      } // newPrice\n\n\n      return ret;\n    }\n  },\n  methods: {\n    btnClick: function btnClick() {\n      var _this = this;\n\n      if (this.showNewGet) {\n        this.btnLoading = true;\n        this.getNewPrice();\n      } else {\n        this.btnLoading = true;\n        this.axios({\n          url: this.side === 'BUY' ? '/flow/buy' : '/flow/sell',\n          params: {\n            side: this.side,\n            advertId: this.nowObj.advertId,\n            volume: this.nowObj.amount,\n            totalPrice: this.nowObj.totalPrice,\n            price: this.nowObj.price,\n            payment: this.nowObj.payment,\n            coinSymbol: this.nowObj.coin,\n            paySymbol: this.nowObj.payCoin,\n            payType: this.tradeType === '1' ? 'PRICE' : 'AMOUNT'\n          }\n        }).then(function (data) {\n          _this.btnLoading = false;\n\n          if (data.code.toString() === '0') {\n            _this.$bus.$emit('tip', {\n              text: data.msg,\n              type: 'success'\n            });\n\n            window.open(data.data);\n\n            _this.$router.push('/order/otcOrder');\n          } else if (data.code.toString() === '101162') {\n            _this.axiosTime = 0;\n            clearInterval(_this.axiosTimer);\n            _this.showNewGet = true;\n            _this.btnLoading = false;\n          } else {\n            _this.$bus.$emit('tip', {\n              text: data.msg,\n              type: 'error'\n            });\n          }\n        });\n      }\n    },\n    // 获取当前报价\n    getNewPrice: function getNewPrice() {\n      var _this2 = this;\n\n      if (!this.getNewPriceFlag) return;\n      this.dealLoading = true;\n      this.newPrice = {};\n      this.axios({\n        url: '/chainup/otc/coin/price',\n        params: {\n          symbol: this.coin,\n          payCoin: this.legal,\n          side: this.side === 'BUY' ? 'SELL' : 'BUY',\n          payType: this.tradeType === '1' ? 'PRICE' : 'AMOUNT',\n          payPrice: this.tradeType === '1' ? this.tradeValue : undefined,\n          payAmount: this.tradeType === '2' ? this.tradeValue : undefined,\n          payments: this.side === 'BUY' ? this.axiosBuyPayments : this.axiosSellPayments\n        }\n      }).then(function (data) {\n        _this2.axiosTime = 60;\n        _this2.showNewGet = false;\n        _this2.btnLoading = false;\n        clearInterval(_this2.axiosTimer);\n        _this2.axiosTimer = setInterval(function () {\n          _this2.axiosTime -= 1;\n\n          if (_this2.axiosTime === 0) {\n            clearInterval(_this2.axiosTimer);\n            _this2.showNewGet = true;\n            _this2.btnLoading = false;\n          }\n        }, 1000);\n\n        if (data.code.toString() === '0') {\n          setTimeout(function () {\n            _this2.dealLoading = false;\n            _this2.newPrice = data.data;\n          }, 1000);\n        } else {\n          _this2.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    allClick: function allClick() {\n      var amountMax = parseFloat(this.amountMax);\n      var priceMax = parseFloat(this.priceMax);\n      var valueBalance = parseFloat(this.nowBalance.value);\n      var priceBalance = parseFloat(this.nowBalance.price);\n\n      if (this.tradeType === '1') {\n        if (priceBalance <= priceMax) {\n          this.tradeValue = this.nowBalance.price;\n        } else {\n          this.tradeValue = this.priceMax;\n        }\n      } else if (this.tradeType === '2') {\n        if (valueBalance <= amountMax) {\n          this.tradeValue = this.nowBalance.value;\n        } else {\n          this.tradeValue = this.amountMax;\n        }\n      }\n    },\n    inputChanges: function inputChanges(value) {\n      this.tradeValue = value;\n    },\n    getInfo: function getInfo() {\n      var _this3 = this;\n\n      this.axios({\n        url: 'otc_flow_coin/info',\n        hostType: 'otc'\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          _this3.init(data.data);\n\n          _this3.getBuyPayments(data.data.payments);\n\n          _this3.getSellPayments();\n\n          _this3.getConsultPrice();\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    add: function add() {\n      this.$router.push('/personal/leaglTenderSet');\n    },\n    // 获取参考价格\n    getConsultPrice: function getConsultPrice() {\n      var _this4 = this;\n\n      this.consultPriceReady = false;\n      this.axios({\n        url: '/otc_flow_coin/consider_price_v4',\n        hostType: 'otc',\n        params: {\n          baseSymbol: this.coin,\n          coinSymbol: this.legal\n        }\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          _this4.consultPrice = data.data.referencePrice;\n          _this4.amountMax = fixD(data.data.amountMax, _this4.valueFix);\n          _this4.amountMin = fixD(data.data.amountMin, _this4.valueFix);\n          _this4.priceMax = fixD(data.data.priceMax, _this4.priceFix);\n          _this4.priceMin = fixD(data.data.priceMin, _this4.priceFix);\n          _this4.consultPriceReady = true;\n\n          if (_this4.side === 'BUY') {\n            _this4.getNewPrice();\n          } else if (_this4.side === 'SELL' && _this4.sellPayments.length && _this4.balanceReady) {\n            _this4.getNewPrice();\n          }\n        } else {\n          _this4.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 获取支付方式\n    getBuyPayments: function getBuyPayments(payments) {\n      // payments = [\n      //   { key: 'otc.payment.alipay', title: '支付宝' },\n      //   { key: 'otc.payment.wxpay', title: '微信' },\n      //   { key: 'otc.payment.domestic.bank.transfer', title: '银行卡' },\n      // ];\n      this.buyPayments = payments;\n\n      if (this.buyPayments.length) {\n        this.buyPayActive = this.buyPayments[0].key;\n      }\n\n      this.buyPayLoading = false;\n    },\n    // 获取收款方式\n    getSellPayments: function getSellPayments() {\n      var _this5 = this;\n\n      this.axios({\n        url: 'otc/payment/find',\n        hostType: 'otc'\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          var arr = [];\n          data.data.forEach(function (item) {\n            if (item.isOpen) {\n              arr.push(item);\n            }\n          });\n          _this5.sellPayments = arr;\n\n          if (arr.length) {\n            _this5.sellPayActive = arr[0].payment;\n          }\n\n          _this5.sellPayLoading = false;\n\n          if (_this5.side === 'SELL' && arr.length && _this5.balanceReady) {\n            _this5.getNewPrice();\n          }\n        } else {\n          _this5.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 初始化\n    init: function init(_ref) {\n      var defaultCoin = _ref.defaultCoin,\n          defaultSeach = _ref.defaultSeach,\n          otcDefaultPaycoin = _ref.otcDefaultPaycoin;\n      var _this$$route$query = this.$route.query,\n          side = _this$$route$query.side,\n          legal = _this$$route$query.legal,\n          coin = _this$$route$query.coin,\n          tradeType = _this$$route$query.tradeType,\n          tradeValue = _this$$route$query.tradeValue;\n      this.side = side || defaultSeach;\n      this.legal = legal || otcDefaultPaycoin;\n      this.coin = coin || defaultCoin;\n      this.tradeType = tradeType || '1';\n      this.tradeValue = tradeValue || '';\n    },\n    sideChange: function sideChange(item) {\n      if (item.index === this.sideTab) return;\n\n      if (item.index === 1) {\n        this.side = 'BUY';\n        this.tradeType = '1';\n      } else {\n        this.side = 'SELL';\n        this.tradeType = '2';\n      }\n\n      this.tradeValue = '';\n    },\n    setTradeType: function setTradeType(v) {\n      this.tradeType = v;\n      this.tradeValue = '';\n    },\n    buyPaymentsChange: function buyPaymentsChange(v) {\n      this.buyPayActive = v;\n    },\n    sellPaymentsChange: function sellPaymentsChange(v) {\n      this.sellPayActive = v;\n    },\n    getBalance: function getBalance() {\n      var _this6 = this;\n\n      this.axios({\n        url: 'finance/v4/otc_account_list'\n      }).then(function (data) {\n        if (data.code.toString() === '0') {\n          _this6.balanceReady = true;\n          var obj = {};\n          data.data.allCoinMap.forEach(function (item) {\n            obj[item.coinSymbol] = item.normal;\n          });\n          _this6.balanceList = obj;\n          _this6.getBalanceReady = true;\n\n          if (_this6.side === 'SELL' && _this6.sellPayments.length && _this6.balanceReady) {\n            _this6.getNewPrice();\n          }\n        } else {\n          _this6.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["/Users/h/partTimeJob/BlockChain-ui-privatization/PC/common-mixin/mobility/mobility.js"],"names":["fixD","fixInput","name","data","buyPayments","buyPayActive","buyPayLoading","sellPayments","sellPayActive","sellPayLoading","side","legal","coin","tradeType","tradeValue","activePay","consultPrice","balanceList","amountMax","amountMin","priceMax","priceMin","getBalanceReady","firstGetNewPrice","consultPriceReady","balanceReady","dealLoading","newPrice","axiosTimer","axiosTime","showNewGet","btnLoading","watch","v","oldV","selectCode","priceFix","valueFix","parseFloat","getNewPrice","market","immediate","handler","getInfo","getBalance","computed","btnObj","obj","disbaled","text","class","showTime","dealObj","btnDisabled","title","$t","dealText","str","axiosSellPayments","forEach","item","payment","axiosBuyPayments","key","getNewPriceFlag","flag","errorObj","length","showError","valueBalance","nowBalance","value","priceBalance","price","$store","state","baseData","fix","defaultFiatPrecision","coinList","showPrecision","fiatPrecision","toLowerCase","Number","priceText","valueText","sideTab","sideList","index","inputCoin","nowObj","ret","sum","priceClass","hasValue","amount","totalPrice","methods","btnClick","axios","url","params","advertId","volume","coinSymbol","paySymbol","payCoin","payType","then","code","toString","$bus","$emit","msg","type","window","open","$router","push","clearInterval","symbol","payPrice","undefined","payAmount","payments","setInterval","setTimeout","allClick","inputChanges","hostType","init","getBuyPayments","getSellPayments","getConsultPrice","add","baseSymbol","referencePrice","arr","isOpen","defaultCoin","defaultSeach","otcDefaultPaycoin","$route","query","sideChange","setTradeType","buyPaymentsChange","sellPaymentsChange","allCoinMap","normal"],"mappings":"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","sourcesContent":["import {\r\n  fixD,\r\n  fixInput,\r\n} from '@/utils';\r\n\r\nexport default {\r\n  name: 'page-mobility',\r\n  data() {\r\n    return {\r\n      buyPayments: [],\r\n      buyPayActive: '',\r\n      buyPayLoading: true,\r\n      sellPayments: [],\r\n      sellPayActive: '',\r\n      sellPayLoading: true,\r\n      side: '', // 购买方向 买BUY 卖SELL\r\n      legal: '', // 法币币种\r\n      coin: '', // 数字货币\r\n      tradeType: '', // 购买类型 1按金额交易 2按数量交易\r\n      tradeValue: '', // 购买量\r\n      activePay: '', // 当前选中的交易方式\r\n      consultPrice: '', // 参考价格\r\n      balanceList: {}, // 所以币种余额\r\n      amountMax: '', // 最大交易数量\r\n      amountMin: '', // 最小交易数量\r\n      priceMax: '', // 最小交易价格\r\n      priceMin: '', // 最大交易价格\r\n      getBalanceReady: false, // 是否获取完余额\r\n      firstGetNewPrice: false, // 是否第一次获取报价\r\n      consultPriceReady: false, // 是否拿到参考单价\r\n      balanceReady: false, // 是否取得余额\r\n      dealLoading: false, // 获取报价的loading\r\n      newPrice: {},\r\n      axiosTimer: null,\r\n      axiosTime: null,\r\n      showNewGet: false, // 按钮展示是否重新获取 - 黄色button\r\n      btnLoading: false,\r\n    };\r\n  },\r\n  watch: {\r\n    tradeValue(v, oldV) {\r\n      if (this.selectCode === 1) {\r\n        this.tradeValue = fixInput(v, this.priceFix);\r\n      } else {\r\n        this.tradeValue = fixInput(v, this.valueFix);\r\n      }\r\n      if (parseFloat(v) !== parseFloat(oldV)) {\r\n        this.getNewPrice();\r\n      }\r\n    },\r\n    market: {\r\n      immediate: true,\r\n      handler(v) {\r\n        if (v) {\r\n          this.getInfo();\r\n          this.getBalance();\r\n        }\r\n      },\r\n    },\r\n  },\r\n  computed: {\r\n    btnObj() {\r\n      const obj = {\r\n        disbaled: true,\r\n        text: '',\r\n        class: '',\r\n        showTime: false,\r\n      };\r\n      obj.disbaled = this.dealObj.btnDisabled;\r\n      obj.text = this.title;\r\n      if (!this.dealObj.btnDisabled && this.axiosTime) {\r\n        obj.showTime = true;\r\n      }\r\n      if (!this.dealObj.btnDisabled && this.showNewGet) {\r\n        obj.class = 'b-7-bg f-1-cl';\r\n        // 报价已过期，点击获取最新价格\r\n        obj.text = this.$t('mobilityTrade.btnHis');\r\n      }\r\n      return obj;\r\n    },\r\n    dealText() {\r\n      let str = '';\r\n      if (this.side === 'BUY') {\r\n        if (this.tradeType === '1') {\r\n          // 输入购买金额后获取\r\n          str = this.$t('mobilityTrade.warn1');\r\n        } else if (this.tradeType === '2') {\r\n          // 输入购买数量后获取\r\n          str = this.$t('mobilityTrade.warn2');\r\n        }\r\n      } else if (this.side === 'SELL') {\r\n        if (this.tradeType === '1') {\r\n          // 输入出售金额后获取\r\n          str = this.$t('mobilityTrade.warn3');\r\n        } else if (this.tradeType === '2') {\r\n          // 输入出售数量后获取\r\n          str = this.$t('mobilityTrade.warn4');\r\n        }\r\n      }\r\n      return str;\r\n    },\r\n    axiosSellPayments() {\r\n      let str = '';\r\n      this.sellPayments.forEach((item) => {\r\n        str += `${item.payment},`;\r\n      });\r\n      return str;\r\n    },\r\n    axiosBuyPayments() {\r\n      let str = '';\r\n      this.buyPayments.forEach((item) => {\r\n        str += `${item.key},`;\r\n      });\r\n      return str;\r\n    },\r\n    getNewPriceFlag() {\r\n      let flag = false;\r\n      if (this.side === 'BUY') {\r\n        if (this.coin && this.legal\r\n          && this.tradeType && this.errorObj.flag\r\n          && this.buyPayments.length\r\n          && this.consultPriceReady) {\r\n          flag = true;\r\n        }\r\n      } else if (this.side === 'SELL') {\r\n        if (this.coin && this.legal\r\n          && this.tradeType && this.errorObj.flag\r\n          && this.sellPayments.length\r\n          && this.consultPriceReady) {\r\n          flag = true;\r\n        }\r\n      }\r\n      return flag;\r\n    },\r\n    errorObj() {\r\n      const obj = {\r\n        flag: true,\r\n        text: '',\r\n        showError: false,\r\n      };\r\n      const tradeValue = parseFloat(this.tradeValue);\r\n      const amountMax = parseFloat(this.amountMax);\r\n      const amountMin = parseFloat(this.amountMin);\r\n      const priceMax = parseFloat(this.priceMax);\r\n      const priceMin = parseFloat(this.priceMin);\r\n      const valueBalance = parseFloat(this.nowBalance.value);\r\n      const priceBalance = parseFloat(this.nowBalance.price);\r\n      if (!tradeValue) {\r\n        obj.flag = false;\r\n        obj.text = '';\r\n        obj.showError = false;\r\n        return obj;\r\n      }\r\n      if (!this.getBalanceReady && this.side === 'SELL') {\r\n        obj.flag = false;\r\n        obj.text = '';\r\n        obj.showError = false;\r\n        return obj;\r\n      }\r\n      if (this.tradeType === '1') {\r\n        // 最大下单金额为 1 CNY\r\n        if (tradeValue > priceBalance && this.side === 'SELL') {\r\n          obj.flag = false;\r\n          obj.text = `${this.$t('mobilityTrade.error1')} ${this.nowBalance.price} ${this.legal}`;\r\n          obj.showError = true;\r\n          return obj;\r\n        }\r\n        // 下单数量需在1-2 CNY 之间”\r\n        if (priceMin > tradeValue || tradeValue > priceMax) {\r\n          obj.flag = false;\r\n          obj.text = `${this.$t('mobilityTrade.error2')} ${this.priceMin}-${this.priceMax} ${this.legal}`;\r\n          obj.showError = true;\r\n          return obj;\r\n        }\r\n      } else if (this.tradeType === '2') {\r\n        // 最大下单金额为 1 BTC\r\n        if (tradeValue > valueBalance && this.side === 'SELL') {\r\n          obj.flag = false;\r\n          obj.text = `${this.$t('mobilityTrade.error3')} ${this.nowBalance.value} ${this.coin}`;\r\n          obj.showError = true;\r\n          return obj;\r\n        }\r\n        // 下单数量需在 1-2 BTC 之间”\r\n        if (amountMin > tradeValue || tradeValue > amountMax) {\r\n          obj.flag = false;\r\n          obj.text = `${this.$t('mobilityTrade.error4')} ${this.amountMin}-${this.amountMax} ${this.coin}`;\r\n          obj.showError = true;\r\n          return obj;\r\n        }\r\n      }\r\n      return obj;\r\n    },\r\n    market() { return this.$store.state.baseData.market; },\r\n    valueFix() {\r\n      let fix = this.$store.state.baseData.defaultFiatPrecision;\r\n      if (this.market\r\n        && this.market.coinList[this.coin]\r\n        && this.market.coinList[this.coin].showPrecision) {\r\n        fix = this.market.coinList[this.coin].showPrecision;\r\n      }\r\n      return fix;\r\n    },\r\n    priceFix() {\r\n      let fix = this.$store.state.baseData.defaultFiatPrecision;\r\n      if (this.market\r\n        && this.market.coinList[this.coin]\r\n        && this.market.coinList[this.coin].fiatPrecision\r\n        && this.market.coinList[this.coin].fiatPrecision[this.legal.toLowerCase()]) {\r\n        fix = this.market.coinList[this.coin].fiatPrecision[this.legal.toLowerCase()];\r\n      }\r\n      return Number(fix);\r\n    },\r\n    nowBalance() {\r\n      let price = '';\r\n      let value = '';\r\n      if (this.balanceList[this.coin] && this.consultPrice) {\r\n        value = fixD(this.balanceList[this.coin], this.valueFix);\r\n        price = fixD(\r\n          this.balanceList[this.coin] * this.consultPrice * 0.9,\r\n          this.priceFix,\r\n        );\r\n      }\r\n      return {\r\n        price,\r\n        value,\r\n      };\r\n    },\r\n    priceText() {\r\n      if (this.side === 'BUY') {\r\n        // 按金额购买\r\n        return this.$t('mobilityTrade.priceBuy');\r\n      } if (this.side === 'SELL') {\r\n        // 按金额出售\r\n        return this.$t('mobilityTrade.priceSell');\r\n      }\r\n      return '';\r\n    },\r\n    valueText() {\r\n      if (this.side === 'BUY') {\r\n        // 按数量购买\r\n        return this.$t('mobilityTrade.volumeBuy');\r\n      } if (this.side === 'SELL') {\r\n        // 按数量出售\r\n        return this.$t('mobilityTrade.volumeSell');\r\n      }\r\n      return '';\r\n    },\r\n    sideTab() {\r\n      if (this.side === 'BUY') {\r\n        return 1;\r\n      } if (this.side === 'SELL') {\r\n        return 2;\r\n      }\r\n      return 0;\r\n    },\r\n    sideList() {\r\n      return [\r\n        { name: this.$t('mobilityTrade.immediatelyBuy'), index: 1 },\r\n        { name: this.$t('mobilityTrade.immediatelySell'), index: 2 },\r\n      ];\r\n    },\r\n    inputCoin() {\r\n      if (this.tradeType === '1') {\r\n        return this.legal;\r\n      }\r\n      return this.coin;\r\n    },\r\n    title() {\r\n      if (this.side === 'BUY') {\r\n        return this.$t('mobilityTrade.immediatelyBuy');\r\n      } if (this.side === 'SELL') {\r\n        return this.$t('mobilityTrade.immediatelySell');\r\n      }\r\n      return '';\r\n    },\r\n    nowObj() {\r\n      let obj = {};\r\n      if (this.side === 'BUY') {\r\n        obj = this.newPrice[this.buyPayActive] || {};\r\n      } else if (this.side === 'SELL') {\r\n        obj = this.newPrice[this.sellPayActive] || {};\r\n      }\r\n      return obj;\r\n    },\r\n    dealObj() {\r\n      const obj = this.nowObj;\r\n      const ret = {\r\n        price: '--',\r\n        value: '--',\r\n        sum: '--',\r\n        priceClass: '',\r\n        btnDisabled: true,\r\n      };\r\n      if ((this.side === 'SELL' && this.sellPayments.length) || this.side === 'BUY') {\r\n        if (this.getNewPriceFlag) {\r\n          // 未找到合适报价，请修改下单条件\r\n          ret.price = obj.hasValue ? obj.price : this.$t('mobilityTrade.error5');\r\n          ret.value = obj.hasValue ? obj.amount : '--';\r\n          ret.sum = obj.hasValue ? obj.totalPrice : '--';\r\n          ret.priceClass = obj.hasValue ? '' : 'b-7-cl';\r\n          ret.btnDisabled = !obj.hasValue;\r\n        } else {\r\n          ret.price = this.dealText;\r\n          ret.btnDisabled = true;\r\n        }\r\n      } else {\r\n        // 请您先添加收款方式\r\n        ret.price = this.$t('mobilityTrade.error6');\r\n        ret.btnDisabled = true;\r\n      }\r\n      // newPrice\r\n      return ret;\r\n    },\r\n  },\r\n  methods: {\r\n    btnClick() {\r\n      if (this.showNewGet) {\r\n        this.btnLoading = true;\r\n        this.getNewPrice();\r\n      } else {\r\n        this.btnLoading = true;\r\n        this.axios({\r\n          url: this.side === 'BUY'\r\n            ? '/flow/buy'\r\n            : '/flow/sell',\r\n          params: {\r\n            side: this.side,\r\n            advertId: this.nowObj.advertId,\r\n            volume: this.nowObj.amount,\r\n            totalPrice: this.nowObj.totalPrice,\r\n            price: this.nowObj.price,\r\n            payment: this.nowObj.payment,\r\n            coinSymbol: this.nowObj.coin,\r\n            paySymbol: this.nowObj.payCoin,\r\n            payType: this.tradeType === '1' ? 'PRICE' : 'AMOUNT',\r\n          },\r\n        }).then((data) => {\r\n          this.btnLoading = false;\r\n          if (data.code.toString() === '0') {\r\n            this.$bus.$emit('tip', { text: data.msg, type: 'success' });\r\n            window.open(data.data);\r\n            this.$router.push('/order/otcOrder');\r\n          } else if (data.code.toString() === '101162') {\r\n            this.axiosTime = 0;\r\n            clearInterval(this.axiosTimer);\r\n            this.showNewGet = true;\r\n            this.btnLoading = false;\r\n          } else {\r\n            this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // 获取当前报价\r\n    getNewPrice() {\r\n      if (!this.getNewPriceFlag) return;\r\n      this.dealLoading = true;\r\n      this.newPrice = {};\r\n      this.axios({\r\n        url: '/chainup/otc/coin/price',\r\n        params: {\r\n          symbol: this.coin,\r\n          payCoin: this.legal,\r\n          side: this.side === 'BUY' ? 'SELL' : 'BUY',\r\n          payType: this.tradeType === '1' ? 'PRICE' : 'AMOUNT',\r\n          payPrice: this.tradeType === '1' ? this.tradeValue : undefined,\r\n          payAmount: this.tradeType === '2' ? this.tradeValue : undefined,\r\n          payments: this.side === 'BUY' ? this.axiosBuyPayments : this.axiosSellPayments,\r\n        },\r\n      }).then((data) => {\r\n        this.axiosTime = 60;\r\n        this.showNewGet = false;\r\n        this.btnLoading = false;\r\n        clearInterval(this.axiosTimer);\r\n        this.axiosTimer = setInterval(() => {\r\n          this.axiosTime -= 1;\r\n          if (this.axiosTime === 0) {\r\n            clearInterval(this.axiosTimer);\r\n            this.showNewGet = true;\r\n            this.btnLoading = false;\r\n          }\r\n        }, 1000);\r\n        if (data.code.toString() === '0') {\r\n          setTimeout(() => {\r\n            this.dealLoading = false;\r\n            this.newPrice = data.data;\r\n          }, 1000);\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    allClick() {\r\n      const amountMax = parseFloat(this.amountMax);\r\n      const priceMax = parseFloat(this.priceMax);\r\n      const valueBalance = parseFloat(this.nowBalance.value);\r\n      const priceBalance = parseFloat(this.nowBalance.price);\r\n      if (this.tradeType === '1') {\r\n        if (priceBalance <= priceMax) {\r\n          this.tradeValue = this.nowBalance.price;\r\n        } else {\r\n          this.tradeValue = this.priceMax;\r\n        }\r\n      } else if (this.tradeType === '2') {\r\n        if (valueBalance <= amountMax) {\r\n          this.tradeValue = this.nowBalance.value;\r\n        } else {\r\n          this.tradeValue = this.amountMax;\r\n        }\r\n      }\r\n    },\r\n    inputChanges(value) {\r\n      this.tradeValue = value;\r\n    },\r\n    getInfo() {\r\n      this.axios({\r\n        url: 'otc_flow_coin/info',\r\n        hostType: 'otc',\r\n      }).then((data) => {\r\n        if (data.code.toString() === '0') {\r\n          this.init(data.data);\r\n          this.getBuyPayments(data.data.payments);\r\n          this.getSellPayments();\r\n          this.getConsultPrice();\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    add() {\r\n      this.$router.push('/personal/leaglTenderSet');\r\n    },\r\n    // 获取参考价格\r\n    getConsultPrice() {\r\n      this.consultPriceReady = false;\r\n      this.axios({\r\n        url: '/otc_flow_coin/consider_price_v4',\r\n        hostType: 'otc',\r\n        params: {\r\n          baseSymbol: this.coin,\r\n          coinSymbol: this.legal,\r\n        },\r\n      }).then((data) => {\r\n        if (data.code.toString() === '0') {\r\n          this.consultPrice = data.data.referencePrice;\r\n          this.amountMax = fixD(data.data.amountMax, this.valueFix);\r\n          this.amountMin = fixD(data.data.amountMin, this.valueFix);\r\n          this.priceMax = fixD(data.data.priceMax, this.priceFix);\r\n          this.priceMin = fixD(data.data.priceMin, this.priceFix);\r\n          this.consultPriceReady = true;\r\n          if (this.side === 'BUY') {\r\n            this.getNewPrice();\r\n          } else if (this.side === 'SELL' && this.sellPayments.length && this.balanceReady) {\r\n            this.getNewPrice();\r\n          }\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    // 获取支付方式\r\n    getBuyPayments(payments) {\r\n      // payments = [\r\n      //   { key: 'otc.payment.alipay', title: '支付宝' },\r\n      //   { key: 'otc.payment.wxpay', title: '微信' },\r\n      //   { key: 'otc.payment.domestic.bank.transfer', title: '银行卡' },\r\n      // ];\r\n      this.buyPayments = payments;\r\n      if (this.buyPayments.length) {\r\n        this.buyPayActive = this.buyPayments[0].key;\r\n      }\r\n      this.buyPayLoading = false;\r\n    },\r\n    // 获取收款方式\r\n    getSellPayments() {\r\n      this.axios({\r\n        url: 'otc/payment/find',\r\n        hostType: 'otc',\r\n      }).then((data) => {\r\n        if (data.code.toString() === '0') {\r\n          const arr = [];\r\n          data.data.forEach((item) => {\r\n            if (item.isOpen) {\r\n              arr.push(item);\r\n            }\r\n          });\r\n          this.sellPayments = arr;\r\n          if (arr.length) {\r\n            this.sellPayActive = arr[0].payment;\r\n          }\r\n          this.sellPayLoading = false;\r\n          if (this.side === 'SELL' && arr.length && this.balanceReady) {\r\n            this.getNewPrice();\r\n          }\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    // 初始化\r\n    init({ defaultCoin, defaultSeach, otcDefaultPaycoin }) {\r\n      const {\r\n        side, legal, coin, tradeType, tradeValue,\r\n      } = this.$route.query;\r\n      this.side = side || defaultSeach;\r\n      this.legal = legal || otcDefaultPaycoin;\r\n      this.coin = coin || defaultCoin;\r\n      this.tradeType = tradeType || '1';\r\n      this.tradeValue = tradeValue || '';\r\n    },\r\n    sideChange(item) {\r\n      if (item.index === this.sideTab) return;\r\n      if (item.index === 1) {\r\n        this.side = 'BUY';\r\n        this.tradeType = '1';\r\n      } else {\r\n        this.side = 'SELL';\r\n        this.tradeType = '2';\r\n      }\r\n      this.tradeValue = '';\r\n    },\r\n    setTradeType(v) {\r\n      this.tradeType = v;\r\n      this.tradeValue = '';\r\n    },\r\n    buyPaymentsChange(v) {\r\n      this.buyPayActive = v;\r\n    },\r\n    sellPaymentsChange(v) {\r\n      this.sellPayActive = v;\r\n    },\r\n    getBalance() {\r\n      this.axios({\r\n        url: 'finance/v4/otc_account_list',\r\n      }).then((data) => {\r\n        if (data.code.toString() === '0') {\r\n          this.balanceReady = true;\r\n          const obj = {};\r\n          data.data.allCoinMap.forEach((item) => {\r\n            obj[item.coinSymbol] = item.normal;\r\n          });\r\n          this.balanceList = obj;\r\n          this.getBalanceReady = true;\r\n          if (this.side === 'SELL' && this.sellPayments.length && this.balanceReady) {\r\n            this.getNewPrice();\r\n          }\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n"]}]}