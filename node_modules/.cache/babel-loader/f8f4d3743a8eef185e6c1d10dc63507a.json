{"remainingRequest":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js!/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js??ref--13-0!/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/assets/b2cAccount/b2cAccount.js","dependencies":[{"path":"/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/assets/b2cAccount/b2cAccount.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/babel.config.js","mtime":1620459862000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport _defineProperty from \"/Users/h/partTimeJob/exchange-fe-server-privatization-master/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.sort\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { myStorage, imgMap, fixD, fixRate, colorMap } from '@/utils';\nvar defaultIcon = imgMap.f_1;\nexport default {\n  data: function data() {\n    return {\n      colorMap: colorMap,\n      otcHeader: \"background: url(\".concat(imgMap.zc_otc, \")\"),\n      tabelLoading: true,\n      // 表格 loading\n      dataList: [],\n      // 表格 数据\n      totalBalance: '--',\n      // 资产折合\n      totalBalanceSymbol: '',\n      // 资产折合币种\n      totalRate: '--',\n      // 资产折合汇率\n      canvasPages: [],\n      // canvas\n      switchFlag: false,\n      // 是否隐藏零资产\n      findValue: '',\n      // 搜索币种\n      colors: ['#9695FF', '#8073FF', '#6C5EE5', '#706BE4', '#514DE9 ', '#4232C5']\n    };\n  },\n  computed: {\n    // 饼图 数据（包含饼图 和 指标）\n    canvasPagesFilter: function canvasPagesFilter() {\n      var _this = this;\n\n      var arr = []; // 去除零资产\n\n      var list = this.canvasPages.filter(function (item) {\n        return parseFloat(item.spk) > 0;\n      }); // 排序\n\n      list.sort(this.compare('spk')); // 非0资产的币种少于6种时\n\n      if (list.length < 6) {\n        list.forEach(function (item, index) {\n          arr.push(_objectSpread(_objectSpread({}, item), {}, {\n            color: _this.colors[index]\n          }));\n        }); // 非0资产的币种多于等于6种时\n      } else if (list.length >= 6) {\n        var evenSum = 0; // 选出前五个\n\n        list.forEach(function (item, index) {\n          if (index < 5) {\n            arr.push(_objectSpread(_objectSpread({}, item), {}, {\n              color: _this.colors[index]\n            }));\n          } else {\n            evenSum += item.spk;\n          }\n        }); // 剩余币种归纳为其他\n\n        arr.push({\n          symbol: this.$t('assets.otcAccount.other'),\n          spk: evenSum,\n          color: this.colors[5]\n        });\n      }\n\n      return arr;\n    },\n    // 表格title\n    columns: function columns() {\n      return [{\n        title: this.$t('assets.otcAccount.coin'),\n        width: '15%'\n      }, // 币种\n      {\n        title: this.$t('assets.b2c.allName'),\n        width: '10%'\n      }, // 全称\n      {\n        title: this.$t('assets.withdraw.lumpSum'),\n        width: '15%'\n      }, // 总额\n      {\n        title: this.$t('assets.otcAccount.Available'),\n        width: '20%'\n      }, // 可用\n      {\n        title: this.$t('assets.otcAccount.freeze'),\n        width: '20%'\n      }, // 冻结\n      {\n        title: this.$t('assets.otcAccount.options'),\n        width: '20%'\n      } // 操作\n      ];\n    },\n    market: function market() {\n      return this.$store.state.baseData.market;\n    },\n    // 资金列表展示到页面数据\n    dataListFilter: function dataListFilter() {\n      var _this2 = this;\n\n      // 隐藏零资产功能过滤数据\n      var list = [];\n\n      if (this.switchFlag) {\n        this.dataList.forEach(function (item) {\n          if (parseFloat(item.btcValuation) >= 0.0001) {\n            list.push(item);\n          }\n        });\n      } else {\n        list = this.dataList;\n      } // 搜索框功能过滤数据\n\n\n      var newList = [];\n      list.forEach(function (item) {\n        if (item.data[0][1].text.toUpperCase().indexOf(_this2.findValue.toUpperCase()) !== -1) {\n          newList.push(item);\n        }\n      });\n      return newList;\n    }\n  },\n  watch: {\n    market: function market(v) {\n      if (v) {\n        this.sendOtcAxios();\n      }\n    },\n    canvasPagesFilter: function canvasPagesFilter(v) {\n      if (v.length === 0) {\n        this.canvasInit();\n      } else {\n        this.canvasMap();\n      }\n    }\n  },\n  methods: {\n    init: function init() {\n      if (myStorage.get('assetsSwitch')) {\n        this.switchFlag = myStorage.get('assetsSwitch');\n      }\n\n      if (this.market) {\n        this.sendOtcAxios();\n      }\n\n      this.canvasInit();\n    },\n    compare: function compare(property) {\n      return function fn(a, b) {\n        var value1 = a[property];\n        var value2 = b[property];\n        return value2 - value1;\n      };\n    },\n    // 获取列表\n    sendOtcAxios: function sendOtcAxios() {\n      var _this3 = this;\n\n      this.axios({\n        url: 'fiat/balance'\n      }).then(function (data) {\n        _this3.tabelLoading = false;\n\n        if (data.code.toString() === '0') {\n          _this3.setData(data.data);\n        } else {\n          _this3.$bus.$emit('tip', {\n            text: data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 处理列表数据\n    setData: function setData(_ref) {\n      var _this4 = this;\n\n      var totalBtcValue = _ref.totalBtcValue,\n          totalBalanceSymbol = _ref.totalBalanceSymbol,\n          allCoinMap = _ref.allCoinMap;\n      var _this$market = this.market,\n          coinList = _this$market.coinList,\n          rate = _this$market.rate;\n      var FFix = coinList[totalBalanceSymbol] && coinList[totalBalanceSymbol].showPrecision || 0;\n      this.totalBalance = fixD(totalBtcValue, FFix); // 折合资产\n\n      this.totalBalanceSymbol = totalBalanceSymbol; // 折合币种\n\n      this.totalRate = fixRate(totalBtcValue, rate, totalBalanceSymbol); // 折合法币\n\n      var btcFix = coinList[totalBalanceSymbol] && coinList[totalBalanceSymbol].showPrecision || 0;\n      var list = [];\n      var canvasList = [];\n      allCoinMap.forEach(function (item) {\n        canvasList.push({\n          symbol: item.symbol,\n          spk: item.btcValue / totalBtcValue\n        });\n        var fix = coinList[item.symbol] && coinList[item.symbol].showPrecision || 0;\n        var coinImg = defaultIcon;\n\n        if (coinList[item.symbol] && coinList[item.symbol].icon.length) {\n          coinImg = coinList[item.symbol].icon;\n        }\n\n        list.push({\n          id: JSON.stringify(item),\n          btcValuation: fixD(item.btcValue, btcFix),\n          data: [[{\n            type: 'icon',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            iconSvg: \"<div class=\\\"coinIcon\\\"><img src=\\\"\".concat(coinImg, \"\\\"/></div>\"),\n            eventType: 'goTradeIn',\n            classes: ['coinBox']\n          }, {\n            text: item.symbol\n          }], item.title || '--', // 全称\n          fixD(item.totalBalance, fix), // 总额\n          fixD(item.normalBalance, fix), // 可用\n          fixD(item.lockBalance, fix), // 冻结\n          [{\n            type: item.depositOpen ? 'link' : 'label',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            text: _this4.$t('assets.exchangeAccount.Recharge'),\n            // 充值\n            links: \"b2cRecrge?symbol=\".concat(item.symbol),\n            classes: [item.depositOpen ? '' : 'tableNownStyle b-2-cl']\n          }, {\n            type: item.withdrawOpen ? 'link' : 'label',\n            // 'link' ' button' ,'html', 'label', 'icon' ‘str’\n            text: _this4.$t('assets.exchangeAccount.withdraw'),\n            // 提现\n            links: \"b2cWithdraw?symbol=\".concat(item.symbol),\n            classes: [item.withdrawOpen ? '' : 'tableNownStyle tableTithDraw b-2-cl']\n          }]]\n        });\n      });\n      this.canvasPages = canvasList;\n      this.dataList = list;\n    },\n    canvasMap: function canvasMap() {\n      var ctx = this.$refs.canvas.getContext('2d');\n      this.$refs.canvas.width = 100;\n      this.$refs.canvas.height = 100;\n      var start = 0;\n      this.canvasPagesFilter.forEach(function (item) {\n        var spk = start + item.spk * 2;\n\n        if (start >= 2) {\n          return;\n        } // 防止 2-xx的值\n\n\n        if (spk > 2) {\n          spk = 2;\n        } // 防止 1.x - 2.x的值\n\n\n        ctx.beginPath();\n        ctx.moveTo(50, 50);\n        ctx.fillStyle = item.color;\n        ctx.arc(50, 50, 50, Math.PI * start, Math.PI * spk);\n        ctx.closePath();\n        ctx.fill();\n        start = spk;\n      });\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#4a3dd8';\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    },\n    // canvas初始化\n    canvasInit: function canvasInit() {\n      var ctx = this.$refs.canvas.getContext('2d');\n      this.$refs.canvas.width = 100;\n      this.$refs.canvas.height = 100;\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#e0e0e0';\n      ctx.arc(50, 50, 50, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n      ctx.beginPath();\n      ctx.moveTo(50, 50);\n      ctx.fillStyle = '#4a3dd8';\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    },\n    // 隐藏零资产\n    findChanges: function findChanges(v) {\n      this.findValue = v;\n    },\n    switchChange: function switchChange() {\n      this.switchFlag = !this.switchFlag;\n      myStorage.set('assetsSwitch', this.switchFlag);\n    },\n    tableClick: function tableClick() {}\n  }\n};",{"version":3,"sources":["/Users/h/partTimeJob/blockchain-ui-privatization/PC/common-mixin/assets/b2cAccount/b2cAccount.js"],"names":["myStorage","imgMap","fixD","fixRate","colorMap","defaultIcon","f_1","data","otcHeader","zc_otc","tabelLoading","dataList","totalBalance","totalBalanceSymbol","totalRate","canvasPages","switchFlag","findValue","colors","computed","canvasPagesFilter","arr","list","filter","item","parseFloat","spk","sort","compare","length","forEach","index","push","color","evenSum","symbol","$t","columns","title","width","market","$store","state","baseData","dataListFilter","btcValuation","newList","text","toUpperCase","indexOf","watch","v","sendOtcAxios","canvasInit","canvasMap","methods","init","get","property","fn","a","b","value1","value2","axios","url","then","code","toString","setData","$bus","$emit","msg","type","totalBtcValue","allCoinMap","coinList","rate","FFix","showPrecision","btcFix","canvasList","btcValue","fix","coinImg","icon","id","JSON","stringify","iconSvg","eventType","classes","normalBalance","lockBalance","depositOpen","links","withdrawOpen","ctx","$refs","canvas","getContext","height","start","beginPath","moveTo","fillStyle","arc","Math","PI","closePath","fill","findChanges","switchChange","set","tableClick"],"mappings":"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","sourcesContent":["import {\r\n  myStorage, imgMap, fixD, fixRate, colorMap,\r\n} from '@/utils';\r\n\r\nconst defaultIcon = imgMap.f_1;\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      colorMap,\r\n      otcHeader: `background: url(${imgMap.zc_otc})`,\r\n      tabelLoading: true, // 表格 loading\r\n      dataList: [], // 表格 数据\r\n      totalBalance: '--', // 资产折合\r\n      totalBalanceSymbol: '', // 资产折合币种\r\n      totalRate: '--', // 资产折合汇率\r\n      canvasPages: [], // canvas\r\n      switchFlag: false, // 是否隐藏零资产\r\n      findValue: '', // 搜索币种\r\n      colors: ['#9695FF', '#8073FF', '#6C5EE5', '#706BE4', '#514DE9 ', '#4232C5'],\r\n    };\r\n  },\r\n  computed: {\r\n    // 饼图 数据（包含饼图 和 指标）\r\n    canvasPagesFilter() {\r\n      const arr = [];\r\n      // 去除零资产\r\n      const list = this.canvasPages.filter((item) => parseFloat(item.spk) > 0);\r\n      // 排序\r\n      list.sort(this.compare('spk'));\r\n      // 非0资产的币种少于6种时\r\n      if (list.length < 6) {\r\n        list.forEach((item, index) => {\r\n          arr.push({\r\n            ...item,\r\n            color: this.colors[index],\r\n          });\r\n        });\r\n      // 非0资产的币种多于等于6种时\r\n      } else if (list.length >= 6) {\r\n        let evenSum = 0;\r\n        // 选出前五个\r\n        list.forEach((item, index) => {\r\n          if (index < 5) {\r\n            arr.push({\r\n              ...item,\r\n              color: this.colors[index],\r\n            });\r\n          } else {\r\n            evenSum += item.spk;\r\n          }\r\n        });\r\n        // 剩余币种归纳为其他\r\n        arr.push({\r\n          symbol: this.$t('assets.otcAccount.other'),\r\n          spk: evenSum,\r\n          color: this.colors[5],\r\n        });\r\n      }\r\n      return arr;\r\n    },\r\n    // 表格title\r\n    columns() {\r\n      return [\r\n        { title: this.$t('assets.otcAccount.coin'), width: '15%' }, // 币种\r\n        { title: this.$t('assets.b2c.allName'), width: '10%' }, // 全称\r\n        { title: this.$t('assets.withdraw.lumpSum'), width: '15%' }, // 总额\r\n        { title: this.$t('assets.otcAccount.Available'), width: '20%' }, // 可用\r\n        { title: this.$t('assets.otcAccount.freeze'), width: '20%' }, // 冻结\r\n        { title: this.$t('assets.otcAccount.options'), width: '20%' }, // 操作\r\n      ];\r\n    },\r\n    market() { return this.$store.state.baseData.market; },\r\n    // 资金列表展示到页面数据\r\n    dataListFilter() {\r\n      // 隐藏零资产功能过滤数据\r\n      let list = [];\r\n      if (this.switchFlag) {\r\n        this.dataList.forEach((item) => {\r\n          if (parseFloat(item.btcValuation) >= 0.0001) {\r\n            list.push(item);\r\n          }\r\n        });\r\n      } else {\r\n        list = this.dataList;\r\n      }\r\n      // 搜索框功能过滤数据\r\n      const newList = [];\r\n      list.forEach((item) => {\r\n        if (item.data[0][1].text.toUpperCase().indexOf(this.findValue.toUpperCase()) !== -1) {\r\n          newList.push(item);\r\n        }\r\n      });\r\n      return newList;\r\n    },\r\n  },\r\n  watch: {\r\n    market(v) { if (v) { this.sendOtcAxios(); } },\r\n    canvasPagesFilter(v) {\r\n      if (v.length === 0) {\r\n        this.canvasInit();\r\n      } else {\r\n        this.canvasMap();\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      if (myStorage.get('assetsSwitch')) {\r\n        this.switchFlag = myStorage.get('assetsSwitch');\r\n      }\r\n      if (this.market) { this.sendOtcAxios(); }\r\n      this.canvasInit();\r\n    },\r\n    compare(property) {\r\n      return function fn(a, b) {\r\n        const value1 = a[property];\r\n        const value2 = b[property];\r\n        return value2 - value1;\r\n      };\r\n    },\r\n    // 获取列表\r\n    sendOtcAxios() {\r\n      this.axios({\r\n        url: 'fiat/balance',\r\n      }).then((data) => {\r\n        this.tabelLoading = false;\r\n        if (data.code.toString() === '0') {\r\n          this.setData(data.data);\r\n        } else {\r\n          this.$bus.$emit('tip', { text: data.msg, type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    // 处理列表数据\r\n    setData({ totalBtcValue, totalBalanceSymbol, allCoinMap }) {\r\n      const { coinList, rate } = this.market;\r\n      const FFix = (coinList[totalBalanceSymbol]\r\n        && coinList[totalBalanceSymbol].showPrecision) || 0;\r\n      this.totalBalance = fixD(totalBtcValue, FFix); // 折合资产\r\n      this.totalBalanceSymbol = totalBalanceSymbol; // 折合币种\r\n      this.totalRate = fixRate(totalBtcValue, rate, totalBalanceSymbol); // 折合法币\r\n      const btcFix = (coinList[totalBalanceSymbol]\r\n        && coinList[totalBalanceSymbol].showPrecision) || 0;\r\n      const list = [];\r\n      const canvasList = [];\r\n      allCoinMap.forEach((item) => {\r\n        canvasList.push({\r\n          symbol: item.symbol,\r\n          spk: item.btcValue / totalBtcValue,\r\n        });\r\n        const fix = (coinList[item.symbol] && coinList[item.symbol].showPrecision) || 0;\r\n        let coinImg = defaultIcon;\r\n        if (coinList[item.symbol] && coinList[item.symbol].icon.length) {\r\n          coinImg = coinList[item.symbol].icon;\r\n        }\r\n        list.push({\r\n          id: JSON.stringify(item),\r\n          btcValuation: fixD(item.btcValue, btcFix),\r\n          data: [\r\n            [\r\n              {\r\n                type: 'icon', // 'link' ' button' ,'html', 'label', 'icon' ‘str’\r\n                iconSvg: `<div class=\"coinIcon\"><img src=\"${coinImg}\"/></div>`,\r\n                eventType: 'goTradeIn',\r\n                classes: ['coinBox'],\r\n              },\r\n              {\r\n                text: item.symbol,\r\n              },\r\n            ],\r\n            item.title || '--', // 全称\r\n            fixD(item.totalBalance, fix), // 总额\r\n            fixD(item.normalBalance, fix), // 可用\r\n            fixD(item.lockBalance, fix), // 冻结\r\n            [\r\n              {\r\n                type: item.depositOpen ? 'link' : 'label', // 'link' ' button' ,'html', 'label', 'icon' ‘str’\r\n                text: this.$t('assets.exchangeAccount.Recharge'), // 充值\r\n                links: `b2cRecrge?symbol=${item.symbol}`,\r\n                classes: [item.depositOpen ? '' : 'tableNownStyle b-2-cl'],\r\n              },\r\n              {\r\n                type: item.withdrawOpen ? 'link' : 'label', // 'link' ' button' ,'html', 'label', 'icon' ‘str’\r\n                text: this.$t('assets.exchangeAccount.withdraw'), // 提现\r\n                links: `b2cWithdraw?symbol=${item.symbol}`,\r\n                classes: [item.withdrawOpen ? '' : 'tableNownStyle tableTithDraw b-2-cl'],\r\n              },\r\n            ],\r\n          ],\r\n        });\r\n      });\r\n      this.canvasPages = canvasList;\r\n      this.dataList = list;\r\n    },\r\n    canvasMap() {\r\n      const ctx = this.$refs.canvas.getContext('2d');\r\n      this.$refs.canvas.width = 100;\r\n      this.$refs.canvas.height = 100;\r\n      let start = 0;\r\n      this.canvasPagesFilter.forEach((item) => {\r\n        let spk = start + item.spk * 2;\r\n        if (start >= 2) { return; } // 防止 2-xx的值\r\n        if (spk > 2) { spk = 2; } // 防止 1.x - 2.x的值\r\n        ctx.beginPath();\r\n        ctx.moveTo(50, 50);\r\n        ctx.fillStyle = item.color;\r\n        ctx.arc(50, 50, 50, Math.PI * start, Math.PI * spk);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        start = spk;\r\n      });\r\n      ctx.beginPath();\r\n      ctx.moveTo(50, 50);\r\n      ctx.fillStyle = '#4a3dd8';\r\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    },\r\n    // canvas初始化\r\n    canvasInit() {\r\n      const ctx = this.$refs.canvas.getContext('2d');\r\n      this.$refs.canvas.width = 100;\r\n      this.$refs.canvas.height = 100;\r\n      ctx.beginPath();\r\n      ctx.moveTo(50, 50);\r\n      ctx.fillStyle = '#e0e0e0';\r\n      ctx.arc(50, 50, 50, 0, Math.PI * 2);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.moveTo(50, 50);\r\n      ctx.fillStyle = '#4a3dd8';\r\n      ctx.arc(50, 50, 35, Math.PI * 0, Math.PI * 2);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    },\r\n    // 隐藏零资产\r\n    findChanges(v) {\r\n      this.findValue = v;\r\n    },\r\n    switchChange() {\r\n      this.switchFlag = !this.switchFlag;\r\n      myStorage.set('assetsSwitch', this.switchFlag);\r\n    },\r\n    tableClick() {\r\n    },\r\n  },\r\n};\r\n"]}]}